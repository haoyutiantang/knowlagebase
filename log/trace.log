2021-08-27 15:16:19.384 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2021-08-27 15:16:19.392 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :55   [32m                  [0;39m Starting KnowlagebaseApplication using Java 1.8.0_261 on DESKTOP-CTIIJC1 with PID 4244 (E:\code\java\knowlagebase\target\classes started by MECHREVO in E:\code\java\knowlagebase)
2021-08-27 15:16:19.392 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-08-27 15:16:19.439 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-08-27 15:16:19.439 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-08-27 15:16:20.273 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-08-27 15:16:20.276 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-08-27 15:16:20.294 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2021-08-27 15:16:20.900 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2021-08-27 15:16:20.906 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2021-08-27 15:16:20.907 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-08-27 15:16:20.907 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2021-08-27 15:16:20.966 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-08-27 15:16:20.966 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1527 ms
2021-08-27 15:16:21.731 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2021-08-27 15:16:22.018 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2021-08-27 15:16:22.055 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-08-27 15:16:22.073 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2021-08-27 15:16:22.085 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2021-08-27 15:16:22.096 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :61   [32m                  [0;39m Started KnowlagebaseApplication in 3.142 seconds (JVM running for 4.363)
2021-08-27 15:16:22.098 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :28   [32m                  [0;39m 启动成功！
2021-08-27 15:16:22.098 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :29   [32m                  [0;39m 地址：	http://127.0.0.1:8880
2021-08-27 15:16:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86358139900923904 [0;39m 生成今日电子书快照开始
2021-08-27 15:16:25.023 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m86358139900923904 [0;39m HikariPool-1 - Starting...
2021-08-27 15:16:25.849 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m86358139900923904 [0;39m HikariPool-1 - Start completed.
2021-08-27 15:16:25.855 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86358139900923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 15:16:25.870 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86358139900923904 [0;39m ==> Parameters: 
2021-08-27 15:16:25.935 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86358139900923904 [0;39m <==    Updates: 7
2021-08-27 15:16:25.936 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86358139900923904 [0;39m 生成今日电子书快照结束，耗时：927毫秒
2021-08-27 16:09:19.458 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :55   [32m                  [0;39m Starting KnowlagebaseApplication using Java 1.8.0_261 on DESKTOP-CTIIJC1 with PID 15256 (E:\code\java\knowlagebase\target\classes started by MECHREVO in E:\code\java\knowlagebase)
2021-08-27 16:09:19.455 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2021-08-27 16:09:19.459 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-08-27 16:09:19.492 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-08-27 16:09:19.493 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-08-27 16:09:19.902 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-08-27 16:09:19.903 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-08-27 16:09:19.915 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2021-08-27 16:09:20.390 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2021-08-27 16:09:20.396 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2021-08-27 16:09:20.396 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-08-27 16:09:20.396 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2021-08-27 16:09:20.446 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-08-27 16:09:20.446 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 953 ms
2021-08-27 16:09:21.057 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2021-08-27 16:09:21.328 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2021-08-27 16:09:21.364 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-08-27 16:09:21.381 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2021-08-27 16:09:21.392 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2021-08-27 16:09:21.402 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :61   [32m                  [0;39m Started KnowlagebaseApplication in 2.286 seconds (JVM running for 3.24)
2021-08-27 16:09:21.403 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :28   [32m                  [0;39m 启动成功！
2021-08-27 16:09:21.404 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :29   [32m                  [0;39m 地址：	http://127.0.0.1:8880
2021-08-27 16:09:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371477787643904 [0;39m 生成今日电子书快照开始
2021-08-27 16:09:25.019 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m86371477787643904 [0;39m HikariPool-1 - Starting...
2021-08-27 16:09:25.627 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m86371477787643904 [0;39m HikariPool-1 - Start completed.
2021-08-27 16:09:25.633 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371477787643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:09:25.649 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371477787643904 [0;39m ==> Parameters: 
2021-08-27 16:09:25.654 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371477787643904 [0;39m <==    Updates: 0
2021-08-27 16:09:25.655 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371477787643904 [0;39m 生成今日电子书快照结束，耗时：646毫秒
2021-08-27 16:09:30.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371498733998080 [0;39m 生成今日电子书快照开始
2021-08-27 16:09:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371498733998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:09:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371498733998080 [0;39m ==> Parameters: 
2021-08-27 16:09:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371498733998080 [0;39m <==    Updates: 0
2021-08-27 16:09:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371498733998080 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:09:35.001 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86371519697129472 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:09:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371519697129472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:09:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371519697129472 [0;39m ==> Parameters: 
2021-08-27 16:09:35.019 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371519697129472 [0;39m <==    Updates: 5
2021-08-27 16:09:35.020 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86371519697129472 [0;39m 更新电子书下的文档数据结束，耗时：19毫秒
2021-08-27 16:09:35.020 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371519776821248 [0;39m 生成今日电子书快照开始
2021-08-27 16:09:35.021 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371519776821248 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:09:35.021 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371519776821248 [0;39m ==> Parameters: 
2021-08-27 16:09:35.022 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371519776821248 [0;39m <==    Updates: 0
2021-08-27 16:09:35.023 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371519776821248 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:09:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371540723175424 [0;39m 生成今日电子书快照开始
2021-08-27 16:09:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371540723175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:09:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371540723175424 [0;39m ==> Parameters: 
2021-08-27 16:09:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371540723175424 [0;39m <==    Updates: 0
2021-08-27 16:09:40.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371540723175424 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:09:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371561669529600 [0;39m 生成今日电子书快照开始
2021-08-27 16:09:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371561669529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:09:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371561669529600 [0;39m ==> Parameters: 
2021-08-27 16:09:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371561669529600 [0;39m <==    Updates: 0
2021-08-27 16:09:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371561669529600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:09:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371582641049600 [0;39m 生成今日电子书快照开始
2021-08-27 16:09:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371582641049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:09:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371582641049600 [0;39m ==> Parameters: 
2021-08-27 16:09:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371582641049600 [0;39m <==    Updates: 0
2021-08-27 16:09:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371582641049600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:09:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371603595792384 [0;39m 生成今日电子书快照开始
2021-08-27 16:09:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371603595792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:09:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371603595792384 [0;39m ==> Parameters: 
2021-08-27 16:09:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371603595792384 [0;39m <==    Updates: 0
2021-08-27 16:09:55.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371603595792384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:10:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371624605061120 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371624605061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371624605061120 [0;39m ==> Parameters: 
2021-08-27 16:10:00.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371624605061120 [0;39m <==    Updates: 0
2021-08-27 16:10:00.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371624605061120 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:10:05.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371645543026688 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371645543026688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371645543026688 [0;39m ==> Parameters: 
2021-08-27 16:10:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371645543026688 [0;39m <==    Updates: 0
2021-08-27 16:10:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371645543026688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:10:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86371645555609600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:10:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371645555609600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:10:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371645555609600 [0;39m ==> Parameters: 
2021-08-27 16:10:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371645555609600 [0;39m <==    Updates: 5
2021-08-27 16:10:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86371645555609600 [0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2021-08-27 16:10:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371666535518208 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371666535518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371666535518208 [0;39m ==> Parameters: 
2021-08-27 16:10:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371666535518208 [0;39m <==    Updates: 0
2021-08-27 16:10:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371666535518208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:10:12.768 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-08-27 16:10:12.768 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-08-27 16:10:12.769 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-08-27 16:10:12.804 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :33   [32m                  [0;39m 有新连接：token：3sIhLoIH6Q，session id：0，当前连接数：1
2021-08-27 16:10:12.907 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371678682222592 [0;39m ------------- 开始 -------------
2021-08-27 16:10:12.908 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371678682222592 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 16:10:12.908 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371678682222592 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 16:10:12.908 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371678682222592 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:10:12.941 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371678829023232 [0;39m ------------- 开始 -------------
2021-08-27 16:10:12.942 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371678829023232 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 16:10:12.942 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371678829023232 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 16:10:12.942 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371678833217536 [0;39m ------------- 开始 -------------
2021-08-27 16:10:12.942 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371678829023232 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:10:12.942 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371678833217536 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:10:12.942 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371678833217536 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:10:12.943 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371678833217536 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:10:12.948 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371678833217536 [0;39m 请求参数: []
2021-08-27 16:10:12.948 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371678682222592 [0;39m 请求参数: []
2021-08-27 16:10:12.948 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371678829023232 [0;39m 请求参数: []
2021-08-27 16:10:12.956 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86371678829023232 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:10:12.956 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86371678682222592 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:10:12.957 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86371678829023232 [0;39m ==> Parameters: 
2021-08-27 16:10:12.957 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86371678682222592 [0;39m ==> Parameters: 
2021-08-27 16:10:12.994 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371678833217536 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:10:12.995 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371678833217536 [0;39m ==> Parameters: 
2021-08-27 16:10:12.998 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86371678829023232 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 16:10:12.998 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86371678682222592 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 16:10:12.999 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86371678829023232 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 16:10:12.999 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86371678682222592 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 16:10:13.001 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86371678682222592 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 16:10:13.001 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86371678829023232 [0;39m <==      Total: 1
2021-08-27 16:10:13.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86371678682222592 [0;39m <==      Total: 2
2021-08-27 16:10:13.006 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:10:13.006 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:10:13.007 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:10:13.007 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:10:13.008 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:10:13.008 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:10:13.008 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:10:13.009 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:10:13.009 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:10:13.010 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:10:13.010 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:10:13.011 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:10:13.012 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:10:13.012 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:10:13.013 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:10:13.013 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:10:13.013 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371678833217536 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:10:13.014 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371678833217536 [0;39m <==      Total: 16
2021-08-27 16:10:13.025 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371678833217536 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:10:13.025 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371678833217536 [0;39m ------------- 结束 耗时：83 ms -------------
2021-08-27 16:10:13.026 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371678829023232 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 16:10:13.026 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371678682222592 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 16:10:13.026 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371678829023232 [0;39m ------------- 结束 耗时：85 ms -------------
2021-08-27 16:10:13.026 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371678682222592 [0;39m ------------- 结束 耗时：120 ms -------------
2021-08-27 16:10:15.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371687469289472 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371687469289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371687469289472 [0;39m ==> Parameters: 
2021-08-27 16:10:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371687469289472 [0;39m <==    Updates: 0
2021-08-27 16:10:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371687469289472 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:10:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371708461780992 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371708461780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371708461780992 [0;39m ==> Parameters: 
2021-08-27 16:10:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371708461780992 [0;39m <==    Updates: 0
2021-08-27 16:10:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371708461780992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:10:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371729429106688 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371729429106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371729429106688 [0;39m ==> Parameters: 
2021-08-27 16:10:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371729429106688 [0;39m <==    Updates: 0
2021-08-27 16:10:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371729429106688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:10:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371750421598208 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371750421598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371750421598208 [0;39m ==> Parameters: 
2021-08-27 16:10:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371750421598208 [0;39m <==    Updates: 0
2021-08-27 16:10:30.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371750421598208 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:10:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371771363758080 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371771363758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371771363758080 [0;39m ==> Parameters: 
2021-08-27 16:10:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371771363758080 [0;39m <==    Updates: 0
2021-08-27 16:10:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371771363758080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:10:35.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86371771376340992 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:10:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371771376340992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:10:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371771376340992 [0;39m ==> Parameters: 
2021-08-27 16:10:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371771376340992 [0;39m <==    Updates: 5
2021-08-27 16:10:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86371771376340992 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:10:35.231 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371772320059392 [0;39m ------------- 开始 -------------
2021-08-27 16:10:35.231 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371772320059392 [0;39m 请求地址: http://127.0.0.1:8880/user/login POST
2021-08-27 16:10:35.231 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371772320059392 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.login
2021-08-27 16:10:35.231 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371772320059392 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:10:35.232 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371772320059392 [0;39m 请求参数: [{"loginName":"test"}]
2021-08-27 16:10:35.241 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86371772320059392 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-08-27 16:10:35.242 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86371772320059392 [0;39m ==> Parameters: test(String)
2021-08-27 16:10:35.249 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86371772320059392 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 16:10:35.249 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86371772320059392 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 16:10:35.249 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86371772320059392 [0;39m <==      Total: 1
2021-08-27 16:10:35.252 INFO  com.haoyu.knowlagebase.controller.UserController  :81   [32m86371772320059392 [0;39m 生成单点登录token：86371772408139776，并放入redis中
2021-08-27 16:10:36.191 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371772320059392 [0;39m 返回结果: {"content":{"id":1,"loginName":"test","name":"测试","token":"86371772408139776"},"success":true}
2021-08-27 16:10:36.192 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371772320059392 [0;39m ------------- 结束 耗时：961 ms -------------
2021-08-27 16:10:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371792385609728 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371792385609728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371792385609728 [0;39m ==> Parameters: 
2021-08-27 16:10:40.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371792385609728 [0;39m <==    Updates: 0
2021-08-27 16:10:40.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371792385609728 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:10:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371813331963904 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371813331963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371813331963904 [0;39m ==> Parameters: 
2021-08-27 16:10:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371813331963904 [0;39m <==    Updates: 0
2021-08-27 16:10:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371813331963904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:10:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371834332844032 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371834332844032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:50.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371834332844032 [0;39m ==> Parameters: 
2021-08-27 16:10:50.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371834332844032 [0;39m <==    Updates: 0
2021-08-27 16:10:50.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371834332844032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:10:52.820 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 16:10:52.820 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2021-08-27 16:10:52.822 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 16:10:52.822 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/user/list
2021-08-27 16:10:52.822 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :47   [32m                  [0;39m 登录校验开始，token：86371772408139776
2021-08-27 16:10:52.824 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :59   [32m                  [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"86371772408139776"}
2021-08-27 16:10:52.846 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371846202724352 [0;39m ------------- 开始 -------------
2021-08-27 16:10:52.846 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371846202724352 [0;39m 请求地址: http://127.0.0.1:8880/user/list GET
2021-08-27 16:10:52.846 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371846202724352 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.list
2021-08-27 16:10:52.846 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371846202724352 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:10:52.848 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371846202724352 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 16:10:52.868 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86371846202724352 [0;39m ==>  Preparing: SELECT count(0) FROM user
2021-08-27 16:10:52.868 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86371846202724352 [0;39m ==> Parameters: 
2021-08-27 16:10:52.869 TRACE c.h.k.mapper.UserMapper.selectByExample_COUNT     :143  [32m86371846202724352 [0;39m <==    Columns: count(0)
2021-08-27 16:10:52.870 TRACE c.h.k.mapper.UserMapper.selectByExample_COUNT     :143  [32m86371846202724352 [0;39m <==        Row: 2
2021-08-27 16:10:52.870 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86371846202724352 [0;39m <==      Total: 1
2021-08-27 16:10:52.872 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86371846202724352 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-08-27 16:10:52.872 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86371846202724352 [0;39m ==> Parameters: 10(Integer)
2021-08-27 16:10:52.873 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86371846202724352 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 16:10:52.873 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86371846202724352 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 16:10:52.874 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86371846202724352 [0;39m <==        Row: 84603304096698368, 11111, 111111, b9207c7ae418edcbdef11219daae3474
2021-08-27 16:10:52.874 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86371846202724352 [0;39m <==      Total: 2
2021-08-27 16:10:52.875 INFO  com.haoyu.knowlagebase.service.UserService        :52   [32m86371846202724352 [0;39m 总行数:2
2021-08-27 16:10:52.875 INFO  com.haoyu.knowlagebase.service.UserService        :53   [32m86371846202724352 [0;39m 总页数:1
2021-08-27 16:10:52.879 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371846202724352 [0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":84603304096698368,"loginName":"11111","name":"111111"}],"total":2},"success":true}
2021-08-27 16:10:52.879 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371846202724352 [0;39m ------------- 结束 耗时：33 ms -------------
2021-08-27 16:10:52.882 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m86371846202724352 [0;39m ------------- LoginInterceptor 结束 耗时：60 ms -------------
2021-08-27 16:10:53.684 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371849717551104 [0;39m ------------- 开始 -------------
2021-08-27 16:10:53.684 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371849717551104 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:10:53.684 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371849717551104 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:10:53.684 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371849717551104 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:10:53.684 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371849717551104 [0;39m 请求参数: []
2021-08-27 16:10:53.685 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371849717551104 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:10:53.685 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371849717551104 [0;39m ==> Parameters: 
2021-08-27 16:10:53.686 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:10:53.686 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:10:53.686 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:10:53.687 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:10:53.687 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:10:53.687 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:10:53.687 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:10:53.688 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:10:53.688 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:10:53.688 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:10:53.688 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:10:53.688 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:10:53.689 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:10:53.689 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:10:53.689 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:10:53.689 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:10:53.690 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371849717551104 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:10:53.690 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371849717551104 [0;39m <==      Total: 16
2021-08-27 16:10:53.691 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371849717551104 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:10:53.691 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371849717551104 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:10:53.712 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371849834991616 [0;39m ------------- 开始 -------------
2021-08-27 16:10:53.712 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371849834991616 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:10:53.712 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371849834991616 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:10:53.712 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371849834991616 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:10:53.714 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371849834991616 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 16:10:53.718 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86371849834991616 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-08-27 16:10:53.718 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86371849834991616 [0;39m ==> Parameters: 
2021-08-27 16:10:53.719 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86371849834991616 [0;39m <==    Columns: count(0)
2021-08-27 16:10:53.719 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86371849834991616 [0;39m <==        Row: 7
2021-08-27 16:10:53.719 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86371849834991616 [0;39m <==      Total: 1
2021-08-27 16:10:53.720 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86371849834991616 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-08-27 16:10:53.720 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86371849834991616 [0;39m ==> Parameters: 10(Integer)
2021-08-27 16:10:53.721 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371849834991616 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:10:53.722 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371849834991616 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 16:10:53.722 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371849834991616 [0;39m <==        Row: 2, Vue 入门教程, 100, 101, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover1.png, 0, 0, 0
2021-08-27 16:10:53.722 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371849834991616 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 16:10:53.723 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371849834991616 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 16:10:53.723 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371849834991616 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 16:10:53.723 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371849834991616 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 16:10:53.724 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371849834991616 [0;39m <==        Row: 85670061133664256, 111, 100, 82110017238601728, 111, 111, 3, 3, 3
2021-08-27 16:10:53.724 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86371849834991616 [0;39m <==      Total: 7
2021-08-27 16:10:53.724 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86371849834991616 [0;39m 总行数:7
2021-08-27 16:10:53.724 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86371849834991616 [0;39m 总页数:1
2021-08-27 16:10:53.729 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371849834991616 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3},{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1},{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":82110017238601728,"cover":"111","description":"111","docCount":3,"id":85670061133664256,"name":"111","viewCount":3,"voteCount":3}],"total":7},"success":true}
2021-08-27 16:10:53.729 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371849834991616 [0;39m ------------- 结束 耗时：17 ms -------------
2021-08-27 16:10:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371855283392512 [0;39m 生成今日电子书快照开始
2021-08-27 16:10:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371855283392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:10:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371855283392512 [0;39m ==> Parameters: 
2021-08-27 16:10:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371855283392512 [0;39m <==    Updates: 0
2021-08-27 16:10:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371855283392512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:10:56.271 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371860568215552 [0;39m ------------- 开始 -------------
2021-08-27 16:10:56.271 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371860568215552 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:10:56.272 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371860568215552 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:10:56.272 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371860568215552 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:10:56.272 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371860568215552 [0;39m 请求参数: []
2021-08-27 16:10:56.272 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371860568215552 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:10:56.273 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371860568215552 [0;39m ==> Parameters: 
2021-08-27 16:10:56.273 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:10:56.273 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:10:56.274 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:10:56.274 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:10:56.274 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:10:56.274 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:10:56.274 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:10:56.275 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:10:56.275 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:10:56.275 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:10:56.275 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:10:56.276 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:10:56.276 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:10:56.276 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:10:56.277 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:10:56.277 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:10:56.278 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371860568215552 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:10:56.278 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371860568215552 [0;39m <==      Total: 16
2021-08-27 16:10:56.279 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371860568215552 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:10:56.279 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371860568215552 [0;39m ------------- 结束 耗时：8 ms -------------
2021-08-27 16:10:58.250 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371868868743168 [0;39m ------------- 开始 -------------
2021-08-27 16:10:58.250 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371868868743168 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:10:58.250 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371868868743168 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:10:58.250 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371868868743168 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:10:58.250 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371868868743168 [0;39m 请求参数: []
2021-08-27 16:10:58.251 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371868868743168 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:10:58.252 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371868868743168 [0;39m ==> Parameters: 
2021-08-27 16:10:58.252 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:10:58.252 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:10:58.253 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:10:58.253 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:10:58.253 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:10:58.253 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:10:58.253 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:10:58.254 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:10:58.254 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:10:58.254 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:10:58.254 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:10:58.254 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:10:58.255 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:10:58.255 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:10:58.255 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:10:58.255 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:10:58.255 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371868868743168 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:10:58.255 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371868868743168 [0;39m <==      Total: 16
2021-08-27 16:10:58.257 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371868868743168 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:10:58.257 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371868868743168 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:11:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371876263301120 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371876263301120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:00.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371876263301120 [0;39m ==> Parameters: 
2021-08-27 16:11:00.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371876263301120 [0;39m <==    Updates: 0
2021-08-27 16:11:00.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371876263301120 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:11:01.367 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371881942388736 [0;39m ------------- 开始 -------------
2021-08-27 16:11:01.367 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371881942388736 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:11:01.368 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371881942388736 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:11:01.368 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371881942388736 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:11:01.368 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371881942388736 [0;39m 请求参数: []
2021-08-27 16:11:01.368 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371881942388736 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:11:01.369 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371881942388736 [0;39m ==> Parameters: 
2021-08-27 16:11:01.369 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:11:01.370 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:11:01.370 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:11:01.370 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:11:01.370 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:11:01.370 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:11:01.371 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:11:01.371 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:11:01.371 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:11:01.371 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:11:01.371 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:11:01.371 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:11:01.372 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:11:01.372 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:11:01.372 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:11:01.372 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:11:01.372 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371881942388736 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:11:01.372 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371881942388736 [0;39m <==      Total: 16
2021-08-27 16:11:01.373 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371881942388736 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:11:01.373 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371881942388736 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:11:01.383 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371882009497600 [0;39m ------------- 开始 -------------
2021-08-27 16:11:01.384 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371882009497600 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:11:01.384 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371882009497600 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:11:01.385 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371882009497600 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:11:01.385 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371882009497600 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 16:11:01.386 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86371882009497600 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-08-27 16:11:01.386 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86371882009497600 [0;39m ==> Parameters: 
2021-08-27 16:11:01.387 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86371882009497600 [0;39m <==    Columns: count(0)
2021-08-27 16:11:01.387 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86371882009497600 [0;39m <==        Row: 7
2021-08-27 16:11:01.387 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86371882009497600 [0;39m <==      Total: 1
2021-08-27 16:11:01.387 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86371882009497600 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-08-27 16:11:01.387 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86371882009497600 [0;39m ==> Parameters: 10(Integer)
2021-08-27 16:11:01.388 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371882009497600 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:11:01.388 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371882009497600 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 16:11:01.388 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371882009497600 [0;39m <==        Row: 2, Vue 入门教程, 100, 101, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover1.png, 0, 0, 0
2021-08-27 16:11:01.388 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371882009497600 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 16:11:01.389 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371882009497600 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 16:11:01.389 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371882009497600 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 16:11:01.389 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371882009497600 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 16:11:01.389 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86371882009497600 [0;39m <==        Row: 85670061133664256, 111, 100, 82110017238601728, 111, 111, 3, 3, 3
2021-08-27 16:11:01.389 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86371882009497600 [0;39m <==      Total: 7
2021-08-27 16:11:01.390 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86371882009497600 [0;39m 总行数:7
2021-08-27 16:11:01.390 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86371882009497600 [0;39m 总页数:1
2021-08-27 16:11:01.390 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371882009497600 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3},{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1},{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":82110017238601728,"cover":"111","description":"111","docCount":3,"id":85670061133664256,"name":"111","viewCount":3,"voteCount":3}],"total":7},"success":true}
2021-08-27 16:11:01.390 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371882009497600 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:11:02.052 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371884815486976 [0;39m ------------- 开始 -------------
2021-08-27 16:11:02.053 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371884815486976 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:11:02.053 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371884815486976 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:11:02.053 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371884815486976 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:11:02.053 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371884815486976 [0;39m 请求参数: []
2021-08-27 16:11:02.054 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371884815486976 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:11:02.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371884823875585 [0;39m ------------- 开始 -------------
2021-08-27 16:11:02.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86371884823875584 [0;39m ------------- 开始 -------------
2021-08-27 16:11:02.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371884823875585 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 16:11:02.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86371884823875584 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 16:11:02.054 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371884815486976 [0;39m ==> Parameters: 
2021-08-27 16:11:02.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371884823875585 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 16:11:02.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86371884823875584 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 16:11:02.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371884823875584 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:11:02.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86371884823875585 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:11:02.055 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371884823875585 [0;39m 请求参数: []
2021-08-27 16:11:02.055 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86371884823875584 [0;39m 请求参数: []
2021-08-27 16:11:02.055 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86371884823875585 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:11:02.055 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86371884823875584 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:11:02.055 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:11:02.055 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86371884823875585 [0;39m ==> Parameters: 
2021-08-27 16:11:02.055 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:11:02.055 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86371884823875584 [0;39m ==> Parameters: 
2021-08-27 16:11:02.056 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:11:02.056 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:11:02.056 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:11:02.056 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:11:02.056 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86371884823875584 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 16:11:02.056 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:11:02.056 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86371884823875585 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 16:11:02.056 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86371884823875584 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 16:11:02.056 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:11:02.057 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86371884823875585 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 16:11:02.057 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:11:02.057 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86371884823875584 [0;39m <==      Total: 1
2021-08-27 16:11:02.057 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:11:02.057 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86371884823875585 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 16:11:02.057 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371884823875584 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 16:11:02.057 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:11:02.057 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371884823875584 [0;39m ------------- 结束 耗时：3 ms -------------
2021-08-27 16:11:02.057 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86371884823875585 [0;39m <==      Total: 2
2021-08-27 16:11:02.057 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:11:02.057 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:11:02.058 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:11:02.058 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371884823875585 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 16:11:02.058 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:11:02.058 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371884823875585 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:11:02.058 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:11:02.058 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86371884815486976 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:11:02.058 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86371884815486976 [0;39m <==      Total: 16
2021-08-27 16:11:02.059 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86371884815486976 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:11:02.059 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86371884815486976 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:11:05.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371897188683776 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371897188683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371897188683776 [0;39m ==> Parameters: 
2021-08-27 16:11:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371897188683776 [0;39m <==    Updates: 0
2021-08-27 16:11:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371897188683776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:11:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86371897197072384 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:11:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371897197072384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:11:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371897197072384 [0;39m ==> Parameters: 
2021-08-27 16:11:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86371897197072384 [0;39m <==    Updates: 5
2021-08-27 16:11:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86371897197072384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:11:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371918168592384 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371918168592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371918168592384 [0;39m ==> Parameters: 
2021-08-27 16:11:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371918168592384 [0;39m <==    Updates: 0
2021-08-27 16:11:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371918168592384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:11:15.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371939144306688 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371939144306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371939144306688 [0;39m ==> Parameters: 
2021-08-27 16:11:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371939144306688 [0;39m <==    Updates: 0
2021-08-27 16:11:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371939144306688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:11:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371960145186816 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371960145186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371960145186816 [0;39m ==> Parameters: 
2021-08-27 16:11:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371960145186816 [0;39m <==    Updates: 0
2021-08-27 16:11:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371960145186816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:11:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86371981112512512 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371981112512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371981112512512 [0;39m ==> Parameters: 
2021-08-27 16:11:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86371981112512512 [0;39m <==    Updates: 0
2021-08-27 16:11:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86371981112512512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:11:30.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372002092421120 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372002092421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372002092421120 [0;39m ==> Parameters: 
2021-08-27 16:11:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372002092421120 [0;39m <==    Updates: 0
2021-08-27 16:11:30.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372002092421120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:11:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372023063941120 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372023063941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372023063941120 [0;39m ==> Parameters: 
2021-08-27 16:11:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372023063941120 [0;39m <==    Updates: 0
2021-08-27 16:11:35.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372023063941120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:11:35.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86372023080718336 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:11:35.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372023080718336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:11:35.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372023080718336 [0;39m ==> Parameters: 
2021-08-27 16:11:35.018 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372023080718336 [0;39m <==    Updates: 5
2021-08-27 16:11:35.018 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86372023080718336 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:11:40.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372043985129472 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:40.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372043985129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:40.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372043985129472 [0;39m ==> Parameters: 
2021-08-27 16:11:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372043985129472 [0;39m <==    Updates: 0
2021-08-27 16:11:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372043985129472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:11:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372064969232384 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372064969232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372064969232384 [0;39m ==> Parameters: 
2021-08-27 16:11:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372064969232384 [0;39m <==    Updates: 0
2021-08-27 16:11:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372064969232384 [0;39m 生成今日电子书快照结束，耗时：7毫秒
2021-08-27 16:11:50.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372085961723904 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372085961723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372085961723904 [0;39m ==> Parameters: 
2021-08-27 16:11:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372085961723904 [0;39m <==    Updates: 0
2021-08-27 16:11:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372085961723904 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:11:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372106933243904 [0;39m 生成今日电子书快照开始
2021-08-27 16:11:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372106933243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:11:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372106933243904 [0;39m ==> Parameters: 
2021-08-27 16:11:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372106933243904 [0;39m <==    Updates: 0
2021-08-27 16:11:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372106933243904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:12:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372127913152512 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372127913152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372127913152512 [0;39m ==> Parameters: 
2021-08-27 16:12:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372127913152512 [0;39m <==    Updates: 0
2021-08-27 16:12:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372127913152512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:12:05.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86372148867895296 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:12:05.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372148867895296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:12:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372148867895296 [0;39m ==> Parameters: 
2021-08-27 16:12:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372148867895296 [0;39m <==    Updates: 5
2021-08-27 16:12:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86372148867895296 [0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2021-08-27 16:12:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372148880478208 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372148880478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372148880478208 [0;39m ==> Parameters: 
2021-08-27 16:12:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372148880478208 [0;39m <==    Updates: 0
2021-08-27 16:12:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372148880478208 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:12:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372169814249472 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372169814249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372169814249472 [0;39m ==> Parameters: 
2021-08-27 16:12:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372169814249472 [0;39m <==    Updates: 0
2021-08-27 16:12:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372169814249472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:12:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372190831906816 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372190831906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372190831906816 [0;39m ==> Parameters: 
2021-08-27 16:12:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372190831906816 [0;39m <==    Updates: 0
2021-08-27 16:12:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372190831906816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:12:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372211799232512 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372211799232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372211799232512 [0;39m ==> Parameters: 
2021-08-27 16:12:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372211799232512 [0;39m <==    Updates: 0
2021-08-27 16:12:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372211799232512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:12:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372232762363904 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372232762363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372232762363904 [0;39m ==> Parameters: 
2021-08-27 16:12:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372232762363904 [0;39m <==    Updates: 0
2021-08-27 16:12:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372232762363904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:12:30.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372253750661120 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372253750661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372253750661120 [0;39m ==> Parameters: 
2021-08-27 16:12:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372253750661120 [0;39m <==    Updates: 0
2021-08-27 16:12:30.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372253750661120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:12:33.321 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372267625418752 [0;39m ------------- 开始 -------------
2021-08-27 16:12:33.322 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372267625418752 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:12:33.322 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372267625418752 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:12:33.322 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372267625418752 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:33.322 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372267625418752 [0;39m 请求参数: []
2021-08-27 16:12:33.322 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372267625418752 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:12:33.323 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372267625418752 [0;39m ==> Parameters: 
2021-08-27 16:12:33.323 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:12:33.323 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:12:33.324 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:12:33.324 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:12:33.324 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:12:33.324 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:12:33.324 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:12:33.324 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:12:33.324 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:12:33.325 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:12:33.325 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:12:33.325 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:12:33.325 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:12:33.325 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:12:33.325 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:12:33.326 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:12:33.326 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372267625418752 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:12:33.326 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372267625418752 [0;39m <==      Total: 16
2021-08-27 16:12:33.326 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372267625418752 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:12:33.327 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372267625418752 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:12:35.002 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86372274676043776 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:12:35.002 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372274676043776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:12:35.002 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372274676043776 [0;39m ==> Parameters: 
2021-08-27 16:12:35.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372274676043776 [0;39m <==    Updates: 5
2021-08-27 16:12:35.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86372274676043776 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:12:35.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372274684432384 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372274684432384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372274684432384 [0;39m ==> Parameters: 
2021-08-27 16:12:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372274684432384 [0;39m <==    Updates: 0
2021-08-27 16:12:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372274684432384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:12:36.498 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372280950722560 [0;39m ------------- 开始 -------------
2021-08-27 16:12:36.499 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372280950722560 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:12:36.499 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372280950722560 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:12:36.499 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372280950722560 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:36.499 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372280950722560 [0;39m 请求参数: []
2021-08-27 16:12:36.500 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372280950722560 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:12:36.500 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372280950722560 [0;39m ==> Parameters: 
2021-08-27 16:12:36.501 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:12:36.501 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:12:36.501 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:12:36.501 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:12:36.502 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:12:36.502 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:12:36.502 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:12:36.502 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:12:36.502 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:12:36.502 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:12:36.503 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:12:36.503 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:12:36.503 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:12:36.503 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:12:36.503 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:12:36.504 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:12:36.504 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372280950722560 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:12:36.504 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372280950722560 [0;39m <==      Total: 16
2021-08-27 16:12:36.505 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372280950722560 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:12:36.505 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372280950722560 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:12:36.517 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372281030414336 [0;39m ------------- 开始 -------------
2021-08-27 16:12:36.518 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372281030414336 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:12:36.518 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372281030414336 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:12:36.518 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372281030414336 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:36.518 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372281030414336 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 16:12:36.519 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86372281030414336 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-08-27 16:12:36.520 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86372281030414336 [0;39m ==> Parameters: 
2021-08-27 16:12:36.521 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86372281030414336 [0;39m <==    Columns: count(0)
2021-08-27 16:12:36.522 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86372281030414336 [0;39m <==        Row: 7
2021-08-27 16:12:36.522 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86372281030414336 [0;39m <==      Total: 1
2021-08-27 16:12:36.522 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86372281030414336 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-08-27 16:12:36.522 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86372281030414336 [0;39m ==> Parameters: 10(Integer)
2021-08-27 16:12:36.523 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372281030414336 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:12:36.523 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372281030414336 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 16:12:36.523 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372281030414336 [0;39m <==        Row: 2, Vue 入门教程, 100, 101, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover1.png, 0, 0, 0
2021-08-27 16:12:36.525 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372281030414336 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 16:12:36.525 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372281030414336 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 16:12:36.525 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372281030414336 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 16:12:36.525 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372281030414336 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 16:12:36.526 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372281030414336 [0;39m <==        Row: 85670061133664256, 111, 100, 82110017238601728, 111, 111, 3, 3, 3
2021-08-27 16:12:36.526 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86372281030414336 [0;39m <==      Total: 7
2021-08-27 16:12:36.526 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86372281030414336 [0;39m 总行数:7
2021-08-27 16:12:36.526 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86372281030414336 [0;39m 总页数:1
2021-08-27 16:12:36.528 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372281030414336 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3},{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1},{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":82110017238601728,"cover":"111","description":"111","docCount":3,"id":85670061133664256,"name":"111","viewCount":3,"voteCount":3}],"total":7},"success":true}
2021-08-27 16:12:36.528 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372281030414336 [0;39m ------------- 结束 耗时：11 ms -------------
2021-08-27 16:12:39.668 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372294246666240 [0;39m ------------- 开始 -------------
2021-08-27 16:12:39.668 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372294246666240 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:12:39.668 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372294246666240 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:12:39.668 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372294246666240 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:39.669 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372294246666240 [0;39m 请求参数: []
2021-08-27 16:12:39.669 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372294246666240 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:12:39.669 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372294246666240 [0;39m ==> Parameters: 
2021-08-27 16:12:39.670 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:12:39.670 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:12:39.670 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:12:39.670 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:12:39.671 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:12:39.671 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:12:39.671 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:12:39.671 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:12:39.671 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:12:39.671 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:12:39.672 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:12:39.672 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:12:39.672 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:12:39.672 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:12:39.672 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:12:39.672 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:12:39.672 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372294246666240 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:12:39.673 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372294246666240 [0;39m <==      Total: 16
2021-08-27 16:12:39.673 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372294246666240 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:12:39.673 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372294246666240 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 16:12:40.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372295676923904 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372295676923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372295676923904 [0;39m ==> Parameters: 
2021-08-27 16:12:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372295676923904 [0;39m <==    Updates: 0
2021-08-27 16:12:40.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372295676923904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:12:40.481 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372297656635392 [0;39m ------------- 开始 -------------
2021-08-27 16:12:40.481 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372297656635392 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:12:40.482 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372297656635392 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:12:40.482 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372297656635392 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:40.482 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372297656635392 [0;39m 请求参数: []
2021-08-27 16:12:40.483 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372297656635392 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:12:40.483 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372297656635392 [0;39m ==> Parameters: 
2021-08-27 16:12:40.483 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:12:40.483 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:12:40.484 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:12:40.484 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:12:40.484 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:12:40.484 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:12:40.484 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:12:40.484 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:12:40.484 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:12:40.485 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:12:40.485 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:12:40.485 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:12:40.485 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:12:40.485 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:12:40.485 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:12:40.486 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:12:40.486 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372297656635392 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:12:40.486 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372297656635392 [0;39m <==      Total: 16
2021-08-27 16:12:40.486 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372297656635392 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:12:40.487 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372297656635392 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:12:40.805 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372299015589888 [0;39m ------------- 开始 -------------
2021-08-27 16:12:40.805 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372299015589888 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:12:40.805 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372299015589888 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:12:40.806 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372299015589888 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:40.806 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372299015589888 [0;39m 请求参数: []
2021-08-27 16:12:40.806 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372299015589888 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:12:40.807 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372299015589888 [0;39m ==> Parameters: 
2021-08-27 16:12:40.808 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:12:40.808 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:12:40.808 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:12:40.808 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:12:40.808 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:12:40.808 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:12:40.809 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:12:40.809 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:12:40.809 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:12:40.809 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:12:40.809 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:12:40.809 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:12:40.809 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:12:40.810 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:12:40.810 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:12:40.810 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:12:40.810 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372299015589888 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:12:40.811 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372299015589888 [0;39m <==      Total: 16
2021-08-27 16:12:40.811 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372299015589888 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:12:40.811 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372299015589888 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:12:40.821 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372299082698752 [0;39m ------------- 开始 -------------
2021-08-27 16:12:40.822 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372299082698752 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:12:40.822 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372299082698752 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:12:40.822 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372299082698752 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:40.822 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372299082698752 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 16:12:40.824 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86372299082698752 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-08-27 16:12:40.824 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86372299082698752 [0;39m ==> Parameters: 
2021-08-27 16:12:40.825 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86372299082698752 [0;39m <==    Columns: count(0)
2021-08-27 16:12:40.825 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86372299082698752 [0;39m <==        Row: 7
2021-08-27 16:12:40.826 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86372299082698752 [0;39m <==      Total: 1
2021-08-27 16:12:40.826 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86372299082698752 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-08-27 16:12:40.827 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86372299082698752 [0;39m ==> Parameters: 10(Integer)
2021-08-27 16:12:40.827 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372299082698752 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:12:40.828 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372299082698752 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 16:12:40.828 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372299082698752 [0;39m <==        Row: 2, Vue 入门教程, 100, 101, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover1.png, 0, 0, 0
2021-08-27 16:12:40.828 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372299082698752 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 16:12:40.828 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372299082698752 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 16:12:40.829 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372299082698752 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 16:12:40.829 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372299082698752 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 16:12:40.829 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86372299082698752 [0;39m <==        Row: 85670061133664256, 111, 100, 82110017238601728, 111, 111, 3, 3, 3
2021-08-27 16:12:40.829 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86372299082698752 [0;39m <==      Total: 7
2021-08-27 16:12:40.830 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86372299082698752 [0;39m 总行数:7
2021-08-27 16:12:40.830 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86372299082698752 [0;39m 总页数:1
2021-08-27 16:12:40.830 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372299082698752 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3},{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1},{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":82110017238601728,"cover":"111","description":"111","docCount":3,"id":85670061133664256,"name":"111","viewCount":3,"voteCount":3}],"total":7},"success":true}
2021-08-27 16:12:40.830 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372299082698752 [0;39m ------------- 结束 耗时：9 ms -------------
2021-08-27 16:12:41.164 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m86371860568215552 [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 16:12:41.164 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :43   [32m86371860568215552 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/user/list
2021-08-27 16:12:41.164 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :47   [32m86371860568215552 [0;39m 登录校验开始，token：86371772408139776
2021-08-27 16:12:41.166 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :59   [32m86371860568215552 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"86371772408139776"}
2021-08-27 16:12:41.167 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372300533927936 [0;39m ------------- 开始 -------------
2021-08-27 16:12:41.167 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372300533927936 [0;39m 请求地址: http://127.0.0.1:8880/user/list GET
2021-08-27 16:12:41.167 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372300533927936 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.list
2021-08-27 16:12:41.167 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372300533927936 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:41.167 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372300533927936 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 16:12:41.168 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86372300533927936 [0;39m ==>  Preparing: SELECT count(0) FROM user
2021-08-27 16:12:41.168 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86372300533927936 [0;39m ==> Parameters: 
2021-08-27 16:12:41.169 TRACE c.h.k.mapper.UserMapper.selectByExample_COUNT     :143  [32m86372300533927936 [0;39m <==    Columns: count(0)
2021-08-27 16:12:41.169 TRACE c.h.k.mapper.UserMapper.selectByExample_COUNT     :143  [32m86372300533927936 [0;39m <==        Row: 2
2021-08-27 16:12:41.169 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86372300533927936 [0;39m <==      Total: 1
2021-08-27 16:12:41.170 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86372300533927936 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-08-27 16:12:41.170 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86372300533927936 [0;39m ==> Parameters: 10(Integer)
2021-08-27 16:12:41.170 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86372300533927936 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 16:12:41.170 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86372300533927936 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 16:12:41.171 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86372300533927936 [0;39m <==        Row: 84603304096698368, 11111, 111111, b9207c7ae418edcbdef11219daae3474
2021-08-27 16:12:41.171 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86372300533927936 [0;39m <==      Total: 2
2021-08-27 16:12:41.171 INFO  com.haoyu.knowlagebase.service.UserService        :52   [32m86372300533927936 [0;39m 总行数:2
2021-08-27 16:12:41.171 INFO  com.haoyu.knowlagebase.service.UserService        :53   [32m86372300533927936 [0;39m 总页数:1
2021-08-27 16:12:41.171 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372300533927936 [0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":84603304096698368,"loginName":"11111","name":"111111"}],"total":2},"success":true}
2021-08-27 16:12:41.171 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372300533927936 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:12:41.172 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m86372300533927936 [0;39m ------------- LoginInterceptor 结束 耗时：8 ms -------------
2021-08-27 16:12:42.067 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372304308801536 [0;39m ------------- 开始 -------------
2021-08-27 16:12:42.067 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372304308801536 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 16:12:42.067 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372304308801536 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372304308801536 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372304312995840 [0;39m ------------- 开始 -------------
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86372304312995841 [0;39m ------------- 开始 -------------
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372304312995840 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372304308801536 [0;39m 请求参数: []
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86372304312995841 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372304312995840 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372304312995840 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86372304312995841 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372304312995840 [0;39m 请求参数: []
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86372304312995841 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:12:42.068 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86372304308801536 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:12:42.068 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86372304312995841 [0;39m 请求参数: []
2021-08-27 16:12:42.069 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86372304308801536 [0;39m ==> Parameters: 
2021-08-27 16:12:42.069 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372304312995840 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:12:42.069 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86372304312995841 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:12:42.069 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372304312995840 [0;39m ==> Parameters: 
2021-08-27 16:12:42.069 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86372304312995841 [0;39m ==> Parameters: 
2021-08-27 16:12:42.069 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86372304308801536 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 16:12:42.069 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:12:42.070 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86372304308801536 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 16:12:42.070 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:12:42.070 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86372304312995841 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 16:12:42.070 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86372304312995841 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 16:12:42.070 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:12:42.070 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86372304308801536 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 16:12:42.070 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:12:42.070 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86372304308801536 [0;39m <==      Total: 2
2021-08-27 16:12:42.070 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86372304312995841 [0;39m <==      Total: 1
2021-08-27 16:12:42.071 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:12:42.071 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372304312995841 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 16:12:42.071 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372304308801536 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 16:12:42.071 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372304312995841 [0;39m ------------- 结束 耗时：3 ms -------------
2021-08-27 16:12:42.071 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372304308801536 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:12:42.071 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:12:42.071 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:12:42.071 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:12:42.071 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:12:42.072 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:12:42.072 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:12:42.072 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:12:42.072 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:12:42.072 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:12:42.073 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:12:42.073 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:12:42.073 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86372304312995840 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:12:42.073 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86372304312995840 [0;39m <==      Total: 16
2021-08-27 16:12:42.074 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86372304312995840 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:12:42.074 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86372304312995840 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:12:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372316627472384 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372316627472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372316627472384 [0;39m ==> Parameters: 
2021-08-27 16:12:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372316627472384 [0;39m <==    Updates: 0
2021-08-27 16:12:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372316627472384 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:12:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372337632546816 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372337632546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372337632546816 [0;39m ==> Parameters: 
2021-08-27 16:12:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372337632546816 [0;39m <==    Updates: 0
2021-08-27 16:12:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372337632546816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:12:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372358612455424 [0;39m 生成今日电子书快照开始
2021-08-27 16:12:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372358612455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:12:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372358612455424 [0;39m ==> Parameters: 
2021-08-27 16:12:55.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372358612455424 [0;39m <==    Updates: 0
2021-08-27 16:12:55.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372358612455424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:13:00.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372379592364032 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:00.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372379592364032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:00.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372379592364032 [0;39m ==> Parameters: 
2021-08-27 16:13:00.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372379592364032 [0;39m <==    Updates: 0
2021-08-27 16:13:00.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372379592364032 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:13:05.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372400509358080 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372400509358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372400509358080 [0;39m ==> Parameters: 
2021-08-27 16:13:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372400509358080 [0;39m <==    Updates: 0
2021-08-27 16:13:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372400509358080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:13:05.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86372400526135296 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:13:05.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372400526135296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:13:05.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372400526135296 [0;39m ==> Parameters: 
2021-08-27 16:13:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372400526135296 [0;39m <==    Updates: 5
2021-08-27 16:13:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86372400526135296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:13:10.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372421489266688 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372421489266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372421489266688 [0;39m ==> Parameters: 
2021-08-27 16:13:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372421489266688 [0;39m <==    Updates: 0
2021-08-27 16:13:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372421489266688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:13:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372442498535424 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372442498535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372442498535424 [0;39m ==> Parameters: 
2021-08-27 16:13:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372442498535424 [0;39m <==    Updates: 0
2021-08-27 16:13:15.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372442498535424 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:13:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372463465861120 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372463465861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372463465861120 [0;39m ==> Parameters: 
2021-08-27 16:13:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372463465861120 [0;39m <==    Updates: 0
2021-08-27 16:13:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372463465861120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:13:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372484412215296 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372484412215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372484412215296 [0;39m ==> Parameters: 
2021-08-27 16:13:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372484412215296 [0;39m <==    Updates: 0
2021-08-27 16:13:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372484412215296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:13:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372505396318208 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372505396318208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372505396318208 [0;39m ==> Parameters: 
2021-08-27 16:13:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372505396318208 [0;39m <==    Updates: 0
2021-08-27 16:13:30.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372505396318208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:13:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86372526372032512 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:13:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372526372032512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:13:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372526372032512 [0;39m ==> Parameters: 
2021-08-27 16:13:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372526372032512 [0;39m <==    Updates: 5
2021-08-27 16:13:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86372526372032512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:13:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372526380421120 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372526380421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372526380421120 [0;39m ==> Parameters: 
2021-08-27 16:13:35.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372526380421120 [0;39m <==    Updates: 0
2021-08-27 16:13:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372526380421120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:13:40.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372547335163904 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372547335163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372547335163904 [0;39m ==> Parameters: 
2021-08-27 16:13:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372547335163904 [0;39m <==    Updates: 0
2021-08-27 16:13:40.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372547335163904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:13:45.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372568273129472 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:45.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372568273129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372568273129472 [0;39m ==> Parameters: 
2021-08-27 16:13:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372568273129472 [0;39m <==    Updates: 0
2021-08-27 16:13:45.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372568273129472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:13:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372589257232384 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372589257232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372589257232384 [0;39m ==> Parameters: 
2021-08-27 16:13:50.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372589257232384 [0;39m <==    Updates: 0
2021-08-27 16:13:50.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372589257232384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:13:55.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372610216169472 [0;39m 生成今日电子书快照开始
2021-08-27 16:13:55.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372610216169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:13:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372610216169472 [0;39m ==> Parameters: 
2021-08-27 16:13:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372610216169472 [0;39m <==    Updates: 0
2021-08-27 16:13:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372610216169472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:14:00.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372631183495168 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:00.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372631183495168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:00.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372631183495168 [0;39m ==> Parameters: 
2021-08-27 16:14:00.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372631183495168 [0;39m <==    Updates: 0
2021-08-27 16:14:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372631183495168 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:14:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372652213735424 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372652213735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372652213735424 [0;39m ==> Parameters: 
2021-08-27 16:14:05.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372652213735424 [0;39m <==    Updates: 0
2021-08-27 16:14:05.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372652213735424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:14:05.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86372652222124032 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:14:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372652222124032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:14:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372652222124032 [0;39m ==> Parameters: 
2021-08-27 16:14:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372652222124032 [0;39m <==    Updates: 5
2021-08-27 16:14:05.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86372652222124032 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:14:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372673130729472 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372673130729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372673130729472 [0;39m ==> Parameters: 
2021-08-27 16:14:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372673130729472 [0;39m <==    Updates: 0
2021-08-27 16:14:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372673130729472 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 16:14:15.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372694139998208 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372694139998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372694139998208 [0;39m ==> Parameters: 
2021-08-27 16:14:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372694139998208 [0;39m <==    Updates: 0
2021-08-27 16:14:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372694139998208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:14:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372715111518208 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372715111518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372715111518208 [0;39m ==> Parameters: 
2021-08-27 16:14:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372715111518208 [0;39m <==    Updates: 0
2021-08-27 16:14:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372715111518208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:14:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372736078843904 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372736078843904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372736078843904 [0;39m ==> Parameters: 
2021-08-27 16:14:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372736078843904 [0;39m <==    Updates: 0
2021-08-27 16:14:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372736078843904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:14:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372757071335424 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372757071335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372757071335424 [0;39m ==> Parameters: 
2021-08-27 16:14:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372757071335424 [0;39m <==    Updates: 0
2021-08-27 16:14:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372757071335424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:14:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86372778047049728 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:14:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372778047049728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:14:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372778047049728 [0;39m ==> Parameters: 
2021-08-27 16:14:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372778047049728 [0;39m <==    Updates: 5
2021-08-27 16:14:35.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86372778047049728 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:14:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372778055438336 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372778055438336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372778055438336 [0;39m ==> Parameters: 
2021-08-27 16:14:35.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372778055438336 [0;39m <==    Updates: 0
2021-08-27 16:14:35.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372778055438336 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:14:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372798989209600 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372798989209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372798989209600 [0;39m ==> Parameters: 
2021-08-27 16:14:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372798989209600 [0;39m <==    Updates: 0
2021-08-27 16:14:40.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372798989209600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:14:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372819985895424 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372819985895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372819985895424 [0;39m ==> Parameters: 
2021-08-27 16:14:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372819985895424 [0;39m <==    Updates: 0
2021-08-27 16:14:45.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372819985895424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:14:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372840915472384 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372840915472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372840915472384 [0;39m ==> Parameters: 
2021-08-27 16:14:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372840915472384 [0;39m <==    Updates: 0
2021-08-27 16:14:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372840915472384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:14:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372861933129728 [0;39m 生成今日电子书快照开始
2021-08-27 16:14:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372861933129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:14:55.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372861933129728 [0;39m ==> Parameters: 
2021-08-27 16:14:55.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372861933129728 [0;39m <==    Updates: 0
2021-08-27 16:14:55.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372861933129728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:15:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372882879483904 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372882879483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372882879483904 [0;39m ==> Parameters: 
2021-08-27 16:15:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372882879483904 [0;39m <==    Updates: 0
2021-08-27 16:15:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372882879483904 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:15:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86372903830032384 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:15:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372903830032384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:15:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372903830032384 [0;39m ==> Parameters: 
2021-08-27 16:15:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86372903830032384 [0;39m <==    Updates: 5
2021-08-27 16:15:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86372903830032384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:15:05.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372903834226688 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372903834226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372903834226688 [0;39m ==> Parameters: 
2021-08-27 16:15:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372903834226688 [0;39m <==    Updates: 0
2021-08-27 16:15:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372903834226688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:15:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372924843495424 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372924843495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:10.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372924843495424 [0;39m ==> Parameters: 
2021-08-27 16:15:10.020 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372924843495424 [0;39m <==    Updates: 0
2021-08-27 16:15:10.021 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372924843495424 [0;39m 生成今日电子书快照结束，耗时：7毫秒
2021-08-27 16:15:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372945785655296 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372945785655296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372945785655296 [0;39m ==> Parameters: 
2021-08-27 16:15:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372945785655296 [0;39m <==    Updates: 0
2021-08-27 16:15:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372945785655296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:15:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372966765563904 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372966765563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372966765563904 [0;39m ==> Parameters: 
2021-08-27 16:15:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372966765563904 [0;39m <==    Updates: 0
2021-08-27 16:15:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372966765563904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:15:25.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86372987707723776 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372987707723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372987707723776 [0;39m ==> Parameters: 
2021-08-27 16:15:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86372987707723776 [0;39m <==    Updates: 0
2021-08-27 16:15:25.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86372987707723776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:15:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373008708603904 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373008708603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373008708603904 [0;39m ==> Parameters: 
2021-08-27 16:15:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373008708603904 [0;39m <==    Updates: 0
2021-08-27 16:15:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373008708603904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:15:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86373029671735296 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:15:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373029671735296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:15:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373029671735296 [0;39m ==> Parameters: 
2021-08-27 16:15:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373029671735296 [0;39m <==    Updates: 5
2021-08-27 16:15:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86373029671735296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:15:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373029680123904 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373029680123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373029680123904 [0;39m ==> Parameters: 
2021-08-27 16:15:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373029680123904 [0;39m <==    Updates: 0
2021-08-27 16:15:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373029680123904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:15:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373050672615424 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373050672615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373050672615424 [0;39m ==> Parameters: 
2021-08-27 16:15:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373050672615424 [0;39m <==    Updates: 0
2021-08-27 16:15:40.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373050672615424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:15:45.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373071597998080 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373071597998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373071597998080 [0;39m ==> Parameters: 
2021-08-27 16:15:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373071597998080 [0;39m <==    Updates: 0
2021-08-27 16:15:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373071597998080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:15:50.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373092628238336 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:50.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373092628238336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:50.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373092628238336 [0;39m ==> Parameters: 
2021-08-27 16:15:50.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373092628238336 [0;39m <==    Updates: 0
2021-08-27 16:15:50.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373092628238336 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:15:55.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373113528455168 [0;39m 生成今日电子书快照开始
2021-08-27 16:15:55.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373113528455168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:15:55.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373113528455168 [0;39m ==> Parameters: 
2021-08-27 16:15:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373113528455168 [0;39m <==    Updates: 0
2021-08-27 16:15:55.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373113528455168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:16:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373134537723904 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373134537723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373134537723904 [0;39m ==> Parameters: 
2021-08-27 16:16:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373134537723904 [0;39m <==    Updates: 0
2021-08-27 16:16:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373134537723904 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:16:05.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86373155538604032 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:16:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373155538604032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:16:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373155538604032 [0;39m ==> Parameters: 
2021-08-27 16:16:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373155538604032 [0;39m <==    Updates: 5
2021-08-27 16:16:05.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86373155538604032 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:16:05.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373155546992640 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:05.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373155546992640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:05.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373155546992640 [0;39m ==> Parameters: 
2021-08-27 16:16:05.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373155546992640 [0;39m <==    Updates: 0
2021-08-27 16:16:05.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373155546992640 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:16:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373176501735424 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373176501735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373176501735424 [0;39m ==> Parameters: 
2021-08-27 16:16:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373176501735424 [0;39m <==    Updates: 0
2021-08-27 16:16:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373176501735424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:16:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373197422923776 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373197422923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373197422923776 [0;39m ==> Parameters: 
2021-08-27 16:16:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373197422923776 [0;39m <==    Updates: 0
2021-08-27 16:16:15.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373197422923776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:16:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373218415415296 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373218415415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373218415415296 [0;39m ==> Parameters: 
2021-08-27 16:16:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373218415415296 [0;39m <==    Updates: 0
2021-08-27 16:16:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373218415415296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:16:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373239420489728 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373239420489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373239420489728 [0;39m ==> Parameters: 
2021-08-27 16:16:25.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373239420489728 [0;39m <==    Updates: 0
2021-08-27 16:16:25.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373239420489728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:16:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373260387815424 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373260387815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373260387815424 [0;39m ==> Parameters: 
2021-08-27 16:16:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373260387815424 [0;39m <==    Updates: 0
2021-08-27 16:16:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373260387815424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:16:35.001 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86373281304809472 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:16:35.001 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373281304809472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:16:35.002 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373281304809472 [0;39m ==> Parameters: 
2021-08-27 16:16:35.002 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373281304809472 [0;39m <==    Updates: 5
2021-08-27 16:16:35.002 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86373281304809472 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:16:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373281313198080 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373281313198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373281313198080 [0;39m ==> Parameters: 
2021-08-27 16:16:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373281313198080 [0;39m <==    Updates: 0
2021-08-27 16:16:35.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373281313198080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:16:40.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373302280523776 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:40.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373302280523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373302280523776 [0;39m ==> Parameters: 
2021-08-27 16:16:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373302280523776 [0;39m <==    Updates: 0
2021-08-27 16:16:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373302280523776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:16:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373323289792512 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373323289792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373323289792512 [0;39m ==> Parameters: 
2021-08-27 16:16:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373323289792512 [0;39m <==    Updates: 0
2021-08-27 16:16:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373323289792512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:16:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373344261312512 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373344261312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373344261312512 [0;39m ==> Parameters: 
2021-08-27 16:16:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373344261312512 [0;39m <==    Updates: 0
2021-08-27 16:16:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373344261312512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:16:55.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373365190889472 [0;39m 生成今日电子书快照开始
2021-08-27 16:16:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373365190889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:16:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373365190889472 [0;39m ==> Parameters: 
2021-08-27 16:16:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373365190889472 [0;39m <==    Updates: 0
2021-08-27 16:16:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373365190889472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:17:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373386174992384 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373386174992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373386174992384 [0;39m ==> Parameters: 
2021-08-27 16:17:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373386174992384 [0;39m <==    Updates: 0
2021-08-27 16:17:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373386174992384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:17:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86373407167483904 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:17:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373407167483904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:17:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373407167483904 [0;39m ==> Parameters: 
2021-08-27 16:17:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373407167483904 [0;39m <==    Updates: 5
2021-08-27 16:17:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86373407167483904 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:17:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373407175872512 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373407175872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373407175872512 [0;39m ==> Parameters: 
2021-08-27 16:17:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373407175872512 [0;39m <==    Updates: 0
2021-08-27 16:17:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373407175872512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:17:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373428109643776 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373428109643776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373428109643776 [0;39m ==> Parameters: 
2021-08-27 16:17:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373428109643776 [0;39m <==    Updates: 0
2021-08-27 16:17:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373428109643776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:17:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373449135689728 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373449135689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373449135689728 [0;39m ==> Parameters: 
2021-08-27 16:17:15.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373449135689728 [0;39m <==    Updates: 0
2021-08-27 16:17:15.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373449135689728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:17:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373470061072384 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373470061072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373470061072384 [0;39m ==> Parameters: 
2021-08-27 16:17:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373470061072384 [0;39m <==    Updates: 0
2021-08-27 16:17:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373470061072384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:17:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373491045175296 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373491045175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373491045175296 [0;39m ==> Parameters: 
2021-08-27 16:17:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373491045175296 [0;39m <==    Updates: 0
2021-08-27 16:17:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373491045175296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:17:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373512016695296 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373512016695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373512016695296 [0;39m ==> Parameters: 
2021-08-27 16:17:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373512016695296 [0;39m <==    Updates: 0
2021-08-27 16:17:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373512016695296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:17:35.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373532975632384 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373532975632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373532975632384 [0;39m ==> Parameters: 
2021-08-27 16:17:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373532975632384 [0;39m <==    Updates: 0
2021-08-27 16:17:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373532975632384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:17:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86373532988215296 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:17:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373532988215296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:17:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373532988215296 [0;39m ==> Parameters: 
2021-08-27 16:17:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373532988215296 [0;39m <==    Updates: 5
2021-08-27 16:17:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86373532988215296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:17:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373553942958080 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373553942958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373553942958080 [0;39m ==> Parameters: 
2021-08-27 16:17:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373553942958080 [0;39m <==    Updates: 0
2021-08-27 16:17:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373553942958080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:17:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373574956421120 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373574956421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373574956421120 [0;39m ==> Parameters: 
2021-08-27 16:17:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373574956421120 [0;39m <==    Updates: 0
2021-08-27 16:17:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373574956421120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:17:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373595927941120 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373595927941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373595927941120 [0;39m ==> Parameters: 
2021-08-27 16:17:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373595927941120 [0;39m <==    Updates: 0
2021-08-27 16:17:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373595927941120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:17:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373616891072512 [0;39m 生成今日电子书快照开始
2021-08-27 16:17:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373616891072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:17:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373616891072512 [0;39m ==> Parameters: 
2021-08-27 16:17:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373616891072512 [0;39m <==    Updates: 0
2021-08-27 16:17:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373616891072512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:18:00.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373637829038080 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373637829038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373637829038080 [0;39m ==> Parameters: 
2021-08-27 16:18:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373637829038080 [0;39m <==    Updates: 0
2021-08-27 16:18:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373637829038080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:18:05.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373658796363776 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373658796363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373658796363776 [0;39m ==> Parameters: 
2021-08-27 16:18:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373658796363776 [0;39m <==    Updates: 0
2021-08-27 16:18:05.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373658796363776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:18:05.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86373658800558080 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:18:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373658800558080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:18:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373658800558080 [0;39m ==> Parameters: 
2021-08-27 16:18:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373658800558080 [0;39m <==    Updates: 5
2021-08-27 16:18:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86373658800558080 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:18:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373679801438208 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373679801438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373679801438208 [0;39m ==> Parameters: 
2021-08-27 16:18:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373679801438208 [0;39m <==    Updates: 0
2021-08-27 16:18:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373679801438208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:18:15.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373700785541120 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373700785541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373700785541120 [0;39m ==> Parameters: 
2021-08-27 16:18:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373700785541120 [0;39m <==    Updates: 0
2021-08-27 16:18:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373700785541120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:18:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373721727700992 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373721727700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373721727700992 [0;39m ==> Parameters: 
2021-08-27 16:18:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373721727700992 [0;39m <==    Updates: 0
2021-08-27 16:18:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373721727700992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:18:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373742695026688 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373742695026688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373742695026688 [0;39m ==> Parameters: 
2021-08-27 16:18:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373742695026688 [0;39m <==    Updates: 0
2021-08-27 16:18:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373742695026688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:18:30.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373763708489728 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373763708489728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373763708489728 [0;39m ==> Parameters: 
2021-08-27 16:18:30.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373763708489728 [0;39m <==    Updates: 0
2021-08-27 16:18:30.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373763708489728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:18:35.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86373784642260992 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:18:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373784642260992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:18:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373784642260992 [0;39m ==> Parameters: 
2021-08-27 16:18:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373784642260992 [0;39m <==    Updates: 5
2021-08-27 16:18:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86373784642260992 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:18:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373784646455296 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373784646455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373784646455296 [0;39m ==> Parameters: 
2021-08-27 16:18:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373784646455296 [0;39m <==    Updates: 0
2021-08-27 16:18:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373784646455296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:18:40.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373805592809472 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:40.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373805592809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:40.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373805592809472 [0;39m ==> Parameters: 
2021-08-27 16:18:40.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373805592809472 [0;39m <==    Updates: 0
2021-08-27 16:18:40.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373805592809472 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:18:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373826623049728 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373826623049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373826623049728 [0;39m ==> Parameters: 
2021-08-27 16:18:45.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373826623049728 [0;39m <==    Updates: 0
2021-08-27 16:18:45.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373826623049728 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:18:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373847565209600 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373847565209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373847565209600 [0;39m ==> Parameters: 
2021-08-27 16:18:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373847565209600 [0;39m <==    Updates: 0
2021-08-27 16:18:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373847565209600 [0;39m 生成今日电子书快照结束，耗时：7毫秒
2021-08-27 16:18:55.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373868528340992 [0;39m 生成今日电子书快照开始
2021-08-27 16:18:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373868528340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:18:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373868528340992 [0;39m ==> Parameters: 
2021-08-27 16:18:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373868528340992 [0;39m <==    Updates: 0
2021-08-27 16:18:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373868528340992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:19:00.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373889537609728 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:00.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373889537609728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:00.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373889537609728 [0;39m ==> Parameters: 
2021-08-27 16:19:00.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373889537609728 [0;39m <==    Updates: 0
2021-08-27 16:19:00.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373889537609728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:19:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373910488158208 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373910488158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373910488158208 [0;39m ==> Parameters: 
2021-08-27 16:19:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373910488158208 [0;39m <==    Updates: 0
2021-08-27 16:19:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373910488158208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:19:05.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86373910496546816 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:19:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373910496546816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:19:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373910496546816 [0;39m ==> Parameters: 
2021-08-27 16:19:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86373910496546816 [0;39m <==    Updates: 5
2021-08-27 16:19:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86373910496546816 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:19:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373931447095296 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373931447095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373931447095296 [0;39m ==> Parameters: 
2021-08-27 16:19:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373931447095296 [0;39m <==    Updates: 0
2021-08-27 16:19:10.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373931447095296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:19:15.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373952431198208 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373952431198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373952431198208 [0;39m ==> Parameters: 
2021-08-27 16:19:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373952431198208 [0;39m <==    Updates: 0
2021-08-27 16:19:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373952431198208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:19:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373973415301120 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373973415301120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373973415301120 [0;39m ==> Parameters: 
2021-08-27 16:19:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373973415301120 [0;39m <==    Updates: 0
2021-08-27 16:19:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373973415301120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:19:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86373994344878080 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373994344878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373994344878080 [0;39m ==> Parameters: 
2021-08-27 16:19:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86373994344878080 [0;39m <==    Updates: 0
2021-08-27 16:19:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86373994344878080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:19:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374015349952512 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374015349952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374015349952512 [0;39m ==> Parameters: 
2021-08-27 16:19:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374015349952512 [0;39m <==    Updates: 0
2021-08-27 16:19:30.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374015349952512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:19:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374036296306688 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374036296306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374036296306688 [0;39m ==> Parameters: 
2021-08-27 16:19:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374036296306688 [0;39m <==    Updates: 0
2021-08-27 16:19:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374036296306688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:19:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86374036304695296 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:19:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374036304695296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:19:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374036304695296 [0;39m ==> Parameters: 
2021-08-27 16:19:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374036304695296 [0;39m <==    Updates: 5
2021-08-27 16:19:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86374036304695296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:19:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374057267826688 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374057267826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374057267826688 [0;39m ==> Parameters: 
2021-08-27 16:19:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374057267826688 [0;39m <==    Updates: 0
2021-08-27 16:19:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374057267826688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:19:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374078272901120 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374078272901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374078272901120 [0;39m ==> Parameters: 
2021-08-27 16:19:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374078272901120 [0;39m <==    Updates: 0
2021-08-27 16:19:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374078272901120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:19:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374099223449600 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:50.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374099223449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374099223449600 [0;39m ==> Parameters: 
2021-08-27 16:19:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374099223449600 [0;39m <==    Updates: 0
2021-08-27 16:19:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374099223449600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:19:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374120224329728 [0;39m 生成今日电子书快照开始
2021-08-27 16:19:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374120224329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:19:55.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374120224329728 [0;39m ==> Parameters: 
2021-08-27 16:19:55.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374120224329728 [0;39m <==    Updates: 0
2021-08-27 16:19:55.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374120224329728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:20:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374141153906688 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374141153906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374141153906688 [0;39m ==> Parameters: 
2021-08-27 16:20:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374141153906688 [0;39m <==    Updates: 0
2021-08-27 16:20:00.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374141153906688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:20:05.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86374162133815296 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:20:05.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374162133815296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:20:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374162133815296 [0;39m ==> Parameters: 
2021-08-27 16:20:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374162133815296 [0;39m <==    Updates: 5
2021-08-27 16:20:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86374162133815296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:20:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374162138009600 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374162138009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374162138009600 [0;39m ==> Parameters: 
2021-08-27 16:20:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374162138009600 [0;39m <==    Updates: 0
2021-08-27 16:20:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374162138009600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:20:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374183117918208 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374183117918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374183117918208 [0;39m ==> Parameters: 
2021-08-27 16:20:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374183117918208 [0;39m <==    Updates: 0
2021-08-27 16:20:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374183117918208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:20:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374204085243904 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374204085243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374204085243904 [0;39m ==> Parameters: 
2021-08-27 16:20:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374204085243904 [0;39m <==    Updates: 0
2021-08-27 16:20:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374204085243904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:20:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374225056763904 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374225056763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374225056763904 [0;39m ==> Parameters: 
2021-08-27 16:20:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374225056763904 [0;39m <==    Updates: 0
2021-08-27 16:20:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374225056763904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:20:25.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374245990535168 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:25.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374245990535168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:25.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374245990535168 [0;39m ==> Parameters: 
2021-08-27 16:20:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374245990535168 [0;39m <==    Updates: 0
2021-08-27 16:20:25.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374245990535168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:20:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374266999803904 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374266999803904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374266999803904 [0;39m ==> Parameters: 
2021-08-27 16:20:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374266999803904 [0;39m <==    Updates: 0
2021-08-27 16:20:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374266999803904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:20:35.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86374287950352384 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:20:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374287950352384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:20:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374287950352384 [0;39m ==> Parameters: 
2021-08-27 16:20:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374287950352384 [0;39m <==    Updates: 5
2021-08-27 16:20:35.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86374287950352384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:20:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374287958740992 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374287958740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374287958740992 [0;39m ==> Parameters: 
2021-08-27 16:20:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374287958740992 [0;39m <==    Updates: 0
2021-08-27 16:20:35.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374287958740992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:20:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374308934455296 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374308934455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374308934455296 [0;39m ==> Parameters: 
2021-08-27 16:20:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374308934455296 [0;39m <==    Updates: 0
2021-08-27 16:20:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374308934455296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:20:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374329897586688 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374329897586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374329897586688 [0;39m ==> Parameters: 
2021-08-27 16:20:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374329897586688 [0;39m <==    Updates: 0
2021-08-27 16:20:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374329897586688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:20:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374350881689600 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374350881689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374350881689600 [0;39m ==> Parameters: 
2021-08-27 16:20:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374350881689600 [0;39m <==    Updates: 0
2021-08-27 16:20:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374350881689600 [0;39m 生成今日电子书快照结束，耗时：7毫秒
2021-08-27 16:20:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374371840626688 [0;39m 生成今日电子书快照开始
2021-08-27 16:20:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374371840626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:20:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374371840626688 [0;39m ==> Parameters: 
2021-08-27 16:20:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374371840626688 [0;39m <==    Updates: 0
2021-08-27 16:20:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374371840626688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:21:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374392833118208 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374392833118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374392833118208 [0;39m ==> Parameters: 
2021-08-27 16:21:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374392833118208 [0;39m <==    Updates: 0
2021-08-27 16:21:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374392833118208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:21:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86374413804638208 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:21:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374413804638208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:21:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374413804638208 [0;39m ==> Parameters: 
2021-08-27 16:21:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374413804638208 [0;39m <==    Updates: 5
2021-08-27 16:21:05.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86374413804638208 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:21:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374413813026816 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374413813026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374413813026816 [0;39m ==> Parameters: 
2021-08-27 16:21:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374413813026816 [0;39m <==    Updates: 0
2021-08-27 16:21:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374413813026816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:21:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374434780352512 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374434780352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374434780352512 [0;39m ==> Parameters: 
2021-08-27 16:21:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374434780352512 [0;39m <==    Updates: 0
2021-08-27 16:21:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374434780352512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:21:15.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374455730900992 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374455730900992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374455730900992 [0;39m ==> Parameters: 
2021-08-27 16:21:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374455730900992 [0;39m <==    Updates: 0
2021-08-27 16:21:15.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374455730900992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:21:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374476715003904 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374476715003904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374476715003904 [0;39m ==> Parameters: 
2021-08-27 16:21:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374476715003904 [0;39m <==    Updates: 0
2021-08-27 16:21:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374476715003904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:21:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374497678135296 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374497678135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374497678135296 [0;39m ==> Parameters: 
2021-08-27 16:21:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374497678135296 [0;39m <==    Updates: 0
2021-08-27 16:21:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374497678135296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:21:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374518679015424 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374518679015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374518679015424 [0;39m ==> Parameters: 
2021-08-27 16:21:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374518679015424 [0;39m <==    Updates: 0
2021-08-27 16:21:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374518679015424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:21:35.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374539642146816 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374539642146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374539642146816 [0;39m ==> Parameters: 
2021-08-27 16:21:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374539642146816 [0;39m <==    Updates: 0
2021-08-27 16:21:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374539642146816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:21:35.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86374539646341120 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:21:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374539646341120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:21:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374539646341120 [0;39m ==> Parameters: 
2021-08-27 16:21:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374539646341120 [0;39m <==    Updates: 5
2021-08-27 16:21:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86374539646341120 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:21:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374560622055424 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374560622055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374560622055424 [0;39m ==> Parameters: 
2021-08-27 16:21:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374560622055424 [0;39m <==    Updates: 0
2021-08-27 16:21:40.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374560622055424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:21:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374581560020992 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374581560020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374581560020992 [0;39m ==> Parameters: 
2021-08-27 16:21:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374581560020992 [0;39m <==    Updates: 0
2021-08-27 16:21:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374581560020992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:21:50.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374602518958080 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:50.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374602518958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374602518958080 [0;39m ==> Parameters: 
2021-08-27 16:21:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374602518958080 [0;39m <==    Updates: 0
2021-08-27 16:21:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374602518958080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:21:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374623494672384 [0;39m 生成今日电子书快照开始
2021-08-27 16:21:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374623494672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:21:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374623494672384 [0;39m ==> Parameters: 
2021-08-27 16:21:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374623494672384 [0;39m <==    Updates: 0
2021-08-27 16:21:55.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374623494672384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:22:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374644487163904 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374644487163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374644487163904 [0;39m ==> Parameters: 
2021-08-27 16:22:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374644487163904 [0;39m <==    Updates: 0
2021-08-27 16:22:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374644487163904 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:22:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374665462878208 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374665462878208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374665462878208 [0;39m ==> Parameters: 
2021-08-27 16:22:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374665462878208 [0;39m <==    Updates: 0
2021-08-27 16:22:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374665462878208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:22:05.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86374665471266816 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:22:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374665471266816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:22:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374665471266816 [0;39m ==> Parameters: 
2021-08-27 16:22:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374665471266816 [0;39m <==    Updates: 5
2021-08-27 16:22:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86374665471266816 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:22:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374686434398208 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374686434398208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374686434398208 [0;39m ==> Parameters: 
2021-08-27 16:22:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374686434398208 [0;39m <==    Updates: 0
2021-08-27 16:22:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374686434398208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:22:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374707372363776 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374707372363776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374707372363776 [0;39m ==> Parameters: 
2021-08-27 16:22:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374707372363776 [0;39m <==    Updates: 0
2021-08-27 16:22:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374707372363776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:22:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374728356466688 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374728356466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374728356466688 [0;39m ==> Parameters: 
2021-08-27 16:22:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374728356466688 [0;39m <==    Updates: 0
2021-08-27 16:22:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374728356466688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:22:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374749340569600 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374749340569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374749340569600 [0;39m ==> Parameters: 
2021-08-27 16:22:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374749340569600 [0;39m <==    Updates: 0
2021-08-27 16:22:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374749340569600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:22:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374770337255424 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374770337255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374770337255424 [0;39m ==> Parameters: 
2021-08-27 16:22:30.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374770337255424 [0;39m <==    Updates: 0
2021-08-27 16:22:30.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374770337255424 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:22:35.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374791250055168 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:35.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374791250055168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:35.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374791250055168 [0;39m ==> Parameters: 
2021-08-27 16:22:35.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374791250055168 [0;39m <==    Updates: 0
2021-08-27 16:22:35.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374791250055168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:22:35.002 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86374791258443776 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:22:35.002 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374791258443776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:22:35.002 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374791258443776 [0;39m ==> Parameters: 
2021-08-27 16:22:35.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374791258443776 [0;39m <==    Updates: 5
2021-08-27 16:22:35.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86374791258443776 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:22:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374812242546688 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374812242546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374812242546688 [0;39m ==> Parameters: 
2021-08-27 16:22:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374812242546688 [0;39m <==    Updates: 0
2021-08-27 16:22:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374812242546688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:22:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374833209872384 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374833209872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374833209872384 [0;39m ==> Parameters: 
2021-08-27 16:22:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374833209872384 [0;39m <==    Updates: 0
2021-08-27 16:22:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374833209872384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:22:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374854219141120 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374854219141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374854219141120 [0;39m ==> Parameters: 
2021-08-27 16:22:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374854219141120 [0;39m <==    Updates: 0
2021-08-27 16:22:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374854219141120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:22:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374875186466816 [0;39m 生成今日电子书快照开始
2021-08-27 16:22:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374875186466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:22:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374875186466816 [0;39m ==> Parameters: 
2021-08-27 16:22:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374875186466816 [0;39m <==    Updates: 0
2021-08-27 16:22:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374875186466816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:23:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374896145403904 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374896145403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374896145403904 [0;39m ==> Parameters: 
2021-08-27 16:23:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374896145403904 [0;39m <==    Updates: 0
2021-08-27 16:23:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374896145403904 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:23:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86374917100146688 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:23:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374917100146688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:23:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374917100146688 [0;39m ==> Parameters: 
2021-08-27 16:23:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86374917100146688 [0;39m <==    Updates: 5
2021-08-27 16:23:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86374917100146688 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:23:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374917108535296 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374917108535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374917108535296 [0;39m ==> Parameters: 
2021-08-27 16:23:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374917108535296 [0;39m <==    Updates: 0
2021-08-27 16:23:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374917108535296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:23:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374938101026816 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374938101026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374938101026816 [0;39m ==> Parameters: 
2021-08-27 16:23:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374938101026816 [0;39m <==    Updates: 0
2021-08-27 16:23:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374938101026816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:23:15.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374959055769600 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374959055769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374959055769600 [0;39m ==> Parameters: 
2021-08-27 16:23:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374959055769600 [0;39m <==    Updates: 0
2021-08-27 16:23:15.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374959055769600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:23:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86374980010512384 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374980010512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374980010512384 [0;39m ==> Parameters: 
2021-08-27 16:23:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86374980010512384 [0;39m <==    Updates: 0
2021-08-27 16:23:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86374980010512384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:23:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375001023975424 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375001023975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375001023975424 [0;39m ==> Parameters: 
2021-08-27 16:23:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375001023975424 [0;39m <==    Updates: 0
2021-08-27 16:23:25.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375001023975424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:23:30.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375021949358080 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375021949358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375021949358080 [0;39m ==> Parameters: 
2021-08-27 16:23:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375021949358080 [0;39m <==    Updates: 0
2021-08-27 16:23:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375021949358080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:23:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86375042941849600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:23:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375042941849600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:23:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375042941849600 [0;39m ==> Parameters: 
2021-08-27 16:23:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375042941849600 [0;39m <==    Updates: 5
2021-08-27 16:23:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86375042941849600 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:23:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375042950238208 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375042950238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375042950238208 [0;39m ==> Parameters: 
2021-08-27 16:23:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375042950238208 [0;39m <==    Updates: 0
2021-08-27 16:23:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375042950238208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:23:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375063909175296 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375063909175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375063909175296 [0;39m ==> Parameters: 
2021-08-27 16:23:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375063909175296 [0;39m <==    Updates: 0
2021-08-27 16:23:40.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375063909175296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:23:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375084868112384 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375084868112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375084868112384 [0;39m ==> Parameters: 
2021-08-27 16:23:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375084868112384 [0;39m <==    Updates: 0
2021-08-27 16:23:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375084868112384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:23:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375105843826688 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375105843826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375105843826688 [0;39m ==> Parameters: 
2021-08-27 16:23:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375105843826688 [0;39m <==    Updates: 0
2021-08-27 16:23:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375105843826688 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:23:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375126844706816 [0;39m 生成今日电子书快照开始
2021-08-27 16:23:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375126844706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:23:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375126844706816 [0;39m ==> Parameters: 
2021-08-27 16:23:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375126844706816 [0;39m <==    Updates: 0
2021-08-27 16:23:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375126844706816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:24:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375147786866688 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375147786866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375147786866688 [0;39m ==> Parameters: 
2021-08-27 16:24:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375147786866688 [0;39m <==    Updates: 0
2021-08-27 16:24:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375147786866688 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:24:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375168791941120 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375168791941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375168791941120 [0;39m ==> Parameters: 
2021-08-27 16:24:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375168791941120 [0;39m <==    Updates: 0
2021-08-27 16:24:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375168791941120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:24:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86375168800329728 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:24:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375168800329728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:24:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375168800329728 [0;39m ==> Parameters: 
2021-08-27 16:24:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375168800329728 [0;39m <==    Updates: 5
2021-08-27 16:24:05.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86375168800329728 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:24:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375189759266816 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375189759266816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375189759266816 [0;39m ==> Parameters: 
2021-08-27 16:24:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375189759266816 [0;39m <==    Updates: 0
2021-08-27 16:24:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375189759266816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:24:15.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375210714009600 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375210714009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375210714009600 [0;39m ==> Parameters: 
2021-08-27 16:24:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375210714009600 [0;39m <==    Updates: 0
2021-08-27 16:24:15.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375210714009600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:24:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375231702306816 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375231702306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375231702306816 [0;39m ==> Parameters: 
2021-08-27 16:24:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375231702306816 [0;39m <==    Updates: 0
2021-08-27 16:24:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375231702306816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:24:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375252669632512 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375252669632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375252669632512 [0;39m ==> Parameters: 
2021-08-27 16:24:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375252669632512 [0;39m <==    Updates: 0
2021-08-27 16:24:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375252669632512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:24:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375273653735424 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375273653735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375273653735424 [0;39m ==> Parameters: 
2021-08-27 16:24:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375273653735424 [0;39m <==    Updates: 0
2021-08-27 16:24:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375273653735424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:24:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375294587506688 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375294587506688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375294587506688 [0;39m ==> Parameters: 
2021-08-27 16:24:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375294587506688 [0;39m <==    Updates: 0
2021-08-27 16:24:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375294587506688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:24:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86375294595895296 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:24:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375294595895296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:24:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375294595895296 [0;39m ==> Parameters: 
2021-08-27 16:24:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375294595895296 [0;39m <==    Updates: 5
2021-08-27 16:24:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86375294595895296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:24:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375315579998208 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375315579998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375315579998208 [0;39m ==> Parameters: 
2021-08-27 16:24:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375315579998208 [0;39m <==    Updates: 0
2021-08-27 16:24:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375315579998208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:24:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375336551518208 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375336551518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375336551518208 [0;39m ==> Parameters: 
2021-08-27 16:24:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375336551518208 [0;39m <==    Updates: 0
2021-08-27 16:24:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375336551518208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:24:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375357527232512 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375357527232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375357527232512 [0;39m ==> Parameters: 
2021-08-27 16:24:50.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375357527232512 [0;39m <==    Updates: 0
2021-08-27 16:24:50.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375357527232512 [0;39m 生成今日电子书快照结束，耗时：7毫秒
2021-08-27 16:24:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375378469392384 [0;39m 生成今日电子书快照开始
2021-08-27 16:24:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375378469392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:24:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375378469392384 [0;39m ==> Parameters: 
2021-08-27 16:24:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375378469392384 [0;39m <==    Updates: 0
2021-08-27 16:24:55.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375378469392384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:25:00.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375399428329472 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375399428329472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375399428329472 [0;39m ==> Parameters: 
2021-08-27 16:25:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375399428329472 [0;39m <==    Updates: 0
2021-08-27 16:25:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375399428329472 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:25:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375420420820992 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375420420820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375420420820992 [0;39m ==> Parameters: 
2021-08-27 16:25:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375420420820992 [0;39m <==    Updates: 0
2021-08-27 16:25:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375420420820992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:25:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86375420433403904 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:25:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375420433403904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:25:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375420433403904 [0;39m ==> Parameters: 
2021-08-27 16:25:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375420433403904 [0;39m <==    Updates: 5
2021-08-27 16:25:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86375420433403904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:25:10.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375441404923904 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375441404923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375441404923904 [0;39m ==> Parameters: 
2021-08-27 16:25:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375441404923904 [0;39m <==    Updates: 0
2021-08-27 16:25:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375441404923904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:25:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375462376443904 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375462376443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375462376443904 [0;39m ==> Parameters: 
2021-08-27 16:25:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375462376443904 [0;39m <==    Updates: 0
2021-08-27 16:25:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375462376443904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:25:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375483335380992 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375483335380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375483335380992 [0;39m ==> Parameters: 
2021-08-27 16:25:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375483335380992 [0;39m <==    Updates: 0
2021-08-27 16:25:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375483335380992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:25:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375504319483904 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375504319483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375504319483904 [0;39m ==> Parameters: 
2021-08-27 16:25:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375504319483904 [0;39m <==    Updates: 0
2021-08-27 16:25:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375504319483904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:25:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375525295198208 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375525295198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375525295198208 [0;39m ==> Parameters: 
2021-08-27 16:25:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375525295198208 [0;39m <==    Updates: 0
2021-08-27 16:25:30.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375525295198208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:25:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375546237358080 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375546237358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375546237358080 [0;39m ==> Parameters: 
2021-08-27 16:25:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375546237358080 [0;39m <==    Updates: 0
2021-08-27 16:25:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375546237358080 [0;39m 生成今日电子书快照结束，耗时：7毫秒
2021-08-27 16:25:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86375546270912512 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:25:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375546270912512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:25:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375546270912512 [0;39m ==> Parameters: 
2021-08-27 16:25:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375546270912512 [0;39m <==    Updates: 5
2021-08-27 16:25:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86375546270912512 [0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2021-08-27 16:25:40.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375567204683776 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375567204683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375567204683776 [0;39m ==> Parameters: 
2021-08-27 16:25:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375567204683776 [0;39m <==    Updates: 0
2021-08-27 16:25:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375567204683776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:25:45.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375588234924032 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:45.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375588234924032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:45.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375588234924032 [0;39m ==> Parameters: 
2021-08-27 16:25:45.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375588234924032 [0;39m <==    Updates: 0
2021-08-27 16:25:45.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375588234924032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:25:50.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375609168695296 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:50.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375609168695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:50.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375609168695296 [0;39m ==> Parameters: 
2021-08-27 16:25:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375609168695296 [0;39m <==    Updates: 0
2021-08-27 16:25:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375609168695296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:25:51.894 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :33   [32m86372297656635392 [0;39m 有新连接：token：dp3Bdsqrpt，session id：1，当前连接数：2
2021-08-27 16:25:51.910 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86375617150455810 [0;39m ------------- 开始 -------------
2021-08-27 16:25:51.910 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86375617150455809 [0;39m ------------- 开始 -------------
2021-08-27 16:25:51.910 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86375617150455808 [0;39m ------------- 开始 -------------
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86375617150455809 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86375617150455808 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86375617150455810 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86375617150455809 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86375617150455810 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86375617150455808 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86375617150455809 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86375617150455810 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86375617150455809 [0;39m 请求参数: []
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86375617150455808 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86375617150455810 [0;39m 请求参数: []
2021-08-27 16:25:51.911 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86375617150455808 [0;39m 请求参数: []
2021-08-27 16:25:51.912 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86375617150455810 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:25:51.912 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86375617150455809 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:25:51.912 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86375617150455808 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:25:51.912 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86375617150455809 [0;39m ==> Parameters: 
2021-08-27 16:25:51.912 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86375617150455810 [0;39m ==> Parameters: 
2021-08-27 16:25:51.912 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86375617150455808 [0;39m ==> Parameters: 
2021-08-27 16:25:51.913 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86375617150455810 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 16:25:51.913 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86375617150455809 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 16:25:51.913 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:25:51.913 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:25:51.913 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86375617150455809 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 16:25:51.913 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86375617150455810 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 16:25:51.914 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:25:51.914 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86375617150455809 [0;39m <==      Total: 1
2021-08-27 16:25:51.914 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86375617150455810 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 16:25:51.914 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:25:51.914 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86375617150455810 [0;39m <==      Total: 2
2021-08-27 16:25:51.914 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86375617150455809 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 16:25:51.914 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:25:51.914 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86375617150455809 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:25:51.914 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:25:51.914 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86375617150455810 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 16:25:51.915 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86375617150455810 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 16:25:51.915 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:25:51.915 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:25:51.915 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:25:51.915 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:25:51.915 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:25:51.915 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:25:51.916 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:25:51.916 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:25:51.916 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:25:51.916 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:25:51.917 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86375617150455808 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:25:51.917 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86375617150455808 [0;39m <==      Total: 16
2021-08-27 16:25:51.918 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86375617150455808 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:25:51.918 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86375617150455808 [0;39m ------------- 结束 耗时：8 ms -------------
2021-08-27 16:25:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375630148603904 [0;39m 生成今日电子书快照开始
2021-08-27 16:25:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375630148603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:25:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375630148603904 [0;39m ==> Parameters: 
2021-08-27 16:25:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375630148603904 [0;39m <==    Updates: 0
2021-08-27 16:25:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375630148603904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:26:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375651120123904 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375651120123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375651120123904 [0;39m ==> Parameters: 
2021-08-27 16:26:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375651120123904 [0;39m <==    Updates: 0
2021-08-27 16:26:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375651120123904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:26:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86375672079060992 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:26:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375672079060992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:26:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375672079060992 [0;39m ==> Parameters: 
2021-08-27 16:26:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375672079060992 [0;39m <==    Updates: 5
2021-08-27 16:26:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86375672079060992 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:26:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375672091643904 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375672091643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375672091643904 [0;39m ==> Parameters: 
2021-08-27 16:26:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375672091643904 [0;39m <==    Updates: 0
2021-08-27 16:26:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375672091643904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:26:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375693029609472 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375693029609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375693029609472 [0;39m ==> Parameters: 
2021-08-27 16:26:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375693029609472 [0;39m <==    Updates: 0
2021-08-27 16:26:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375693029609472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:26:15.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375714001129472 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:15.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375714001129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375714001129472 [0;39m ==> Parameters: 
2021-08-27 16:26:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375714001129472 [0;39m <==    Updates: 0
2021-08-27 16:26:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375714001129472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:26:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375734997815296 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375734997815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375734997815296 [0;39m ==> Parameters: 
2021-08-27 16:26:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375734997815296 [0;39m <==    Updates: 0
2021-08-27 16:26:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375734997815296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:26:25.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375755944169472 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:25.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375755944169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375755944169472 [0;39m ==> Parameters: 
2021-08-27 16:26:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375755944169472 [0;39m <==    Updates: 0
2021-08-27 16:26:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375755944169472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:26:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375776936660992 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375776936660992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375776936660992 [0;39m ==> Parameters: 
2021-08-27 16:26:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375776936660992 [0;39m <==    Updates: 0
2021-08-27 16:26:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375776936660992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:26:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375797912375296 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375797912375296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375797912375296 [0;39m ==> Parameters: 
2021-08-27 16:26:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375797912375296 [0;39m <==    Updates: 0
2021-08-27 16:26:35.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375797912375296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:26:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86375797916569600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:26:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375797916569600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:26:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375797916569600 [0;39m ==> Parameters: 
2021-08-27 16:26:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375797916569600 [0;39m <==    Updates: 5
2021-08-27 16:26:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86375797916569600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:26:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375818917449728 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375818917449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375818917449728 [0;39m ==> Parameters: 
2021-08-27 16:26:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375818917449728 [0;39m <==    Updates: 0
2021-08-27 16:26:40.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375818917449728 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:26:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375839884775424 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375839884775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375839884775424 [0;39m ==> Parameters: 
2021-08-27 16:26:45.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375839884775424 [0;39m <==    Updates: 0
2021-08-27 16:26:45.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375839884775424 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:26:50.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375860797575168 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:50.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375860797575168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:50.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375860797575168 [0;39m ==> Parameters: 
2021-08-27 16:26:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375860797575168 [0;39m <==    Updates: 0
2021-08-27 16:26:50.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375860797575168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:26:50.576 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m86372304312995841 [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 16:26:50.576 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m86372304312995841 [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2021-08-27 16:26:50.578 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m86372304308801536 [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 16:26:50.578 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :43   [32m86372304308801536 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/user/logout/86371772408139776
2021-08-27 16:26:50.578 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :47   [32m86372304308801536 [0;39m 登录校验开始，token：86371772408139776
2021-08-27 16:26:50.580 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :59   [32m86372304308801536 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"86371772408139776"}
2021-08-27 16:26:50.586 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86375863255437312 [0;39m ------------- 开始 -------------
2021-08-27 16:26:50.586 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86375863255437312 [0;39m 请求地址: http://127.0.0.1:8880/user/logout/86371772408139776 GET
2021-08-27 16:26:50.586 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86375863255437312 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.logout
2021-08-27 16:26:50.586 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86375863255437312 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:26:50.586 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86375863255437312 [0;39m 请求参数: ["86371772408139776"]
2021-08-27 16:26:50.588 INFO  com.haoyu.knowlagebase.controller.UserController  :93   [32m86375863255437312 [0;39m 从redis中删除token: 86371772408139776
2021-08-27 16:26:50.589 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86375863255437312 [0;39m 返回结果: {"success":true}
2021-08-27 16:26:50.589 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86375863255437312 [0;39m ------------- 结束 耗时：3 ms -------------
2021-08-27 16:26:50.590 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m86375863255437312 [0;39m ------------- LoginInterceptor 结束 耗时：12 ms -------------
2021-08-27 16:26:52.855 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86375872772313088 [0;39m ------------- 开始 -------------
2021-08-27 16:26:52.855 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86375872772313088 [0;39m 请求地址: http://127.0.0.1:8880/user/login POST
2021-08-27 16:26:52.855 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86375872772313088 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.login
2021-08-27 16:26:52.855 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86375872772313088 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:26:52.855 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86375872772313088 [0;39m 请求参数: [{"loginName":"test"}]
2021-08-27 16:26:52.857 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86375872772313088 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-08-27 16:26:52.857 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86375872772313088 [0;39m ==> Parameters: test(String)
2021-08-27 16:26:52.858 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86375872772313088 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 16:26:52.858 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86375872772313088 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 16:26:52.858 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86375872772313088 [0;39m <==      Total: 1
2021-08-27 16:26:52.859 INFO  com.haoyu.knowlagebase.controller.UserController  :81   [32m86375872772313088 [0;39m 生成单点登录token：86375872789090304，并放入redis中
2021-08-27 16:26:52.860 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86375872772313088 [0;39m 返回结果: {"content":{"id":1,"loginName":"test","name":"测试","token":"86375872789090304"},"success":true}
2021-08-27 16:26:52.860 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86375872772313088 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 16:26:55.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375881802649600 [0;39m 生成今日电子书快照开始
2021-08-27 16:26:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375881802649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:26:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375881802649600 [0;39m ==> Parameters: 
2021-08-27 16:26:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375881802649600 [0;39m <==    Updates: 0
2021-08-27 16:26:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375881802649600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375902790946816 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375902790946816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375902790946816 [0;39m ==> Parameters: 
2021-08-27 16:27:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375902790946816 [0;39m <==    Updates: 0
2021-08-27 16:27:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375902790946816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86375923770855424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:27:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375923770855424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:27:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375923770855424 [0;39m ==> Parameters: 
2021-08-27 16:27:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86375923770855424 [0;39m <==    Updates: 5
2021-08-27 16:27:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86375923770855424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:27:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375923775049728 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375923775049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375923775049728 [0;39m ==> Parameters: 
2021-08-27 16:27:05.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375923775049728 [0;39m <==    Updates: 0
2021-08-27 16:27:05.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375923775049728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:10.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375944683655168 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:10.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375944683655168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375944683655168 [0;39m ==> Parameters: 
2021-08-27 16:27:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375944683655168 [0;39m <==    Updates: 0
2021-08-27 16:27:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375944683655168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375965718089728 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375965718089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375965718089728 [0;39m ==> Parameters: 
2021-08-27 16:27:15.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375965718089728 [0;39m <==    Updates: 0
2021-08-27 16:27:15.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375965718089728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86375986668638208 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375986668638208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375986668638208 [0;39m ==> Parameters: 
2021-08-27 16:27:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86375986668638208 [0;39m <==    Updates: 0
2021-08-27 16:27:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86375986668638208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376007619186688 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376007619186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376007619186688 [0;39m ==> Parameters: 
2021-08-27 16:27:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376007619186688 [0;39m <==    Updates: 0
2021-08-27 16:27:25.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376007619186688 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:27:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376028590706688 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376028590706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376028590706688 [0;39m ==> Parameters: 
2021-08-27 16:27:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376028590706688 [0;39m <==    Updates: 0
2021-08-27 16:27:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376028590706688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376049583198208 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376049583198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376049583198208 [0;39m ==> Parameters: 
2021-08-27 16:27:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376049583198208 [0;39m <==    Updates: 0
2021-08-27 16:27:35.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376049583198208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86376049591586816 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:27:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376049591586816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:27:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376049591586816 [0;39m ==> Parameters: 
2021-08-27 16:27:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376049591586816 [0;39m <==    Updates: 5
2021-08-27 16:27:35.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86376049591586816 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:27:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376070563106816 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376070563106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376070563106816 [0;39m ==> Parameters: 
2021-08-27 16:27:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376070563106816 [0;39m <==    Updates: 0
2021-08-27 16:27:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376070563106816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376091538821120 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376091538821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376091538821120 [0;39m ==> Parameters: 
2021-08-27 16:27:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376091538821120 [0;39m <==    Updates: 0
2021-08-27 16:27:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376091538821120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:27:45.115 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :42   [32m86372297656635392 [0;39m 连接关闭，token：3sIhLoIH6Q，session id：0！当前连接数：0
2021-08-27 16:27:45.115 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :42   [32m86372280950722560 [0;39m 连接关闭，token：dp3Bdsqrpt，session id：1！当前连接数：1
2021-08-27 16:27:45.778 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :33   [32m86375617150455809 [0;39m 有新连接：token：j3K9mgSogz，session id：2，当前连接数：1
2021-08-27 16:27:45.877 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86376095162699776 [0;39m ------------- 开始 -------------
2021-08-27 16:27:45.878 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86376095162699776 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 16:27:45.878 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86376095162699776 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 16:27:45.878 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86376095162699776 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:27:45.878 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86376095162699776 [0;39m 请求参数: []
2021-08-27 16:27:45.879 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86376095162699776 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:27:45.879 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86376095162699776 [0;39m ==> Parameters: 
2021-08-27 16:27:45.880 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86376095162699776 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 16:27:45.880 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86376095162699776 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 16:27:45.880 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86376095162699776 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 16:27:45.880 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86376095162699776 [0;39m <==      Total: 2
2021-08-27 16:27:45.881 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86376095162699776 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 16:27:45.881 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86376095162699776 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:27:45.924 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86376095359832064 [0;39m ------------- 开始 -------------
2021-08-27 16:27:45.924 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86376095359832065 [0;39m ------------- 开始 -------------
2021-08-27 16:27:45.924 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86376095359832064 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:27:45.925 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86376095359832065 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 16:27:45.925 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86376095359832064 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:27:45.925 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86376095359832065 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 16:27:45.925 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86376095359832064 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:27:45.925 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86376095359832065 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:27:45.925 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86376095359832064 [0;39m 请求参数: []
2021-08-27 16:27:45.925 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86376095359832065 [0;39m 请求参数: []
2021-08-27 16:27:45.925 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86376095359832064 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:27:45.925 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86376095359832064 [0;39m ==> Parameters: 
2021-08-27 16:27:45.925 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86376095359832065 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:27:45.926 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86376095359832065 [0;39m ==> Parameters: 
2021-08-27 16:27:45.926 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:27:45.926 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:27:45.926 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86376095359832065 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 16:27:45.926 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:27:45.926 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86376095359832065 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 16:27:45.927 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:27:45.927 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:27:45.927 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86376095359832065 [0;39m <==      Total: 1
2021-08-27 16:27:45.927 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:27:45.927 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:27:45.927 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86376095359832065 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 16:27:45.927 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:27:45.927 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86376095359832065 [0;39m ------------- 结束 耗时：3 ms -------------
2021-08-27 16:27:45.927 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:27:45.927 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:27:45.928 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:27:45.928 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:27:45.928 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:27:45.928 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:27:45.928 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:27:45.929 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:27:45.929 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376095359832064 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:27:45.929 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86376095359832064 [0;39m <==      Total: 16
2021-08-27 16:27:45.930 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86376095359832064 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:27:45.930 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86376095359832064 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:27:50.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376112468398080 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376112468398080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376112468398080 [0;39m ==> Parameters: 
2021-08-27 16:27:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376112468398080 [0;39m <==    Updates: 0
2021-08-27 16:27:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376112468398080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86376122656362496 [0;39m ------------- 开始 -------------
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86376122656362497 [0;39m ------------- 开始 -------------
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86376122656362497 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86376122656362496 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86376122656362498 [0;39m ------------- 开始 -------------
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86376122656362497 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86376122656362496 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86376122656362498 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86376122656362497 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:27:52.432 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86376122656362496 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:27:52.433 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86376122656362498 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:27:52.433 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86376122656362497 [0;39m 请求参数: []
2021-08-27 16:27:52.433 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86376122656362496 [0;39m 请求参数: []
2021-08-27 16:27:52.433 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86376122656362498 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:27:52.433 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86376122656362498 [0;39m 请求参数: []
2021-08-27 16:27:52.433 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86376122656362496 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:27:52.433 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86376122656362497 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:27:52.433 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86376122656362498 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:27:52.433 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86376122656362497 [0;39m ==> Parameters: 
2021-08-27 16:27:52.433 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86376122656362496 [0;39m ==> Parameters: 
2021-08-27 16:27:52.433 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86376122656362498 [0;39m ==> Parameters: 
2021-08-27 16:27:52.434 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86376122656362497 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 16:27:52.434 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:27:52.434 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86376122656362496 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 16:27:52.434 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86376122656362497 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 16:27:52.434 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:27:52.434 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86376122656362496 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 16:27:52.435 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:27:52.435 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:27:52.435 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:27:52.436 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:27:52.436 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86376122656362496 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 16:27:52.436 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86376122656362497 [0;39m <==      Total: 1
2021-08-27 16:27:52.436 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:27:52.436 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:27:52.436 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86376122656362497 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 16:27:52.436 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86376122656362497 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:27:52.436 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:27:52.436 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86376122656362496 [0;39m <==      Total: 2
2021-08-27 16:27:52.436 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:27:52.436 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86376122656362496 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 16:27:52.436 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:27:52.436 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86376122656362496 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:27:52.436 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:27:52.437 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:27:52.437 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:27:52.437 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:27:52.437 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:27:52.438 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86376122656362498 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:27:52.438 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86376122656362498 [0;39m <==      Total: 16
2021-08-27 16:27:52.438 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86376122656362498 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:27:52.438 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86376122656362498 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:27:55.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376133431529472 [0;39m 生成今日电子书快照开始
2021-08-27 16:27:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376133431529472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:27:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376133431529472 [0;39m ==> Parameters: 
2021-08-27 16:27:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376133431529472 [0;39m <==    Updates: 0
2021-08-27 16:27:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376133431529472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376154428215296 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376154428215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376154428215296 [0;39m ==> Parameters: 
2021-08-27 16:28:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376154428215296 [0;39m <==    Updates: 0
2021-08-27 16:28:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376154428215296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:05.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86376175382958080 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:28:05.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376175382958080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:28:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376175382958080 [0;39m ==> Parameters: 
2021-08-27 16:28:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376175382958080 [0;39m <==    Updates: 5
2021-08-27 16:28:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86376175382958080 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:28:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376175387152384 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376175387152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376175387152384 [0;39m ==> Parameters: 
2021-08-27 16:28:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376175387152384 [0;39m <==    Updates: 0
2021-08-27 16:28:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376175387152384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:28:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376196383838208 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376196383838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376196383838208 [0;39m ==> Parameters: 
2021-08-27 16:28:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376196383838208 [0;39m <==    Updates: 0
2021-08-27 16:28:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376196383838208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:15.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376217367941120 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376217367941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376217367941120 [0;39m ==> Parameters: 
2021-08-27 16:28:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376217367941120 [0;39m <==    Updates: 0
2021-08-27 16:28:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376217367941120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376238305906688 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376238305906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376238305906688 [0;39m ==> Parameters: 
2021-08-27 16:28:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376238305906688 [0;39m <==    Updates: 0
2021-08-27 16:28:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376238305906688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376259298398208 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376259298398208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376259298398208 [0;39m ==> Parameters: 
2021-08-27 16:28:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376259298398208 [0;39m <==    Updates: 0
2021-08-27 16:28:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376259298398208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:30.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376280278306816 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376280278306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376280278306816 [0;39m ==> Parameters: 
2021-08-27 16:28:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376280278306816 [0;39m <==    Updates: 0
2021-08-27 16:28:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376280278306816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376301245632512 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376301245632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376301245632512 [0;39m ==> Parameters: 
2021-08-27 16:28:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376301245632512 [0;39m <==    Updates: 0
2021-08-27 16:28:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376301245632512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86376301258215424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:28:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376301258215424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:28:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376301258215424 [0;39m ==> Parameters: 
2021-08-27 16:28:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376301258215424 [0;39m <==    Updates: 5
2021-08-27 16:28:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86376301258215424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:28:40.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376322217152512 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376322217152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376322217152512 [0;39m ==> Parameters: 
2021-08-27 16:28:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376322217152512 [0;39m <==    Updates: 0
2021-08-27 16:28:40.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376322217152512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:45.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376343142535168 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:45.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376343142535168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:45.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376343142535168 [0;39m ==> Parameters: 
2021-08-27 16:28:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376343142535168 [0;39m <==    Updates: 0
2021-08-27 16:28:45.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376343142535168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376364172775424 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376364172775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376364172775424 [0;39m ==> Parameters: 
2021-08-27 16:28:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376364172775424 [0;39m <==    Updates: 0
2021-08-27 16:28:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376364172775424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:28:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376385144295424 [0;39m 生成今日电子书快照开始
2021-08-27 16:28:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376385144295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:28:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376385144295424 [0;39m ==> Parameters: 
2021-08-27 16:28:55.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376385144295424 [0;39m <==    Updates: 0
2021-08-27 16:28:55.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376385144295424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:29:00.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376406090649600 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376406090649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376406090649600 [0;39m ==> Parameters: 
2021-08-27 16:29:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376406090649600 [0;39m <==    Updates: 0
2021-08-27 16:29:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376406090649600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:29:05.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376427037003776 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376427037003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376427037003776 [0;39m ==> Parameters: 
2021-08-27 16:29:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376427037003776 [0;39m <==    Updates: 0
2021-08-27 16:29:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376427037003776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:29:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86376427045392384 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:29:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376427045392384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:29:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376427045392384 [0;39m ==> Parameters: 
2021-08-27 16:29:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376427045392384 [0;39m <==    Updates: 5
2021-08-27 16:29:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86376427045392384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:29:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376448016912384 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376448016912384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376448016912384 [0;39m ==> Parameters: 
2021-08-27 16:29:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376448016912384 [0;39m <==    Updates: 0
2021-08-27 16:29:10.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376448016912384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:29:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376468988432384 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376468988432384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376468988432384 [0;39m ==> Parameters: 
2021-08-27 16:29:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376468988432384 [0;39m <==    Updates: 0
2021-08-27 16:29:15.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376468988432384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:29:20.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376489943175168 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:20.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376489943175168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:20.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376489943175168 [0;39m ==> Parameters: 
2021-08-27 16:29:20.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376489943175168 [0;39m <==    Updates: 0
2021-08-27 16:29:20.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376489943175168 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:29:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376510935666688 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376510935666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376510935666688 [0;39m ==> Parameters: 
2021-08-27 16:29:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376510935666688 [0;39m <==    Updates: 0
2021-08-27 16:29:25.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376510935666688 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:29:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376531911380992 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376531911380992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376531911380992 [0;39m ==> Parameters: 
2021-08-27 16:29:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376531911380992 [0;39m <==    Updates: 0
2021-08-27 16:29:30.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376531911380992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:29:35.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376552874512384 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376552874512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376552874512384 [0;39m ==> Parameters: 
2021-08-27 16:29:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376552874512384 [0;39m <==    Updates: 0
2021-08-27 16:29:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376552874512384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:29:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86376552878706688 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:29:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376552878706688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:29:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376552878706688 [0;39m ==> Parameters: 
2021-08-27 16:29:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376552878706688 [0;39m <==    Updates: 5
2021-08-27 16:29:35.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86376552878706688 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 16:29:40.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376573896364032 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376573896364032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:40.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376573896364032 [0;39m ==> Parameters: 
2021-08-27 16:29:40.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376573896364032 [0;39m <==    Updates: 0
2021-08-27 16:29:40.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376573896364032 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:29:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376594825940992 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376594825940992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376594825940992 [0;39m ==> Parameters: 
2021-08-27 16:29:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376594825940992 [0;39m <==    Updates: 0
2021-08-27 16:29:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376594825940992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:29:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376615826821120 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376615826821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376615826821120 [0;39m ==> Parameters: 
2021-08-27 16:29:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376615826821120 [0;39m <==    Updates: 0
2021-08-27 16:29:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376615826821120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:29:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376636789952512 [0;39m 生成今日电子书快照开始
2021-08-27 16:29:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376636789952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:29:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376636789952512 [0;39m ==> Parameters: 
2021-08-27 16:29:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376636789952512 [0;39m <==    Updates: 0
2021-08-27 16:29:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376636789952512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:30:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376657769861120 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376657769861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376657769861120 [0;39m ==> Parameters: 
2021-08-27 16:30:00.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376657769861120 [0;39m <==    Updates: 0
2021-08-27 16:30:00.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376657769861120 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:30:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376678703632384 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376678703632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376678703632384 [0;39m ==> Parameters: 
2021-08-27 16:30:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376678703632384 [0;39m <==    Updates: 0
2021-08-27 16:30:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376678703632384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:30:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86376678712020992 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:30:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376678712020992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:30:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376678712020992 [0;39m ==> Parameters: 
2021-08-27 16:30:05.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376678712020992 [0;39m <==    Updates: 5
2021-08-27 16:30:05.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86376678712020992 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:30:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376699712901120 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376699712901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376699712901120 [0;39m ==> Parameters: 
2021-08-27 16:30:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376699712901120 [0;39m <==    Updates: 0
2021-08-27 16:30:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376699712901120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:30:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376720638283776 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376720638283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376720638283776 [0;39m ==> Parameters: 
2021-08-27 16:30:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376720638283776 [0;39m <==    Updates: 0
2021-08-27 16:30:15.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376720638283776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:30:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376741634969600 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376741634969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376741634969600 [0;39m ==> Parameters: 
2021-08-27 16:30:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376741634969600 [0;39m <==    Updates: 0
2021-08-27 16:30:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376741634969600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:30:25.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376762577129472 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:25.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376762577129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376762577129472 [0;39m ==> Parameters: 
2021-08-27 16:30:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376762577129472 [0;39m <==    Updates: 0
2021-08-27 16:30:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376762577129472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:30:30.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376783548649472 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376783548649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376783548649472 [0;39m ==> Parameters: 
2021-08-27 16:30:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376783548649472 [0;39m <==    Updates: 0
2021-08-27 16:30:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376783548649472 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:30:35.002 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86376804524363776 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:30:35.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376804524363776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:30:35.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376804524363776 [0;39m ==> Parameters: 
2021-08-27 16:30:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376804524363776 [0;39m <==    Updates: 5
2021-08-27 16:30:35.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86376804524363776 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:30:35.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376804532752384 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376804532752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376804532752384 [0;39m ==> Parameters: 
2021-08-27 16:30:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376804532752384 [0;39m <==    Updates: 0
2021-08-27 16:30:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376804532752384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:30:40.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376825495883776 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376825495883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376825495883776 [0;39m ==> Parameters: 
2021-08-27 16:30:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376825495883776 [0;39m <==    Updates: 0
2021-08-27 16:30:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376825495883776 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:30:45.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376846463209472 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:45.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376846463209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376846463209472 [0;39m ==> Parameters: 
2021-08-27 16:30:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376846463209472 [0;39m <==    Updates: 0
2021-08-27 16:30:45.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376846463209472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:30:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376867485061120 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376867485061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376867485061120 [0;39m ==> Parameters: 
2021-08-27 16:30:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376867485061120 [0;39m <==    Updates: 0
2021-08-27 16:30:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376867485061120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:30:55.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376888406249472 [0;39m 生成今日电子书快照开始
2021-08-27 16:30:55.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376888406249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:30:55.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376888406249472 [0;39m ==> Parameters: 
2021-08-27 16:30:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376888406249472 [0;39m <==    Updates: 0
2021-08-27 16:30:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376888406249472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:30:59.362 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :42   [32m86375617150455809 [0;39m 连接关闭，token：j3K9mgSogz，session id：2！当前连接数：0
2021-08-27 16:31:00.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376909386158080 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:00.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376909386158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376909386158080 [0;39m ==> Parameters: 
2021-08-27 16:31:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376909386158080 [0;39m <==    Updates: 0
2021-08-27 16:31:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376909386158080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:31:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376930408009728 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376930408009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:05.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376930408009728 [0;39m ==> Parameters: 
2021-08-27 16:31:05.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376930408009728 [0;39m <==    Updates: 0
2021-08-27 16:31:05.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376930408009728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:31:05.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86376930416398336 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:31:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376930416398336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:31:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376930416398336 [0;39m ==> Parameters: 
2021-08-27 16:31:05.018 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86376930416398336 [0;39m <==    Updates: 5
2021-08-27 16:31:05.018 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86376930416398336 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:31:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376951341780992 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376951341780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376951341780992 [0;39m ==> Parameters: 
2021-08-27 16:31:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376951341780992 [0;39m <==    Updates: 0
2021-08-27 16:31:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376951341780992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:31:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376972296523776 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376972296523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376972296523776 [0;39m ==> Parameters: 
2021-08-27 16:31:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376972296523776 [0;39m <==    Updates: 0
2021-08-27 16:31:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376972296523776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:31:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86376993280626688 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376993280626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376993280626688 [0;39m ==> Parameters: 
2021-08-27 16:31:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86376993280626688 [0;39m <==    Updates: 0
2021-08-27 16:31:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86376993280626688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:31:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377014285701120 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377014285701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377014285701120 [0;39m ==> Parameters: 
2021-08-27 16:31:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377014285701120 [0;39m <==    Updates: 0
2021-08-27 16:31:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377014285701120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:31:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377035261415424 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377035261415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377035261415424 [0;39m ==> Parameters: 
2021-08-27 16:31:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377035261415424 [0;39m <==    Updates: 0
2021-08-27 16:31:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377035261415424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:31:35.001 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86377056178409472 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:31:35.001 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377056178409472 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:31:35.001 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377056178409472 [0;39m ==> Parameters: 
2021-08-27 16:31:35.002 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377056178409472 [0;39m <==    Updates: 5
2021-08-27 16:31:35.002 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86377056178409472 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:31:35.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377056182603776 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:35.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377056182603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377056182603776 [0;39m ==> Parameters: 
2021-08-27 16:31:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377056182603776 [0;39m <==    Updates: 0
2021-08-27 16:31:35.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377056182603776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:31:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377077187678208 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377077187678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377077187678208 [0;39m ==> Parameters: 
2021-08-27 16:31:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377077187678208 [0;39m <==    Updates: 0
2021-08-27 16:31:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377077187678208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:31:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377098163392512 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377098163392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377098163392512 [0;39m ==> Parameters: 
2021-08-27 16:31:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377098163392512 [0;39m <==    Updates: 0
2021-08-27 16:31:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377098163392512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:31:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377119151689728 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377119151689728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377119151689728 [0;39m ==> Parameters: 
2021-08-27 16:31:50.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377119151689728 [0;39m <==    Updates: 0
2021-08-27 16:31:50.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377119151689728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:31:55.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377140060295168 [0;39m 生成今日电子书快照开始
2021-08-27 16:31:55.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377140060295168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:31:55.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377140060295168 [0;39m ==> Parameters: 
2021-08-27 16:31:55.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377140060295168 [0;39m <==    Updates: 0
2021-08-27 16:31:55.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377140060295168 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:32:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377161052786688 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377161052786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377161052786688 [0;39m ==> Parameters: 
2021-08-27 16:32:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377161052786688 [0;39m <==    Updates: 0
2021-08-27 16:32:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377161052786688 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:32:05.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377182024306688 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377182024306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377182024306688 [0;39m ==> Parameters: 
2021-08-27 16:32:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377182024306688 [0;39m <==    Updates: 0
2021-08-27 16:32:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377182024306688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:32:05.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86377182032695296 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:32:05.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377182032695296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:32:05.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377182032695296 [0;39m ==> Parameters: 
2021-08-27 16:32:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377182032695296 [0;39m <==    Updates: 5
2021-08-27 16:32:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86377182032695296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:32:10.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377203008409600 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377203008409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377203008409600 [0;39m ==> Parameters: 
2021-08-27 16:32:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377203008409600 [0;39m <==    Updates: 0
2021-08-27 16:32:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377203008409600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:32:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377224005095424 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377224005095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377224005095424 [0;39m ==> Parameters: 
2021-08-27 16:32:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377224005095424 [0;39m <==    Updates: 0
2021-08-27 16:32:15.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377224005095424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:32:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377244934672384 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377244934672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377244934672384 [0;39m ==> Parameters: 
2021-08-27 16:32:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377244934672384 [0;39m <==    Updates: 0
2021-08-27 16:32:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377244934672384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:32:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377265952329728 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377265952329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377265952329728 [0;39m ==> Parameters: 
2021-08-27 16:32:25.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377265952329728 [0;39m <==    Updates: 0
2021-08-27 16:32:25.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377265952329728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:32:30.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377286923849728 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377286923849728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377286923849728 [0;39m ==> Parameters: 
2021-08-27 16:32:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377286923849728 [0;39m <==    Updates: 0
2021-08-27 16:32:30.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377286923849728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:32:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377307857620992 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377307857620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377307857620992 [0;39m ==> Parameters: 
2021-08-27 16:32:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377307857620992 [0;39m <==    Updates: 0
2021-08-27 16:32:35.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377307857620992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:32:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86377307866009600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:32:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377307866009600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:32:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377307866009600 [0;39m ==> Parameters: 
2021-08-27 16:32:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377307866009600 [0;39m <==    Updates: 5
2021-08-27 16:32:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86377307866009600 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 16:32:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377328820752384 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377328820752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377328820752384 [0;39m ==> Parameters: 
2021-08-27 16:32:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377328820752384 [0;39m <==    Updates: 0
2021-08-27 16:32:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377328820752384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:32:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377349817438208 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377349817438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377349817438208 [0;39m ==> Parameters: 
2021-08-27 16:32:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377349817438208 [0;39m <==    Updates: 0
2021-08-27 16:32:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377349817438208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:32:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377370767986688 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377370767986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377370767986688 [0;39m ==> Parameters: 
2021-08-27 16:32:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377370767986688 [0;39m <==    Updates: 0
2021-08-27 16:32:50.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377370767986688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:32:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377391764672512 [0;39m 生成今日电子书快照开始
2021-08-27 16:32:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377391764672512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:32:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377391764672512 [0;39m ==> Parameters: 
2021-08-27 16:32:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377391764672512 [0;39m <==    Updates: 0
2021-08-27 16:32:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377391764672512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:00.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377412698443776 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:00.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377412698443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377412698443776 [0;39m ==> Parameters: 
2021-08-27 16:33:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377412698443776 [0;39m <==    Updates: 0
2021-08-27 16:33:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377412698443776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:33:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377433711906816 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377433711906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377433711906816 [0;39m ==> Parameters: 
2021-08-27 16:33:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377433711906816 [0;39m <==    Updates: 0
2021-08-27 16:33:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377433711906816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86377433720295424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:33:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377433720295424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:33:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377433720295424 [0;39m ==> Parameters: 
2021-08-27 16:33:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377433720295424 [0;39m <==    Updates: 5
2021-08-27 16:33:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86377433720295424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:33:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377454649872384 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377454649872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377454649872384 [0;39m ==> Parameters: 
2021-08-27 16:33:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377454649872384 [0;39m <==    Updates: 0
2021-08-27 16:33:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377454649872384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377475617198080 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377475617198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377475617198080 [0;39m ==> Parameters: 
2021-08-27 16:33:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377475617198080 [0;39m <==    Updates: 0
2021-08-27 16:33:15.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377475617198080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377496609689600 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377496609689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377496609689600 [0;39m ==> Parameters: 
2021-08-27 16:33:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377496609689600 [0;39m <==    Updates: 0
2021-08-27 16:33:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377496609689600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377517585403904 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377517585403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377517585403904 [0;39m ==> Parameters: 
2021-08-27 16:33:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377517585403904 [0;39m <==    Updates: 0
2021-08-27 16:33:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377517585403904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377538535952384 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377538535952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377538535952384 [0;39m ==> Parameters: 
2021-08-27 16:33:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377538535952384 [0;39m <==    Updates: 0
2021-08-27 16:33:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377538535952384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86377559549415424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:33:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377559549415424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:33:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377559549415424 [0;39m ==> Parameters: 
2021-08-27 16:33:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377559549415424 [0;39m <==    Updates: 5
2021-08-27 16:33:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86377559549415424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:33:35.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377559553609728 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377559553609728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377559553609728 [0;39m ==> Parameters: 
2021-08-27 16:33:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377559553609728 [0;39m <==    Updates: 0
2021-08-27 16:33:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377559553609728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:40.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377580462215168 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:40.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377580462215168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:40.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377580462215168 [0;39m ==> Parameters: 
2021-08-27 16:33:40.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377580462215168 [0;39m <==    Updates: 0
2021-08-27 16:33:40.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377580462215168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377601475678208 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377601475678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377601475678208 [0;39m ==> Parameters: 
2021-08-27 16:33:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377601475678208 [0;39m <==    Updates: 0
2021-08-27 16:33:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377601475678208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:33:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377622447198208 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377622447198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377622447198208 [0;39m ==> Parameters: 
2021-08-27 16:33:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377622447198208 [0;39m <==    Updates: 0
2021-08-27 16:33:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377622447198208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:33:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377643393552384 [0;39m 生成今日电子书快照开始
2021-08-27 16:33:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377643393552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:33:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377643393552384 [0;39m ==> Parameters: 
2021-08-27 16:33:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377643393552384 [0;39m <==    Updates: 0
2021-08-27 16:33:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377643393552384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:34:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377664369266688 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377664369266688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377664369266688 [0;39m ==> Parameters: 
2021-08-27 16:34:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377664369266688 [0;39m <==    Updates: 0
2021-08-27 16:34:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377664369266688 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:34:05.000 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86377685319815168 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:34:05.000 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377685319815168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:34:05.000 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377685319815168 [0;39m ==> Parameters: 
2021-08-27 16:34:05.001 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377685319815168 [0;39m <==    Updates: 5
2021-08-27 16:34:05.001 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86377685319815168 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:34:05.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377685324009472 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:05.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377685324009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:05.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377685324009472 [0;39m ==> Parameters: 
2021-08-27 16:34:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377685324009472 [0;39m <==    Updates: 0
2021-08-27 16:34:05.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377685324009472 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:34:10.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377706358444032 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:10.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377706358444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:10.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377706358444032 [0;39m ==> Parameters: 
2021-08-27 16:34:10.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377706358444032 [0;39m <==    Updates: 0
2021-08-27 16:34:10.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377706358444032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:34:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377727279632384 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377727279632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377727279632384 [0;39m ==> Parameters: 
2021-08-27 16:34:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377727279632384 [0;39m <==    Updates: 0
2021-08-27 16:34:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377727279632384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:34:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377748272123904 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377748272123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377748272123904 [0;39m ==> Parameters: 
2021-08-27 16:34:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377748272123904 [0;39m <==    Updates: 0
2021-08-27 16:34:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377748272123904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:34:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377769260421120 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377769260421120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377769260421120 [0;39m ==> Parameters: 
2021-08-27 16:34:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377769260421120 [0;39m <==    Updates: 0
2021-08-27 16:34:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377769260421120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:34:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377790236135424 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377790236135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377790236135424 [0;39m ==> Parameters: 
2021-08-27 16:34:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377790236135424 [0;39m <==    Updates: 0
2021-08-27 16:34:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377790236135424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:34:31.349 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :33   [32m86376095162699776 [0;39m 有新连接：token：AiKz5t6EmO，session id：3，当前连接数：1
2021-08-27 16:34:31.500 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86377796468871168 [0;39m ------------- 开始 -------------
2021-08-27 16:34:31.500 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86377796468871168 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 16:34:31.501 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86377796468871168 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 16:34:31.501 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86377796468871168 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:34:31.501 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86377796468871168 [0;39m 请求参数: []
2021-08-27 16:34:31.501 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86377796468871168 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:34:31.501 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86377796468871168 [0;39m ==> Parameters: 
2021-08-27 16:34:31.502 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86377796468871168 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 16:34:31.502 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86377796468871168 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 16:34:31.503 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86377796468871168 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 16:34:31.503 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86377796468871168 [0;39m <==      Total: 2
2021-08-27 16:34:31.503 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86377796468871168 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 16:34:31.504 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86377796468871168 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:34:31.514 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86377796527591424 [0;39m ------------- 开始 -------------
2021-08-27 16:34:31.514 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86377796527591424 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 16:34:31.514 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86377796527591425 [0;39m ------------- 开始 -------------
2021-08-27 16:34:31.514 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86377796527591424 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 16:34:31.514 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86377796527591425 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:34:31.514 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86377796527591424 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:34:31.515 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86377796527591425 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:34:31.515 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86377796527591425 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:34:31.515 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86377796527591424 [0;39m 请求参数: []
2021-08-27 16:34:31.515 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86377796527591425 [0;39m 请求参数: []
2021-08-27 16:34:31.515 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86377796527591424 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:34:31.515 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86377796527591424 [0;39m ==> Parameters: 
2021-08-27 16:34:31.515 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86377796527591425 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:34:31.516 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86377796527591425 [0;39m ==> Parameters: 
2021-08-27 16:34:31.516 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86377796527591424 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 16:34:31.516 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:34:31.517 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86377796527591424 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 16:34:31.517 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:34:31.517 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86377796527591424 [0;39m <==      Total: 1
2021-08-27 16:34:31.517 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:34:31.517 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:34:31.517 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86377796527591424 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 16:34:31.517 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86377796527591424 [0;39m ------------- 结束 耗时：3 ms -------------
2021-08-27 16:34:31.517 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:34:31.517 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:34:31.517 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:34:31.518 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:34:31.518 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:34:31.518 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:34:31.518 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:34:31.518 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:34:31.518 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:34:31.519 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:34:31.519 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:34:31.519 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:34:31.519 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86377796527591425 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:34:31.519 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86377796527591425 [0;39m <==      Total: 16
2021-08-27 16:34:31.520 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86377796527591425 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:34:31.520 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86377796527591425 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:34:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86377811211849728 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:34:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377811211849728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:34:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377811211849728 [0;39m ==> Parameters: 
2021-08-27 16:34:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377811211849728 [0;39m <==    Updates: 5
2021-08-27 16:34:35.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86377811211849728 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:34:35.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377811216044032 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377811216044032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377811216044032 [0;39m ==> Parameters: 
2021-08-27 16:34:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377811216044032 [0;39m <==    Updates: 0
2021-08-27 16:34:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377811216044032 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:34:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377832170786816 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377832170786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377832170786816 [0;39m ==> Parameters: 
2021-08-27 16:34:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377832170786816 [0;39m <==    Updates: 0
2021-08-27 16:34:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377832170786816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:34:45.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377853096169472 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:45.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377853096169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:45.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377853096169472 [0;39m ==> Parameters: 
2021-08-27 16:34:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377853096169472 [0;39m <==    Updates: 0
2021-08-27 16:34:45.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377853096169472 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:34:50.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377874101243904 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377874101243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377874101243904 [0;39m ==> Parameters: 
2021-08-27 16:34:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377874101243904 [0;39m <==    Updates: 0
2021-08-27 16:34:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377874101243904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:34:55.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377895035015168 [0;39m 生成今日电子书快照开始
2021-08-27 16:34:55.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377895035015168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:34:55.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377895035015168 [0;39m ==> Parameters: 
2021-08-27 16:34:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377895035015168 [0;39m <==    Updates: 0
2021-08-27 16:34:55.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377895035015168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:35:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377916061061120 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377916061061120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377916061061120 [0;39m ==> Parameters: 
2021-08-27 16:35:00.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377916061061120 [0;39m <==    Updates: 0
2021-08-27 16:35:00.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377916061061120 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:35:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377937011609600 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377937011609600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377937011609600 [0;39m ==> Parameters: 
2021-08-27 16:35:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377937011609600 [0;39m <==    Updates: 0
2021-08-27 16:35:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377937011609600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:35:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86377937024192512 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:35:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377937024192512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:35:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377937024192512 [0;39m ==> Parameters: 
2021-08-27 16:35:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86377937024192512 [0;39m <==    Updates: 5
2021-08-27 16:35:05.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86377937024192512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:35:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377957957963776 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377957957963776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377957957963776 [0;39m ==> Parameters: 
2021-08-27 16:35:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377957957963776 [0;39m <==    Updates: 0
2021-08-27 16:35:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377957957963776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:35:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377978979815424 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377978979815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377978979815424 [0;39m ==> Parameters: 
2021-08-27 16:35:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377978979815424 [0;39m <==    Updates: 0
2021-08-27 16:35:15.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377978979815424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:35:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86377999955529728 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377999955529728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377999955529728 [0;39m ==> Parameters: 
2021-08-27 16:35:20.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86377999955529728 [0;39m <==    Updates: 0
2021-08-27 16:35:20.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86377999955529728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:35:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378020876718080 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378020876718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378020876718080 [0;39m ==> Parameters: 
2021-08-27 16:35:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378020876718080 [0;39m <==    Updates: 0
2021-08-27 16:35:25.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378020876718080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:35:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378041852432384 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378041852432384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378041852432384 [0;39m ==> Parameters: 
2021-08-27 16:35:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378041852432384 [0;39m <==    Updates: 0
2021-08-27 16:35:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378041852432384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:35:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86378062840729600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:35:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378062840729600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:35:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378062840729600 [0;39m ==> Parameters: 
2021-08-27 16:35:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378062840729600 [0;39m <==    Updates: 5
2021-08-27 16:35:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86378062840729600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:35:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378062849118208 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378062849118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378062849118208 [0;39m ==> Parameters: 
2021-08-27 16:35:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378062849118208 [0;39m <==    Updates: 0
2021-08-27 16:35:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378062849118208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:35:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378083829026816 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378083829026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378083829026816 [0;39m ==> Parameters: 
2021-08-27 16:35:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378083829026816 [0;39m <==    Updates: 0
2021-08-27 16:35:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378083829026816 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:35:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378104804741120 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378104804741120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378104804741120 [0;39m ==> Parameters: 
2021-08-27 16:35:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378104804741120 [0;39m <==    Updates: 0
2021-08-27 16:35:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378104804741120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:35:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378125742706688 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378125742706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378125742706688 [0;39m ==> Parameters: 
2021-08-27 16:35:50.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378125742706688 [0;39m <==    Updates: 0
2021-08-27 16:35:50.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378125742706688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:35:55.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378146697449472 [0;39m 生成今日电子书快照开始
2021-08-27 16:35:55.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378146697449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:35:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378146697449472 [0;39m ==> Parameters: 
2021-08-27 16:35:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378146697449472 [0;39m <==    Updates: 0
2021-08-27 16:35:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378146697449472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:36:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378167710912512 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378167710912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378167710912512 [0;39m ==> Parameters: 
2021-08-27 16:36:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378167710912512 [0;39m <==    Updates: 0
2021-08-27 16:36:00.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378167710912512 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:36:05.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86378188665655296 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:36:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378188665655296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:36:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378188665655296 [0;39m ==> Parameters: 
2021-08-27 16:36:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378188665655296 [0;39m <==    Updates: 5
2021-08-27 16:36:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86378188665655296 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:36:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378188674043904 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378188674043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378188674043904 [0;39m ==> Parameters: 
2021-08-27 16:36:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378188674043904 [0;39m <==    Updates: 0
2021-08-27 16:36:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378188674043904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:36:10.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378209645563904 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378209645563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378209645563904 [0;39m ==> Parameters: 
2021-08-27 16:36:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378209645563904 [0;39m <==    Updates: 0
2021-08-27 16:36:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378209645563904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:36:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378230591918080 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378230591918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378230591918080 [0;39m ==> Parameters: 
2021-08-27 16:36:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378230591918080 [0;39m <==    Updates: 0
2021-08-27 16:36:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378230591918080 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:36:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378251605381120 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378251605381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378251605381120 [0;39m ==> Parameters: 
2021-08-27 16:36:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378251605381120 [0;39m <==    Updates: 0
2021-08-27 16:36:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378251605381120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:36:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378272555929600 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378272555929600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378272555929600 [0;39m ==> Parameters: 
2021-08-27 16:36:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378272555929600 [0;39m <==    Updates: 0
2021-08-27 16:36:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378272555929600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:36:29.726 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86378292344655872 [0;39m ------------- 开始 -------------
2021-08-27 16:36:29.727 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86378292344655872 [0;39m 请求地址: http://127.0.0.1:8880/user/login POST
2021-08-27 16:36:29.727 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86378292344655872 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.login
2021-08-27 16:36:29.727 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86378292344655872 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:36:29.727 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86378292344655872 [0;39m 请求参数: [{"loginName":"test"}]
2021-08-27 16:36:29.728 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86378292344655872 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-08-27 16:36:29.729 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86378292344655872 [0;39m ==> Parameters: test(String)
2021-08-27 16:36:29.730 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86378292344655872 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 16:36:29.730 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86378292344655872 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 16:36:29.730 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86378292344655872 [0;39m <==      Total: 1
2021-08-27 16:36:29.731 INFO  com.haoyu.knowlagebase.controller.UserController  :81   [32m86378292344655872 [0;39m 生成单点登录token：86378292365627392，并放入redis中
2021-08-27 16:36:29.733 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86378292344655872 [0;39m 返回结果: {"content":{"id":1,"loginName":"test","name":"测试","token":"86378292365627392"},"success":true}
2021-08-27 16:36:29.733 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86378292344655872 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:36:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378293552615424 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378293552615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378293552615424 [0;39m ==> Parameters: 
2021-08-27 16:36:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378293552615424 [0;39m <==    Updates: 0
2021-08-27 16:36:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378293552615424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:36:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86378314524135424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:36:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378314524135424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:36:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378314524135424 [0;39m ==> Parameters: 
2021-08-27 16:36:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378314524135424 [0;39m <==    Updates: 5
2021-08-27 16:36:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86378314524135424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:36:35.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378314528329728 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378314528329728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378314528329728 [0;39m ==> Parameters: 
2021-08-27 16:36:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378314528329728 [0;39m <==    Updates: 0
2021-08-27 16:36:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378314528329728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:36:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378335457906688 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378335457906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378335457906688 [0;39m ==> Parameters: 
2021-08-27 16:36:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378335457906688 [0;39m <==    Updates: 0
2021-08-27 16:36:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378335457906688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:36:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378356425232384 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378356425232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378356425232384 [0;39m ==> Parameters: 
2021-08-27 16:36:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378356425232384 [0;39m <==    Updates: 0
2021-08-27 16:36:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378356425232384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:36:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378377396752384 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378377396752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378377396752384 [0;39m ==> Parameters: 
2021-08-27 16:36:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378377396752384 [0;39m <==    Updates: 0
2021-08-27 16:36:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378377396752384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:36:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378398368272384 [0;39m 生成今日电子书快照开始
2021-08-27 16:36:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378398368272384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:36:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378398368272384 [0;39m ==> Parameters: 
2021-08-27 16:36:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378398368272384 [0;39m <==    Updates: 0
2021-08-27 16:36:55.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378398368272384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378419360763904 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378419360763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378419360763904 [0;39m ==> Parameters: 
2021-08-27 16:37:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378419360763904 [0;39m <==    Updates: 0
2021-08-27 16:37:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378419360763904 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:37:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378440319700992 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378440319700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378440319700992 [0;39m ==> Parameters: 
2021-08-27 16:37:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378440319700992 [0;39m <==    Updates: 0
2021-08-27 16:37:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378440319700992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86378440328089600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:37:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378440328089600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:37:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378440328089600 [0;39m ==> Parameters: 
2021-08-27 16:37:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378440328089600 [0;39m <==    Updates: 5
2021-08-27 16:37:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86378440328089600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:37:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378461274443776 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378461274443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378461274443776 [0;39m ==> Parameters: 
2021-08-27 16:37:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378461274443776 [0;39m <==    Updates: 0
2021-08-27 16:37:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378461274443776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:15.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378482292101120 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378482292101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378482292101120 [0;39m ==> Parameters: 
2021-08-27 16:37:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378482292101120 [0;39m <==    Updates: 0
2021-08-27 16:37:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378482292101120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378503259426816 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378503259426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378503259426816 [0;39m ==> Parameters: 
2021-08-27 16:37:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378503259426816 [0;39m <==    Updates: 0
2021-08-27 16:37:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378503259426816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378524226752512 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378524226752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378524226752512 [0;39m ==> Parameters: 
2021-08-27 16:37:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378524226752512 [0;39m <==    Updates: 0
2021-08-27 16:37:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378524226752512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:37:30.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378545152135168 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:30.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378545152135168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378545152135168 [0;39m ==> Parameters: 
2021-08-27 16:37:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378545152135168 [0;39m <==    Updates: 0
2021-08-27 16:37:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378545152135168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378566165598208 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378566165598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378566165598208 [0;39m ==> Parameters: 
2021-08-27 16:37:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378566165598208 [0;39m <==    Updates: 0
2021-08-27 16:37:35.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378566165598208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86378566173986816 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:37:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378566173986816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:37:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378566173986816 [0;39m ==> Parameters: 
2021-08-27 16:37:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378566173986816 [0;39m <==    Updates: 5
2021-08-27 16:37:35.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86378566173986816 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:37:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378587111952384 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378587111952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378587111952384 [0;39m ==> Parameters: 
2021-08-27 16:37:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378587111952384 [0;39m <==    Updates: 0
2021-08-27 16:37:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378587111952384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378608112832512 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378608112832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378608112832512 [0;39m ==> Parameters: 
2021-08-27 16:37:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378608112832512 [0;39m <==    Updates: 0
2021-08-27 16:37:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378608112832512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:50.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378629038215168 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:50.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378629038215168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:50.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378629038215168 [0;39m ==> Parameters: 
2021-08-27 16:37:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378629038215168 [0;39m <==    Updates: 0
2021-08-27 16:37:50.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378629038215168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:37:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378650072649728 [0;39m 生成今日电子书快照开始
2021-08-27 16:37:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378650072649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:37:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378650072649728 [0;39m ==> Parameters: 
2021-08-27 16:37:55.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378650072649728 [0;39m <==    Updates: 0
2021-08-27 16:37:55.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378650072649728 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:38:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378671023198208 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378671023198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378671023198208 [0;39m ==> Parameters: 
2021-08-27 16:38:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378671023198208 [0;39m <==    Updates: 0
2021-08-27 16:38:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378671023198208 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:38:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378692011495424 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378692011495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378692011495424 [0;39m ==> Parameters: 
2021-08-27 16:38:05.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378692011495424 [0;39m <==    Updates: 0
2021-08-27 16:38:05.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378692011495424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:38:05.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86378692019884032 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:38:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378692019884032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:38:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378692019884032 [0;39m ==> Parameters: 
2021-08-27 16:38:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378692019884032 [0;39m <==    Updates: 5
2021-08-27 16:38:05.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86378692019884032 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:38:10.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378712962043904 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378712962043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378712962043904 [0;39m ==> Parameters: 
2021-08-27 16:38:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378712962043904 [0;39m <==    Updates: 0
2021-08-27 16:38:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378712962043904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:38:15.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378733920980992 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378733920980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378733920980992 [0;39m ==> Parameters: 
2021-08-27 16:38:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378733920980992 [0;39m <==    Updates: 0
2021-08-27 16:38:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378733920980992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:38:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378754896695296 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378754896695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378754896695296 [0;39m ==> Parameters: 
2021-08-27 16:38:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378754896695296 [0;39m <==    Updates: 0
2021-08-27 16:38:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378754896695296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:38:25.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378775838855168 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:25.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378775838855168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:25.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378775838855168 [0;39m ==> Parameters: 
2021-08-27 16:38:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378775838855168 [0;39m <==    Updates: 0
2021-08-27 16:38:25.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378775838855168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:38:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378796818763776 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378796818763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378796818763776 [0;39m ==> Parameters: 
2021-08-27 16:38:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378796818763776 [0;39m <==    Updates: 0
2021-08-27 16:38:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378796818763776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:38:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86378817819643904 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:38:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378817819643904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:38:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378817819643904 [0;39m ==> Parameters: 
2021-08-27 16:38:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378817819643904 [0;39m <==    Updates: 5
2021-08-27 16:38:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86378817819643904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:38:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378817823838208 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378817823838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378817823838208 [0;39m ==> Parameters: 
2021-08-27 16:38:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378817823838208 [0;39m <==    Updates: 0
2021-08-27 16:38:35.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378817823838208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:38:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378838765998080 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378838765998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378838765998080 [0;39m ==> Parameters: 
2021-08-27 16:38:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378838765998080 [0;39m <==    Updates: 0
2021-08-27 16:38:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378838765998080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:38:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378859758489600 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378859758489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378859758489600 [0;39m ==> Parameters: 
2021-08-27 16:38:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378859758489600 [0;39m <==    Updates: 0
2021-08-27 16:38:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378859758489600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:38:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378880713232384 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378880713232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378880713232384 [0;39m ==> Parameters: 
2021-08-27 16:38:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378880713232384 [0;39m <==    Updates: 0
2021-08-27 16:38:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378880713232384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:38:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378901688946688 [0;39m 生成今日电子书快照开始
2021-08-27 16:38:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378901688946688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:38:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378901688946688 [0;39m ==> Parameters: 
2021-08-27 16:38:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378901688946688 [0;39m <==    Updates: 0
2021-08-27 16:38:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378901688946688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:39:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378922668855296 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378922668855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378922668855296 [0;39m ==> Parameters: 
2021-08-27 16:39:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378922668855296 [0;39m <==    Updates: 0
2021-08-27 16:39:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378922668855296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:39:05.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378943615209472 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:05.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378943615209472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378943615209472 [0;39m ==> Parameters: 
2021-08-27 16:39:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378943615209472 [0;39m <==    Updates: 0
2021-08-27 16:39:05.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378943615209472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:39:05.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86378943623598080 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:39:05.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378943623598080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:39:05.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378943623598080 [0;39m ==> Parameters: 
2021-08-27 16:39:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86378943623598080 [0;39m <==    Updates: 5
2021-08-27 16:39:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86378943623598080 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:39:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378964632866816 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378964632866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378964632866816 [0;39m ==> Parameters: 
2021-08-27 16:39:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378964632866816 [0;39m <==    Updates: 0
2021-08-27 16:39:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378964632866816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:39:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86378985600192512 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378985600192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378985600192512 [0;39m ==> Parameters: 
2021-08-27 16:39:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86378985600192512 [0;39m <==    Updates: 0
2021-08-27 16:39:15.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86378985600192512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:39:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379006580101120 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379006580101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379006580101120 [0;39m ==> Parameters: 
2021-08-27 16:39:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379006580101120 [0;39m <==    Updates: 0
2021-08-27 16:39:20.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379006580101120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:39:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379027530649600 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379027530649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379027530649600 [0;39m ==> Parameters: 
2021-08-27 16:39:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379027530649600 [0;39m <==    Updates: 0
2021-08-27 16:39:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379027530649600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:39:30.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379048502169600 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379048502169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379048502169600 [0;39m ==> Parameters: 
2021-08-27 16:39:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379048502169600 [0;39m <==    Updates: 0
2021-08-27 16:39:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379048502169600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:39:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86379069486272512 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:39:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379069486272512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:39:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379069486272512 [0;39m ==> Parameters: 
2021-08-27 16:39:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379069486272512 [0;39m <==    Updates: 5
2021-08-27 16:39:35.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86379069486272512 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:39:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379069494661120 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379069494661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379069494661120 [0;39m ==> Parameters: 
2021-08-27 16:39:35.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379069494661120 [0;39m <==    Updates: 0
2021-08-27 16:39:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379069494661120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:39:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379090461986816 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379090461986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379090461986816 [0;39m ==> Parameters: 
2021-08-27 16:39:40.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379090461986816 [0;39m <==    Updates: 0
2021-08-27 16:39:40.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379090461986816 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 16:39:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379111425118208 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379111425118208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379111425118208 [0;39m ==> Parameters: 
2021-08-27 16:39:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379111425118208 [0;39m <==    Updates: 0
2021-08-27 16:39:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379111425118208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:39:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379132417609728 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379132417609728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379132417609728 [0;39m ==> Parameters: 
2021-08-27 16:39:50.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379132417609728 [0;39m <==    Updates: 0
2021-08-27 16:39:50.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379132417609728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:39:55.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379153326215168 [0;39m 生成今日电子书快照开始
2021-08-27 16:39:55.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379153326215168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:39:55.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379153326215168 [0;39m ==> Parameters: 
2021-08-27 16:39:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379153326215168 [0;39m <==    Updates: 0
2021-08-27 16:39:55.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379153326215168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379174348066816 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379174348066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379174348066816 [0;39m ==> Parameters: 
2021-08-27 16:40:00.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379174348066816 [0;39m <==    Updates: 0
2021-08-27 16:40:00.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379174348066816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:05.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379195281838080 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379195281838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379195281838080 [0;39m ==> Parameters: 
2021-08-27 16:40:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379195281838080 [0;39m <==    Updates: 0
2021-08-27 16:40:05.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379195281838080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86379195290226688 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:40:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379195290226688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:40:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379195290226688 [0;39m ==> Parameters: 
2021-08-27 16:40:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379195290226688 [0;39m <==    Updates: 5
2021-08-27 16:40:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86379195290226688 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 16:40:10.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379216261746688 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379216261746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379216261746688 [0;39m ==> Parameters: 
2021-08-27 16:40:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379216261746688 [0;39m <==    Updates: 0
2021-08-27 16:40:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379216261746688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:15.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379237212295168 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:15.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379237212295168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:15.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379237212295168 [0;39m ==> Parameters: 
2021-08-27 16:40:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379237212295168 [0;39m <==    Updates: 0
2021-08-27 16:40:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379237212295168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379258200592384 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379258200592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379258200592384 [0;39m ==> Parameters: 
2021-08-27 16:40:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379258200592384 [0;39m <==    Updates: 0
2021-08-27 16:40:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379258200592384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379279193083904 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379279193083904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379279193083904 [0;39m ==> Parameters: 
2021-08-27 16:40:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379279193083904 [0;39m <==    Updates: 0
2021-08-27 16:40:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379279193083904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379300168798208 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379300168798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379300168798208 [0;39m ==> Parameters: 
2021-08-27 16:40:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379300168798208 [0;39m <==    Updates: 0
2021-08-27 16:40:30.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379300168798208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:35.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86379321115152384 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:40:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379321115152384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:40:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379321115152384 [0;39m ==> Parameters: 
2021-08-27 16:40:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379321115152384 [0;39m <==    Updates: 5
2021-08-27 16:40:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86379321115152384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:40:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379321119346688 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379321119346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379321119346688 [0;39m ==> Parameters: 
2021-08-27 16:40:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379321119346688 [0;39m <==    Updates: 0
2021-08-27 16:40:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379321119346688 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:40:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379342111838208 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379342111838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379342111838208 [0;39m ==> Parameters: 
2021-08-27 16:40:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379342111838208 [0;39m <==    Updates: 0
2021-08-27 16:40:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379342111838208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379363100135424 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379363100135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379363100135424 [0;39m ==> Parameters: 
2021-08-27 16:40:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379363100135424 [0;39m <==    Updates: 0
2021-08-27 16:40:45.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379363100135424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:40:50.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379384012935168 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:50.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379384012935168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:50.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379384012935168 [0;39m ==> Parameters: 
2021-08-27 16:40:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379384012935168 [0;39m <==    Updates: 0
2021-08-27 16:40:50.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379384012935168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:40:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379405038981120 [0;39m 生成今日电子书快照开始
2021-08-27 16:40:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379405038981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:40:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379405038981120 [0;39m ==> Parameters: 
2021-08-27 16:40:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379405038981120 [0;39m <==    Updates: 0
2021-08-27 16:40:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379405038981120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:41:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379425981140992 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379425981140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379425981140992 [0;39m ==> Parameters: 
2021-08-27 16:41:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379425981140992 [0;39m <==    Updates: 0
2021-08-27 16:41:00.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379425981140992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:41:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86379446982021120 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:41:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379446982021120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:41:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379446982021120 [0;39m ==> Parameters: 
2021-08-27 16:41:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379446982021120 [0;39m <==    Updates: 5
2021-08-27 16:41:05.018 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86379446982021120 [0;39m 更新电子书下的文档数据结束，耗时：5毫秒
2021-08-27 16:41:05.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379447002992640 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:05.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379447002992640 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:05.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379447002992640 [0;39m ==> Parameters: 
2021-08-27 16:41:05.023 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379447002992640 [0;39m <==    Updates: 0
2021-08-27 16:41:05.023 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379447002992640 [0;39m 生成今日电子书快照结束，耗时：5毫秒
2021-08-27 16:41:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379467911598080 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379467911598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379467911598080 [0;39m ==> Parameters: 
2021-08-27 16:41:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379467911598080 [0;39m <==    Updates: 0
2021-08-27 16:41:10.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379467911598080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:41:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379488899895296 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379488899895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379488899895296 [0;39m ==> Parameters: 
2021-08-27 16:41:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379488899895296 [0;39m <==    Updates: 0
2021-08-27 16:41:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379488899895296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:41:20.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379509846249472 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:20.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379509846249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:20.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379509846249472 [0;39m ==> Parameters: 
2021-08-27 16:41:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379509846249472 [0;39m <==    Updates: 0
2021-08-27 16:41:20.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379509846249472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:41:25.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379530821963776 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379530821963776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379530821963776 [0;39m ==> Parameters: 
2021-08-27 16:41:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379530821963776 [0;39m <==    Updates: 0
2021-08-27 16:41:25.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379530821963776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:41:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379551801872384 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379551801872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379551801872384 [0;39m ==> Parameters: 
2021-08-27 16:41:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379551801872384 [0;39m <==    Updates: 0
2021-08-27 16:41:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379551801872384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:41:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86379572790169600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:41:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379572790169600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:41:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379572790169600 [0;39m ==> Parameters: 
2021-08-27 16:41:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379572790169600 [0;39m <==    Updates: 5
2021-08-27 16:41:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86379572790169600 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:41:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379572798558208 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379572798558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379572798558208 [0;39m ==> Parameters: 
2021-08-27 16:41:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379572798558208 [0;39m <==    Updates: 0
2021-08-27 16:41:35.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379572798558208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:41:40.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379593728135168 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:40.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379593728135168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:40.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379593728135168 [0;39m ==> Parameters: 
2021-08-27 16:41:40.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379593728135168 [0;39m <==    Updates: 0
2021-08-27 16:41:40.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379593728135168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:41:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379614745792512 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379614745792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379614745792512 [0;39m ==> Parameters: 
2021-08-27 16:41:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379614745792512 [0;39m <==    Updates: 0
2021-08-27 16:41:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379614745792512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:41:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379635729895424 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379635729895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379635729895424 [0;39m ==> Parameters: 
2021-08-27 16:41:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379635729895424 [0;39m <==    Updates: 0
2021-08-27 16:41:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379635729895424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:41:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379656672055296 [0;39m 生成今日电子书快照开始
2021-08-27 16:41:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379656672055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:41:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379656672055296 [0;39m ==> Parameters: 
2021-08-27 16:41:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379656672055296 [0;39m <==    Updates: 0
2021-08-27 16:41:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379656672055296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:42:00.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379677622603776 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:00.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379677622603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379677622603776 [0;39m ==> Parameters: 
2021-08-27 16:42:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379677622603776 [0;39m <==    Updates: 0
2021-08-27 16:42:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379677622603776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:42:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86379698627678208 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:42:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379698627678208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:42:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379698627678208 [0;39m ==> Parameters: 
2021-08-27 16:42:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379698627678208 [0;39m <==    Updates: 5
2021-08-27 16:42:05.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86379698627678208 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:42:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379698636066816 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379698636066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379698636066816 [0;39m ==> Parameters: 
2021-08-27 16:42:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379698636066816 [0;39m <==    Updates: 0
2021-08-27 16:42:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379698636066816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:42:10.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379719595003904 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379719595003904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379719595003904 [0;39m ==> Parameters: 
2021-08-27 16:42:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379719595003904 [0;39m <==    Updates: 0
2021-08-27 16:42:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379719595003904 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:42:15.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379740562329600 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379740562329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379740562329600 [0;39m ==> Parameters: 
2021-08-27 16:42:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379740562329600 [0;39m <==    Updates: 0
2021-08-27 16:42:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379740562329600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:42:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379761542238208 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379761542238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379761542238208 [0;39m ==> Parameters: 
2021-08-27 16:42:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379761542238208 [0;39m <==    Updates: 0
2021-08-27 16:42:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379761542238208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:42:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379782530535424 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379782530535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379782530535424 [0;39m ==> Parameters: 
2021-08-27 16:42:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379782530535424 [0;39m <==    Updates: 0
2021-08-27 16:42:25.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379782530535424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:42:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379803468500992 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379803468500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379803468500992 [0;39m ==> Parameters: 
2021-08-27 16:42:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379803468500992 [0;39m <==    Updates: 0
2021-08-27 16:42:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379803468500992 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:42:35.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86379824431632384 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:42:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379824431632384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:42:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379824431632384 [0;39m ==> Parameters: 
2021-08-27 16:42:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379824431632384 [0;39m <==    Updates: 5
2021-08-27 16:42:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86379824431632384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:42:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379824435826688 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379824435826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379824435826688 [0;39m ==> Parameters: 
2021-08-27 16:42:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379824435826688 [0;39m <==    Updates: 0
2021-08-27 16:42:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379824435826688 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:42:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379845445095424 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379845445095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379845445095424 [0;39m ==> Parameters: 
2021-08-27 16:42:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379845445095424 [0;39m <==    Updates: 0
2021-08-27 16:42:40.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379845445095424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:42:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379866416615424 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379866416615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379866416615424 [0;39m ==> Parameters: 
2021-08-27 16:42:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379866416615424 [0;39m <==    Updates: 0
2021-08-27 16:42:45.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379866416615424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:42:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379887388135424 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379887388135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379887388135424 [0;39m ==> Parameters: 
2021-08-27 16:42:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379887388135424 [0;39m <==    Updates: 0
2021-08-27 16:42:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379887388135424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:42:55.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379908326100992 [0;39m 生成今日电子书快照开始
2021-08-27 16:42:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379908326100992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:42:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379908326100992 [0;39m ==> Parameters: 
2021-08-27 16:42:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379908326100992 [0;39m <==    Updates: 0
2021-08-27 16:42:55.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379908326100992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:43:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379929310203904 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379929310203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379929310203904 [0;39m ==> Parameters: 
2021-08-27 16:43:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379929310203904 [0;39m <==    Updates: 0
2021-08-27 16:43:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379929310203904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:43:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86379950290112512 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:43:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379950290112512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:43:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379950290112512 [0;39m ==> Parameters: 
2021-08-27 16:43:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86379950290112512 [0;39m <==    Updates: 5
2021-08-27 16:43:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86379950290112512 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:43:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379950298501120 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379950298501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379950298501120 [0;39m ==> Parameters: 
2021-08-27 16:43:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379950298501120 [0;39m <==    Updates: 0
2021-08-27 16:43:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379950298501120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:43:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379971278409728 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379971278409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:10.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379971278409728 [0;39m ==> Parameters: 
2021-08-27 16:43:10.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379971278409728 [0;39m <==    Updates: 0
2021-08-27 16:43:10.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379971278409728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:43:15.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86379992254124032 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379992254124032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:15.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379992254124032 [0;39m ==> Parameters: 
2021-08-27 16:43:15.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86379992254124032 [0;39m <==    Updates: 0
2021-08-27 16:43:15.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86379992254124032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:43:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380013187895296 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380013187895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380013187895296 [0;39m ==> Parameters: 
2021-08-27 16:43:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380013187895296 [0;39m <==    Updates: 0
2021-08-27 16:43:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380013187895296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:43:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380034180386816 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380034180386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380034180386816 [0;39m ==> Parameters: 
2021-08-27 16:43:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380034180386816 [0;39m <==    Updates: 0
2021-08-27 16:43:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380034180386816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:43:30.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380055151906816 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380055151906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380055151906816 [0;39m ==> Parameters: 
2021-08-27 16:43:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380055151906816 [0;39m <==    Updates: 0
2021-08-27 16:43:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380055151906816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:43:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86380076131815424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:43:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380076131815424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:43:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380076131815424 [0;39m ==> Parameters: 
2021-08-27 16:43:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380076131815424 [0;39m <==    Updates: 5
2021-08-27 16:43:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86380076131815424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:43:35.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380076136009728 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380076136009728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380076136009728 [0;39m ==> Parameters: 
2021-08-27 16:43:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380076136009728 [0;39m <==    Updates: 0
2021-08-27 16:43:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380076136009728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:43:40.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380097090752512 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380097090752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380097090752512 [0;39m ==> Parameters: 
2021-08-27 16:43:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380097090752512 [0;39m <==    Updates: 0
2021-08-27 16:43:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380097090752512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:43:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380118037106688 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380118037106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380118037106688 [0;39m ==> Parameters: 
2021-08-27 16:43:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380118037106688 [0;39m <==    Updates: 0
2021-08-27 16:43:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380118037106688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:43:50.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380139025403904 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380139025403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380139025403904 [0;39m ==> Parameters: 
2021-08-27 16:43:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380139025403904 [0;39m <==    Updates: 0
2021-08-27 16:43:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380139025403904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:43:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380160005312512 [0;39m 生成今日电子书快照开始
2021-08-27 16:43:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380160005312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:43:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380160005312512 [0;39m ==> Parameters: 
2021-08-27 16:43:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380160005312512 [0;39m <==    Updates: 0
2021-08-27 16:43:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380160005312512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:44:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380180951666688 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380180951666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380180951666688 [0;39m ==> Parameters: 
2021-08-27 16:44:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380180951666688 [0;39m <==    Updates: 0
2021-08-27 16:44:00.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380180951666688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:44:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380201952546816 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380201952546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380201952546816 [0;39m ==> Parameters: 
2021-08-27 16:44:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380201952546816 [0;39m <==    Updates: 0
2021-08-27 16:44:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380201952546816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:44:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86380201960935424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:44:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380201960935424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:44:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380201960935424 [0;39m ==> Parameters: 
2021-08-27 16:44:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380201960935424 [0;39m <==    Updates: 5
2021-08-27 16:44:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86380201960935424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:44:10.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380222894706688 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380222894706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380222894706688 [0;39m ==> Parameters: 
2021-08-27 16:44:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380222894706688 [0;39m <==    Updates: 0
2021-08-27 16:44:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380222894706688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:44:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380243891392512 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380243891392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380243891392512 [0;39m ==> Parameters: 
2021-08-27 16:44:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380243891392512 [0;39m <==    Updates: 0
2021-08-27 16:44:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380243891392512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:44:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380264875495424 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380264875495424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380264875495424 [0;39m ==> Parameters: 
2021-08-27 16:44:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380264875495424 [0;39m <==    Updates: 0
2021-08-27 16:44:20.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380264875495424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:44:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380285800878080 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380285800878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380285800878080 [0;39m ==> Parameters: 
2021-08-27 16:44:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380285800878080 [0;39m <==    Updates: 0
2021-08-27 16:44:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380285800878080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:44:30.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380306764009472 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380306764009472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380306764009472 [0;39m ==> Parameters: 
2021-08-27 16:44:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380306764009472 [0;39m <==    Updates: 0
2021-08-27 16:44:30.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380306764009472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:44:35.002 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86380327739723776 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:44:35.002 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380327739723776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:44:35.002 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380327739723776 [0;39m ==> Parameters: 
2021-08-27 16:44:35.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380327739723776 [0;39m <==    Updates: 5
2021-08-27 16:44:35.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86380327739723776 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:44:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380327743918080 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380327743918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380327743918080 [0;39m ==> Parameters: 
2021-08-27 16:44:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380327743918080 [0;39m <==    Updates: 0
2021-08-27 16:44:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380327743918080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:44:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380348753186816 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380348753186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380348753186816 [0;39m ==> Parameters: 
2021-08-27 16:44:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380348753186816 [0;39m <==    Updates: 0
2021-08-27 16:44:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380348753186816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:44:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380369716318208 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380369716318208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380369716318208 [0;39m ==> Parameters: 
2021-08-27 16:44:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380369716318208 [0;39m <==    Updates: 0
2021-08-27 16:44:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380369716318208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:44:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380390666866688 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380390666866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380390666866688 [0;39m ==> Parameters: 
2021-08-27 16:44:50.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380390666866688 [0;39m <==    Updates: 0
2021-08-27 16:44:50.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380390666866688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:44:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380411659358208 [0;39m 生成今日电子书快照开始
2021-08-27 16:44:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380411659358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:44:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380411659358208 [0;39m ==> Parameters: 
2021-08-27 16:44:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380411659358208 [0;39m <==    Updates: 0
2021-08-27 16:44:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380411659358208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:45:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380432626683904 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380432626683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380432626683904 [0;39m ==> Parameters: 
2021-08-27 16:45:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380432626683904 [0;39m <==    Updates: 0
2021-08-27 16:45:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380432626683904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:45:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380453606592512 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380453606592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380453606592512 [0;39m ==> Parameters: 
2021-08-27 16:45:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380453606592512 [0;39m <==    Updates: 0
2021-08-27 16:45:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380453606592512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:45:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86380453614981120 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:45:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380453614981120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:45:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380453614981120 [0;39m ==> Parameters: 
2021-08-27 16:45:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380453614981120 [0;39m <==    Updates: 5
2021-08-27 16:45:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86380453614981120 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:45:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380474536169472 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380474536169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380474536169472 [0;39m ==> Parameters: 
2021-08-27 16:45:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380474536169472 [0;39m <==    Updates: 0
2021-08-27 16:45:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380474536169472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:45:15.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380495524466688 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380495524466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380495524466688 [0;39m ==> Parameters: 
2021-08-27 16:45:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380495524466688 [0;39m <==    Updates: 0
2021-08-27 16:45:15.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380495524466688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:45:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380516533735424 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380516533735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380516533735424 [0;39m ==> Parameters: 
2021-08-27 16:45:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380516533735424 [0;39m <==    Updates: 0
2021-08-27 16:45:20.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380516533735424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:45:25.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380537450729472 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:25.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380537450729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:25.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380537450729472 [0;39m ==> Parameters: 
2021-08-27 16:45:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380537450729472 [0;39m <==    Updates: 0
2021-08-27 16:45:25.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380537450729472 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:45:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380558439026688 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380558439026688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380558439026688 [0;39m ==> Parameters: 
2021-08-27 16:45:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380558439026688 [0;39m <==    Updates: 0
2021-08-27 16:45:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380558439026688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:45:35.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380579397963776 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:35.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380579397963776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380579397963776 [0;39m ==> Parameters: 
2021-08-27 16:45:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380579397963776 [0;39m <==    Updates: 0
2021-08-27 16:45:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380579397963776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:45:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86380579410546688 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:45:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380579410546688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:45:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380579410546688 [0;39m ==> Parameters: 
2021-08-27 16:45:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380579410546688 [0;39m <==    Updates: 5
2021-08-27 16:45:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86380579410546688 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 16:45:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380600386260992 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380600386260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380600386260992 [0;39m ==> Parameters: 
2021-08-27 16:45:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380600386260992 [0;39m <==    Updates: 0
2021-08-27 16:45:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380600386260992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:45:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380621374558208 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380621374558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380621374558208 [0;39m ==> Parameters: 
2021-08-27 16:45:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380621374558208 [0;39m <==    Updates: 0
2021-08-27 16:45:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380621374558208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:45:50.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380642312523776 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380642312523776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380642312523776 [0;39m ==> Parameters: 
2021-08-27 16:45:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380642312523776 [0;39m <==    Updates: 0
2021-08-27 16:45:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380642312523776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:45:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380663330181120 [0;39m 生成今日电子书快照开始
2021-08-27 16:45:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380663330181120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:45:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380663330181120 [0;39m ==> Parameters: 
2021-08-27 16:45:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380663330181120 [0;39m <==    Updates: 0
2021-08-27 16:45:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380663330181120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:46:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380684293312512 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380684293312512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380684293312512 [0;39m ==> Parameters: 
2021-08-27 16:46:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380684293312512 [0;39m <==    Updates: 0
2021-08-27 16:46:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380684293312512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:46:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86380705260638208 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:46:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380705260638208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:46:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380705260638208 [0;39m ==> Parameters: 
2021-08-27 16:46:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380705260638208 [0;39m <==    Updates: 5
2021-08-27 16:46:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86380705260638208 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:46:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380705264832512 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380705264832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380705264832512 [0;39m ==> Parameters: 
2021-08-27 16:46:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380705264832512 [0;39m <==    Updates: 0
2021-08-27 16:46:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380705264832512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:46:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380726236352512 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380726236352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380726236352512 [0;39m ==> Parameters: 
2021-08-27 16:46:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380726236352512 [0;39m <==    Updates: 0
2021-08-27 16:46:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380726236352512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:46:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380747207872512 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380747207872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380747207872512 [0;39m ==> Parameters: 
2021-08-27 16:46:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380747207872512 [0;39m <==    Updates: 0
2021-08-27 16:46:15.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380747207872512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:46:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380768183586816 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380768183586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380768183586816 [0;39m ==> Parameters: 
2021-08-27 16:46:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380768183586816 [0;39m <==    Updates: 0
2021-08-27 16:46:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380768183586816 [0;39m 生成今日电子书快照结束，耗时：0毫秒
2021-08-27 16:46:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380789146718208 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380789146718208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380789146718208 [0;39m ==> Parameters: 
2021-08-27 16:46:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380789146718208 [0;39m <==    Updates: 0
2021-08-27 16:46:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380789146718208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:46:30.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380810080489472 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380810080489472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380810080489472 [0;39m ==> Parameters: 
2021-08-27 16:46:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380810080489472 [0;39m <==    Updates: 0
2021-08-27 16:46:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380810080489472 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:46:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380831072980992 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380831072980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380831072980992 [0;39m ==> Parameters: 
2021-08-27 16:46:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380831072980992 [0;39m <==    Updates: 0
2021-08-27 16:46:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380831072980992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:46:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86380831085563904 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:46:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380831085563904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:46:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380831085563904 [0;39m ==> Parameters: 
2021-08-27 16:46:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380831085563904 [0;39m <==    Updates: 5
2021-08-27 16:46:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86380831085563904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:46:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380852048695296 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380852048695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380852048695296 [0;39m ==> Parameters: 
2021-08-27 16:46:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380852048695296 [0;39m <==    Updates: 0
2021-08-27 16:46:40.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380852048695296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:46:45.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380873003438080 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380873003438080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380873003438080 [0;39m ==> Parameters: 
2021-08-27 16:46:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380873003438080 [0;39m <==    Updates: 0
2021-08-27 16:46:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380873003438080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:46:50.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380893991735296 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:50.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380893991735296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:50.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380893991735296 [0;39m ==> Parameters: 
2021-08-27 16:46:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380893991735296 [0;39m <==    Updates: 0
2021-08-27 16:46:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380893991735296 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:46:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380914992615424 [0;39m 生成今日电子书快照开始
2021-08-27 16:46:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380914992615424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:46:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380914992615424 [0;39m ==> Parameters: 
2021-08-27 16:46:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380914992615424 [0;39m <==    Updates: 0
2021-08-27 16:46:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380914992615424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:47:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380935959941120 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380935959941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380935959941120 [0;39m ==> Parameters: 
2021-08-27 16:47:00.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380935959941120 [0;39m <==    Updates: 0
2021-08-27 16:47:00.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380935959941120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:47:05.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86380956889518080 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:47:05.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380956889518080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:47:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380956889518080 [0;39m ==> Parameters: 
2021-08-27 16:47:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86380956889518080 [0;39m <==    Updates: 5
2021-08-27 16:47:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86380956889518080 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:47:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380956893712384 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380956893712384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380956893712384 [0;39m ==> Parameters: 
2021-08-27 16:47:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380956893712384 [0;39m <==    Updates: 0
2021-08-27 16:47:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380956893712384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:47:10.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380977882009600 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380977882009600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380977882009600 [0;39m ==> Parameters: 
2021-08-27 16:47:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380977882009600 [0;39m <==    Updates: 0
2021-08-27 16:47:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380977882009600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:47:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86380998857723904 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380998857723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380998857723904 [0;39m ==> Parameters: 
2021-08-27 16:47:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86380998857723904 [0;39m <==    Updates: 0
2021-08-27 16:47:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86380998857723904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:47:20.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381019799883776 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:20.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381019799883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381019799883776 [0;39m ==> Parameters: 
2021-08-27 16:47:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381019799883776 [0;39m <==    Updates: 0
2021-08-27 16:47:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381019799883776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:47:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381040783986688 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381040783986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381040783986688 [0;39m ==> Parameters: 
2021-08-27 16:47:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381040783986688 [0;39m <==    Updates: 0
2021-08-27 16:47:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381040783986688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:47:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381061742923776 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381061742923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381061742923776 [0;39m ==> Parameters: 
2021-08-27 16:47:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381061742923776 [0;39m <==    Updates: 0
2021-08-27 16:47:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381061742923776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:47:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381082731220992 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381082731220992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381082731220992 [0;39m ==> Parameters: 
2021-08-27 16:47:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381082731220992 [0;39m <==    Updates: 0
2021-08-27 16:47:35.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381082731220992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:47:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86381082739609600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:47:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381082739609600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:47:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381082739609600 [0;39m ==> Parameters: 
2021-08-27 16:47:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381082739609600 [0;39m <==    Updates: 5
2021-08-27 16:47:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86381082739609600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:47:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381103736295424 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381103736295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381103736295424 [0;39m ==> Parameters: 
2021-08-27 16:47:40.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381103736295424 [0;39m <==    Updates: 0
2021-08-27 16:47:40.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381103736295424 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:47:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381124682649600 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381124682649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381124682649600 [0;39m ==> Parameters: 
2021-08-27 16:47:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381124682649600 [0;39m <==    Updates: 0
2021-08-27 16:47:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381124682649600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:47:50.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381145624809472 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:50.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381145624809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:50.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381145624809472 [0;39m ==> Parameters: 
2021-08-27 16:47:50.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381145624809472 [0;39m <==    Updates: 0
2021-08-27 16:47:50.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381145624809472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:47:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381166621495296 [0;39m 生成今日电子书快照开始
2021-08-27 16:47:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381166621495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:47:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381166621495296 [0;39m ==> Parameters: 
2021-08-27 16:47:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381166621495296 [0;39m <==    Updates: 0
2021-08-27 16:47:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381166621495296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381187601403904 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381187601403904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381187601403904 [0;39m ==> Parameters: 
2021-08-27 16:48:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381187601403904 [0;39m <==    Updates: 0
2021-08-27 16:48:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381187601403904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:04.124 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :42   [32m86375617150455809 [0;39m 连接关闭，token：AiKz5t6EmO，session id：3！当前连接数：0
2021-08-27 16:48:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381208551952384 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381208551952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381208551952384 [0;39m ==> Parameters: 
2021-08-27 16:48:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381208551952384 [0;39m <==    Updates: 0
2021-08-27 16:48:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381208551952384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86381208560340992 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:48:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381208560340992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:48:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381208560340992 [0;39m ==> Parameters: 
2021-08-27 16:48:05.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381208560340992 [0;39m <==    Updates: 5
2021-08-27 16:48:05.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86381208560340992 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:48:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381229515083776 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381229515083776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381229515083776 [0;39m ==> Parameters: 
2021-08-27 16:48:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381229515083776 [0;39m <==    Updates: 0
2021-08-27 16:48:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381229515083776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381250494992384 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381250494992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381250494992384 [0;39m ==> Parameters: 
2021-08-27 16:48:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381250494992384 [0;39m <==    Updates: 0
2021-08-27 16:48:15.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381250494992384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381271512649728 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381271512649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381271512649728 [0;39m ==> Parameters: 
2021-08-27 16:48:20.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381271512649728 [0;39m <==    Updates: 0
2021-08-27 16:48:20.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381271512649728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:25.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381292446420992 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381292446420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381292446420992 [0;39m ==> Parameters: 
2021-08-27 16:48:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381292446420992 [0;39m <==    Updates: 0
2021-08-27 16:48:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381292446420992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:30.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381313405358080 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381313405358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381313405358080 [0;39m ==> Parameters: 
2021-08-27 16:48:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381313405358080 [0;39m <==    Updates: 0
2021-08-27 16:48:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381313405358080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381334406238208 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381334406238208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381334406238208 [0;39m ==> Parameters: 
2021-08-27 16:48:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381334406238208 [0;39m <==    Updates: 0
2021-08-27 16:48:35.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381334406238208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86381334414626816 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:48:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381334414626816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:48:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381334414626816 [0;39m ==> Parameters: 
2021-08-27 16:48:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381334414626816 [0;39m <==    Updates: 5
2021-08-27 16:48:35.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86381334414626816 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:48:37.280 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :33   [32m86376095162699776 [0;39m 有新连接：token：bvS1aMe3Rh，session id：4，当前连接数：1
2021-08-27 16:48:37.439 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381344594202624 [0;39m ------------- 开始 -------------
2021-08-27 16:48:37.439 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381344594202624 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 16:48:37.440 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381344594202624 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 16:48:37.440 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381344594202624 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:37.440 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381344594202624 [0;39m 请求参数: []
2021-08-27 16:48:37.441 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86381344594202624 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:48:37.441 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86381344594202624 [0;39m ==> Parameters: 
2021-08-27 16:48:37.442 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86381344594202624 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 16:48:37.442 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86381344594202624 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 16:48:37.443 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86381344594202624 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 16:48:37.443 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86381344594202624 [0;39m <==      Total: 2
2021-08-27 16:48:37.444 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381344594202624 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 16:48:37.444 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381344594202624 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 16:48:37.453 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381344652922880 [0;39m ------------- 开始 -------------
2021-08-27 16:48:37.453 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381344652922881 [0;39m ------------- 开始 -------------
2021-08-27 16:48:37.453 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381344652922880 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 16:48:37.453 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381344652922881 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:48:37.453 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381344652922880 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 16:48:37.454 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381344652922881 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:48:37.454 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381344652922880 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:37.454 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381344652922881 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:37.454 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381344652922880 [0;39m 请求参数: []
2021-08-27 16:48:37.454 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381344652922881 [0;39m 请求参数: []
2021-08-27 16:48:37.454 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86381344652922880 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 16:48:37.454 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86381344652922880 [0;39m ==> Parameters: 
2021-08-27 16:48:37.455 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381344652922881 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:48:37.455 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381344652922881 [0;39m ==> Parameters: 
2021-08-27 16:48:37.455 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86381344652922880 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 16:48:37.456 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86381344652922880 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 16:48:37.456 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:48:37.456 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:48:37.456 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86381344652922880 [0;39m <==      Total: 1
2021-08-27 16:48:37.456 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:48:37.456 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381344652922880 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 16:48:37.456 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:48:37.456 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381344652922880 [0;39m ------------- 结束 耗时：3 ms -------------
2021-08-27 16:48:37.456 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:48:37.456 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:48:37.457 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:48:37.457 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:48:37.457 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:48:37.457 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:48:37.457 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:48:37.457 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:48:37.457 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:48:37.458 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:48:37.458 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:48:37.458 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:48:37.458 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381344652922881 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:48:37.458 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381344652922881 [0;39m <==      Total: 16
2021-08-27 16:48:37.460 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381344652922881 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:48:37.460 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381344652922881 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:48:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381355356786688 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381355356786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381355356786688 [0;39m ==> Parameters: 
2021-08-27 16:48:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381355356786688 [0;39m <==    Updates: 0
2021-08-27 16:48:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381355356786688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:42.668 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381366526218240 [0;39m ------------- 开始 -------------
2021-08-27 16:48:42.669 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381366526218240 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:42.669 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381366526218240 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:42.669 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381366526218240 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:42.669 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381366526218240 [0;39m 请求参数: [{"categoryId2":503,"page":1,"size":1000}]
2021-08-27 16:48:42.678 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381366526218240 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:42.678 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381366526218240 [0;39m ==> Parameters: 503(Long)
2021-08-27 16:48:42.680 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381366526218240 [0;39m <==    Columns: count(0)
2021-08-27 16:48:42.681 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381366526218240 [0;39m <==        Row: 0
2021-08-27 16:48:42.681 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381366526218240 [0;39m <==      Total: 1
2021-08-27 16:48:42.681 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381366526218240 [0;39m 总行数:0
2021-08-27 16:48:42.681 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381366526218240 [0;39m 总页数:0
2021-08-27 16:48:42.681 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381366526218240 [0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2021-08-27 16:48:42.681 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381366526218240 [0;39m ------------- 结束 耗时：13 ms -------------
2021-08-27 16:48:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381376340889600 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381376340889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381376340889600 [0;39m ==> Parameters: 
2021-08-27 16:48:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381376340889600 [0;39m <==    Updates: 0
2021-08-27 16:48:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381376340889600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:45.052 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381376525438976 [0;39m ------------- 开始 -------------
2021-08-27 16:48:45.052 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381376525438976 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:45.053 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381376525438976 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:45.053 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381376525438976 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:45.053 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381376525438976 [0;39m 请求参数: [{"categoryId2":502,"page":1,"size":1000}]
2021-08-27 16:48:45.055 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381376525438976 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:45.055 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381376525438976 [0;39m ==> Parameters: 502(Long)
2021-08-27 16:48:45.055 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381376525438976 [0;39m <==    Columns: count(0)
2021-08-27 16:48:45.056 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381376525438976 [0;39m <==        Row: 0
2021-08-27 16:48:45.056 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381376525438976 [0;39m <==      Total: 1
2021-08-27 16:48:45.056 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381376525438976 [0;39m 总行数:0
2021-08-27 16:48:45.056 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381376525438976 [0;39m 总页数:0
2021-08-27 16:48:45.057 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381376525438976 [0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2021-08-27 16:48:45.057 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381376525438976 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 16:48:45.675 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381379138490368 [0;39m ------------- 开始 -------------
2021-08-27 16:48:45.676 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381379138490368 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:45.676 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381379138490368 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:45.676 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381379138490368 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:45.676 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381379138490368 [0;39m 请求参数: [{"categoryId2":501,"page":1,"size":1000}]
2021-08-27 16:48:45.681 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381379138490368 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:45.681 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381379138490368 [0;39m ==> Parameters: 501(Long)
2021-08-27 16:48:45.681 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381379138490368 [0;39m <==    Columns: count(0)
2021-08-27 16:48:45.682 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381379138490368 [0;39m <==        Row: 0
2021-08-27 16:48:45.682 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381379138490368 [0;39m <==      Total: 1
2021-08-27 16:48:45.682 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381379138490368 [0;39m 总行数:0
2021-08-27 16:48:45.682 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381379138490368 [0;39m 总页数:0
2021-08-27 16:48:45.682 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381379138490368 [0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2021-08-27 16:48:45.682 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381379138490368 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:48:46.273 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381381646684160 [0;39m ------------- 开始 -------------
2021-08-27 16:48:46.273 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381381646684160 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:46.273 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381381646684160 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:46.273 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381381646684160 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:46.273 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381381646684160 [0;39m 请求参数: [{"categoryId2":401,"page":1,"size":1000}]
2021-08-27 16:48:46.275 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381381646684160 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:46.275 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381381646684160 [0;39m ==> Parameters: 401(Long)
2021-08-27 16:48:46.276 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381381646684160 [0;39m <==    Columns: count(0)
2021-08-27 16:48:46.276 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381381646684160 [0;39m <==        Row: 2
2021-08-27 16:48:46.276 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381381646684160 [0;39m <==      Total: 1
2021-08-27 16:48:46.277 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381381646684160 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-08-27 16:48:46.277 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381381646684160 [0;39m ==> Parameters: 401(Long), 1000(Integer)
2021-08-27 16:48:46.277 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381381646684160 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:48:46.277 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381381646684160 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 16:48:46.278 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381381646684160 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 16:48:46.278 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381381646684160 [0;39m <==      Total: 2
2021-08-27 16:48:46.278 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381381646684160 [0;39m 总行数:2
2021-08-27 16:48:46.278 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381381646684160 [0;39m 总页数:1
2021-08-27 16:48:46.278 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381381646684160 [0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1}],"total":2},"success":true}
2021-08-27 16:48:46.278 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381381646684160 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 16:48:46.899 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381384272318464 [0;39m ------------- 开始 -------------
2021-08-27 16:48:46.899 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381384272318464 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:46.899 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381384272318464 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:46.899 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381384272318464 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:46.900 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381384272318464 [0;39m 请求参数: [{"categoryId2":302,"page":1,"size":1000}]
2021-08-27 16:48:46.901 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381384272318464 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:46.902 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381384272318464 [0;39m ==> Parameters: 302(Long)
2021-08-27 16:48:46.903 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381384272318464 [0;39m <==    Columns: count(0)
2021-08-27 16:48:46.903 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381384272318464 [0;39m <==        Row: 0
2021-08-27 16:48:46.903 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381384272318464 [0;39m <==      Total: 1
2021-08-27 16:48:46.903 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381384272318464 [0;39m 总行数:0
2021-08-27 16:48:46.903 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381384272318464 [0;39m 总页数:0
2021-08-27 16:48:46.903 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381384272318464 [0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2021-08-27 16:48:46.903 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381384272318464 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:48:47.315 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381386017148928 [0;39m ------------- 开始 -------------
2021-08-27 16:48:47.316 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381386017148928 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:47.316 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381386017148928 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:47.316 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381386017148928 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:47.316 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381386017148928 [0;39m 请求参数: [{"categoryId2":301,"page":1,"size":1000}]
2021-08-27 16:48:47.317 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381386017148928 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:47.318 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381386017148928 [0;39m ==> Parameters: 301(Long)
2021-08-27 16:48:47.318 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381386017148928 [0;39m <==    Columns: count(0)
2021-08-27 16:48:47.319 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381386017148928 [0;39m <==        Row: 1
2021-08-27 16:48:47.319 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381386017148928 [0;39m <==      Total: 1
2021-08-27 16:48:47.319 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381386017148928 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-08-27 16:48:47.320 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381386017148928 [0;39m ==> Parameters: 301(Long), 1000(Integer)
2021-08-27 16:48:47.320 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381386017148928 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:48:47.320 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381386017148928 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 16:48:47.320 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381386017148928 [0;39m <==      Total: 1
2021-08-27 16:48:47.321 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381386017148928 [0;39m 总行数:1
2021-08-27 16:48:47.321 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381386017148928 [0;39m 总页数:1
2021-08-27 16:48:47.321 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381386017148928 [0;39m 返回结果: {"content":{"list":[{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3}],"total":1},"success":true}
2021-08-27 16:48:47.321 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381386017148928 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:48:48.499 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381390983204864 [0;39m ------------- 开始 -------------
2021-08-27 16:48:48.499 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381390983204864 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:48.499 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381390983204864 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:48.500 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381390983204864 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:48.500 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381390983204864 [0;39m 请求参数: [{"categoryId2":202,"page":1,"size":1000}]
2021-08-27 16:48:48.501 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381390983204864 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:48.502 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381390983204864 [0;39m ==> Parameters: 202(Long)
2021-08-27 16:48:48.502 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381390983204864 [0;39m <==    Columns: count(0)
2021-08-27 16:48:48.502 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381390983204864 [0;39m <==        Row: 1
2021-08-27 16:48:48.502 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381390983204864 [0;39m <==      Total: 1
2021-08-27 16:48:48.503 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381390983204864 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-08-27 16:48:48.503 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381390983204864 [0;39m ==> Parameters: 202(Long), 1000(Integer)
2021-08-27 16:48:48.503 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381390983204864 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:48:48.503 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381390983204864 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 16:48:48.504 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381390983204864 [0;39m <==      Total: 1
2021-08-27 16:48:48.504 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381390983204864 [0;39m 总行数:1
2021-08-27 16:48:48.504 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381390983204864 [0;39m 总页数:1
2021-08-27 16:48:48.504 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381390983204864 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0}],"total":1},"success":true}
2021-08-27 16:48:48.504 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381390983204864 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 16:48:48.995 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381393063579648 [0;39m ------------- 开始 -------------
2021-08-27 16:48:48.995 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381393063579648 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:48.995 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381393063579648 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:48.995 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381393063579648 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:48.996 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381393063579648 [0;39m 请求参数: [{"categoryId2":201,"page":1,"size":1000}]
2021-08-27 16:48:48.997 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381393063579648 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:48.997 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381393063579648 [0;39m ==> Parameters: 201(Long)
2021-08-27 16:48:48.998 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381393063579648 [0;39m <==    Columns: count(0)
2021-08-27 16:48:48.998 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381393063579648 [0;39m <==        Row: 1
2021-08-27 16:48:48.998 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381393063579648 [0;39m <==      Total: 1
2021-08-27 16:48:48.999 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381393063579648 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-08-27 16:48:48.999 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381393063579648 [0;39m ==> Parameters: 201(Long), 1000(Integer)
2021-08-27 16:48:49.000 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381393063579648 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:48:49.000 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381393063579648 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 16:48:49.001 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381393063579648 [0;39m <==      Total: 1
2021-08-27 16:48:49.001 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381393063579648 [0;39m 总行数:1
2021-08-27 16:48:49.001 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381393063579648 [0;39m 总页数:1
2021-08-27 16:48:49.001 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381393063579648 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12}],"total":1},"success":true}
2021-08-27 16:48:49.001 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381393063579648 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 16:48:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381397337575424 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381397337575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381397337575424 [0;39m ==> Parameters: 
2021-08-27 16:48:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381397337575424 [0;39m <==    Updates: 0
2021-08-27 16:48:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381397337575424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:48:50.168 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381397983498240 [0;39m ------------- 开始 -------------
2021-08-27 16:48:50.168 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381397983498240 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:50.169 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381397983498240 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:50.169 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381397983498240 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:50.169 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381397983498240 [0;39m 请求参数: [{"categoryId2":503,"page":1,"size":1000}]
2021-08-27 16:48:50.170 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381397983498240 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:50.171 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381397983498240 [0;39m ==> Parameters: 503(Long)
2021-08-27 16:48:50.171 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381397983498240 [0;39m <==    Columns: count(0)
2021-08-27 16:48:50.171 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381397983498240 [0;39m <==        Row: 0
2021-08-27 16:48:50.172 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381397983498240 [0;39m <==      Total: 1
2021-08-27 16:48:50.172 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381397983498240 [0;39m 总行数:0
2021-08-27 16:48:50.172 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381397983498240 [0;39m 总页数:0
2021-08-27 16:48:50.172 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381397983498240 [0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2021-08-27 16:48:50.172 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381397983498240 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:48:51.514 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381403629031424 [0;39m ------------- 开始 -------------
2021-08-27 16:48:51.515 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381403629031424 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:51.515 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381403629031424 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:51.515 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381403629031424 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:51.515 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381403629031424 [0;39m 请求参数: [{"categoryId2":502,"page":1,"size":1000}]
2021-08-27 16:48:51.516 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381403629031424 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:51.517 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381403629031424 [0;39m ==> Parameters: 502(Long)
2021-08-27 16:48:51.517 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381403629031424 [0;39m <==    Columns: count(0)
2021-08-27 16:48:51.518 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381403629031424 [0;39m <==        Row: 0
2021-08-27 16:48:51.518 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381403629031424 [0;39m <==      Total: 1
2021-08-27 16:48:51.518 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381403629031424 [0;39m 总行数:0
2021-08-27 16:48:51.518 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381403629031424 [0;39m 总页数:0
2021-08-27 16:48:51.518 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381403629031424 [0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2021-08-27 16:48:51.518 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381403629031424 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:48:52.948 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381409643663360 [0;39m ------------- 开始 -------------
2021-08-27 16:48:52.948 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381409643663360 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:52.948 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381409643663360 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:52.948 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381409643663360 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:52.949 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381409643663360 [0;39m 请求参数: [{"categoryId2":501,"page":1,"size":1000}]
2021-08-27 16:48:52.950 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381409643663360 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:52.951 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381409643663360 [0;39m ==> Parameters: 501(Long)
2021-08-27 16:48:52.951 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381409643663360 [0;39m <==    Columns: count(0)
2021-08-27 16:48:52.951 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381409643663360 [0;39m <==        Row: 0
2021-08-27 16:48:52.951 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381409643663360 [0;39m <==      Total: 1
2021-08-27 16:48:52.952 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381409643663360 [0;39m 总行数:0
2021-08-27 16:48:52.952 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381409643663360 [0;39m 总页数:0
2021-08-27 16:48:52.952 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381409643663360 [0;39m 返回结果: {"content":{"list":[],"total":0},"success":true}
2021-08-27 16:48:52.952 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381409643663360 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 16:48:54.131 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381414605524992 [0;39m ------------- 开始 -------------
2021-08-27 16:48:54.131 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381414605524992 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:48:54.131 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381414605524992 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:48:54.132 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381414605524992 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:48:54.132 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381414605524992 [0;39m 请求参数: [{"categoryId2":401,"page":1,"size":1000}]
2021-08-27 16:48:54.133 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381414605524992 [0;39m ==>  Preparing: SELECT count(0) FROM ebook WHERE (category2_id = ?)
2021-08-27 16:48:54.134 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381414605524992 [0;39m ==> Parameters: 401(Long)
2021-08-27 16:48:54.135 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381414605524992 [0;39m <==    Columns: count(0)
2021-08-27 16:48:54.135 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381414605524992 [0;39m <==        Row: 2
2021-08-27 16:48:54.136 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381414605524992 [0;39m <==      Total: 1
2021-08-27 16:48:54.136 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381414605524992 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook WHERE ( category2_id = ? ) LIMIT ?
2021-08-27 16:48:54.136 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381414605524992 [0;39m ==> Parameters: 401(Long), 1000(Integer)
2021-08-27 16:48:54.137 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381414605524992 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:48:54.137 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381414605524992 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 16:48:54.137 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381414605524992 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 16:48:54.137 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381414605524992 [0;39m <==      Total: 2
2021-08-27 16:48:54.138 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381414605524992 [0;39m 总行数:2
2021-08-27 16:48:54.138 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381414605524992 [0;39m 总页数:1
2021-08-27 16:48:54.138 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381414605524992 [0;39m 返回结果: {"content":{"list":[{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1}],"total":2},"success":true}
2021-08-27 16:48:54.138 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381414605524992 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:48:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381418304901120 [0;39m 生成今日电子书快照开始
2021-08-27 16:48:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381418304901120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:48:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381418304901120 [0;39m ==> Parameters: 
2021-08-27 16:48:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381418304901120 [0;39m <==    Updates: 0
2021-08-27 16:48:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381418304901120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:49:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381439247060992 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381439247060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381439247060992 [0;39m ==> Parameters: 
2021-08-27 16:49:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381439247060992 [0;39m <==    Updates: 0
2021-08-27 16:49:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381439247060992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:49:02.881 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381451305684992 [0;39m ------------- 开始 -------------
2021-08-27 16:49:02.882 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381451305684992 [0;39m 请求地址: http://127.0.0.1:8880/user/login POST
2021-08-27 16:49:02.882 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381451305684992 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.login
2021-08-27 16:49:02.882 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381451305684992 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:49:02.882 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381451305684992 [0;39m 请求参数: [{"loginName":"test"}]
2021-08-27 16:49:02.883 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86381451305684992 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-08-27 16:49:02.884 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86381451305684992 [0;39m ==> Parameters: test(String)
2021-08-27 16:49:02.885 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86381451305684992 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 16:49:02.885 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86381451305684992 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 16:49:02.885 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86381451305684992 [0;39m <==      Total: 1
2021-08-27 16:49:02.886 INFO  com.haoyu.knowlagebase.controller.UserController  :81   [32m86381451305684992 [0;39m 生成单点登录token：86381451326656512，并放入redis中
2021-08-27 16:49:02.888 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381451305684992 [0;39m 返回结果: {"content":{"id":1,"loginName":"test","name":"测试","token":"86381451326656512"},"success":true}
2021-08-27 16:49:02.888 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381451305684992 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:49:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86381460239552512 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:49:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381460239552512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:49:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381460239552512 [0;39m ==> Parameters: 
2021-08-27 16:49:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381460239552512 [0;39m <==    Updates: 5
2021-08-27 16:49:05.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86381460239552512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:49:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381460243746816 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381460243746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381460243746816 [0;39m ==> Parameters: 
2021-08-27 16:49:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381460243746816 [0;39m <==    Updates: 0
2021-08-27 16:49:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381460243746816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:49:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381481169129472 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381481169129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381481169129472 [0;39m ==> Parameters: 
2021-08-27 16:49:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381481169129472 [0;39m <==    Updates: 0
2021-08-27 16:49:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381481169129472 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:49:15.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381502203564032 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:15.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381502203564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:15.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381502203564032 [0;39m ==> Parameters: 
2021-08-27 16:49:15.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381502203564032 [0;39m <==    Updates: 0
2021-08-27 16:49:15.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381502203564032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:49:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381523158306816 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381523158306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381523158306816 [0;39m ==> Parameters: 
2021-08-27 16:49:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381523158306816 [0;39m <==    Updates: 0
2021-08-27 16:49:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381523158306816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:49:25.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381544146604032 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:25.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381544146604032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:25.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381544146604032 [0;39m ==> Parameters: 
2021-08-27 16:49:25.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381544146604032 [0;39m <==    Updates: 0
2021-08-27 16:49:25.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381544146604032 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:49:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381565071986688 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381565071986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381565071986688 [0;39m ==> Parameters: 
2021-08-27 16:49:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381565071986688 [0;39m <==    Updates: 0
2021-08-27 16:49:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381565071986688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:49:35.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381586039312384 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381586039312384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381586039312384 [0;39m ==> Parameters: 
2021-08-27 16:49:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381586039312384 [0;39m <==    Updates: 0
2021-08-27 16:49:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381586039312384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:49:35.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86381586047700992 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:49:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381586047700992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:49:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381586047700992 [0;39m ==> Parameters: 
2021-08-27 16:49:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381586047700992 [0;39m <==    Updates: 5
2021-08-27 16:49:35.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86381586047700992 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 16:49:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381607044386816 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381607044386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381607044386816 [0;39m ==> Parameters: 
2021-08-27 16:49:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381607044386816 [0;39m <==    Updates: 0
2021-08-27 16:49:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381607044386816 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:49:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381628007518208 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381628007518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381628007518208 [0;39m ==> Parameters: 
2021-08-27 16:49:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381628007518208 [0;39m <==    Updates: 0
2021-08-27 16:49:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381628007518208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:49:50.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381648974843904 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381648974843904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381648974843904 [0;39m ==> Parameters: 
2021-08-27 16:49:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381648974843904 [0;39m <==    Updates: 0
2021-08-27 16:49:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381648974843904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:49:55.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381669942169600 [0;39m 生成今日电子书快照开始
2021-08-27 16:49:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381669942169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:49:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381669942169600 [0;39m ==> Parameters: 
2021-08-27 16:49:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381669942169600 [0;39m <==    Updates: 0
2021-08-27 16:49:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381669942169600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:50:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381690905300992 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381690905300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381690905300992 [0;39m ==> Parameters: 
2021-08-27 16:50:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381690905300992 [0;39m <==    Updates: 0
2021-08-27 16:50:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381690905300992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:50:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381711876820992 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381711876820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381711876820992 [0;39m ==> Parameters: 
2021-08-27 16:50:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381711876820992 [0;39m <==    Updates: 0
2021-08-27 16:50:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381711876820992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:50:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86381711885209600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:50:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381711885209600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:50:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381711885209600 [0;39m ==> Parameters: 
2021-08-27 16:50:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381711885209600 [0;39m <==    Updates: 5
2021-08-27 16:50:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86381711885209600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:50:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381732831563776 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381732831563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381732831563776 [0;39m ==> Parameters: 
2021-08-27 16:50:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381732831563776 [0;39m <==    Updates: 0
2021-08-27 16:50:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381732831563776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:50:15.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381753815666688 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381753815666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381753815666688 [0;39m ==> Parameters: 
2021-08-27 16:50:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381753815666688 [0;39m <==    Updates: 0
2021-08-27 16:50:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381753815666688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:50:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381774816546816 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381774816546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381774816546816 [0;39m ==> Parameters: 
2021-08-27 16:50:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381774816546816 [0;39m <==    Updates: 0
2021-08-27 16:50:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381774816546816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:50:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381795771289600 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381795771289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381795771289600 [0;39m ==> Parameters: 
2021-08-27 16:50:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381795771289600 [0;39m <==    Updates: 0
2021-08-27 16:50:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381795771289600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:50:30.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381816759586816 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381816759586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381816759586816 [0;39m ==> Parameters: 
2021-08-27 16:50:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381816759586816 [0;39m <==    Updates: 0
2021-08-27 16:50:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381816759586816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:50:31.430 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :42   [32m86381390983204864 [0;39m 连接关闭，token：bvS1aMe3Rh，session id：4！当前连接数：0
2021-08-27 16:50:32.328 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :33   [32m86381393063579648 [0;39m 有新连接：token：pRoIVCRXsK，session id：5，当前连接数：1
2021-08-27 16:50:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86381837726912512 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:50:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381837726912512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:50:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381837726912512 [0;39m ==> Parameters: 
2021-08-27 16:50:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381837726912512 [0;39m <==    Updates: 5
2021-08-27 16:50:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86381837726912512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:50:35.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381837731106816 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381837731106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381837731106816 [0;39m ==> Parameters: 
2021-08-27 16:50:35.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381837731106816 [0;39m <==    Updates: 0
2021-08-27 16:50:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381837731106816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:50:40.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381858660683776 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381858660683776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381858660683776 [0;39m ==> Parameters: 
2021-08-27 16:50:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381858660683776 [0;39m <==    Updates: 0
2021-08-27 16:50:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381858660683776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:50:40.843 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381862188093440 [0;39m ------------- 开始 -------------
2021-08-27 16:50:40.843 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381862188093440 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:50:40.844 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381862188093440 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:50:40.844 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381862188093440 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:50:40.844 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381862188093440 [0;39m 请求参数: []
2021-08-27 16:50:40.846 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381862188093440 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:50:40.846 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381862188093440 [0;39m ==> Parameters: 
2021-08-27 16:50:40.847 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:50:40.848 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:50:40.848 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:50:40.848 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:50:40.848 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:50:40.849 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:50:40.849 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:50:40.849 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:50:40.849 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:50:40.849 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:50:40.850 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:50:40.850 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:50:40.850 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:50:40.850 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:50:40.850 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:50:40.850 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:50:40.850 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381862188093440 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:50:40.851 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381862188093440 [0;39m <==      Total: 16
2021-08-27 16:50:40.851 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381862188093440 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:50:40.851 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381862188093440 [0;39m ------------- 结束 耗时：8 ms -------------
2021-08-27 16:50:40.866 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381862284562432 [0;39m ------------- 开始 -------------
2021-08-27 16:50:40.866 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381862284562432 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:50:40.866 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381862284562432 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:50:40.866 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381862284562432 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:50:40.866 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381862284562432 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 16:50:40.867 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381862284562432 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-08-27 16:50:40.867 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381862284562432 [0;39m ==> Parameters: 
2021-08-27 16:50:40.868 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381862284562432 [0;39m <==    Columns: count(0)
2021-08-27 16:50:40.868 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381862284562432 [0;39m <==        Row: 7
2021-08-27 16:50:40.868 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381862284562432 [0;39m <==      Total: 1
2021-08-27 16:50:40.869 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381862284562432 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-08-27 16:50:40.869 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381862284562432 [0;39m ==> Parameters: 10(Integer)
2021-08-27 16:50:40.869 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381862284562432 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:50:40.870 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381862284562432 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 16:50:40.870 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381862284562432 [0;39m <==        Row: 2, Vue 入门教程, 100, 101, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover1.png, 0, 0, 0
2021-08-27 16:50:40.870 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381862284562432 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 16:50:40.870 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381862284562432 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 16:50:40.870 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381862284562432 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 16:50:40.870 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381862284562432 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 16:50:40.870 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381862284562432 [0;39m <==        Row: 85670061133664256, 111, 100, 82110017238601728, 111, 111, 3, 3, 3
2021-08-27 16:50:40.871 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381862284562432 [0;39m <==      Total: 7
2021-08-27 16:50:40.871 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381862284562432 [0;39m 总行数:7
2021-08-27 16:50:40.871 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381862284562432 [0;39m 总页数:1
2021-08-27 16:50:40.871 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381862284562432 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3},{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1},{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":82110017238601728,"cover":"111","description":"111","docCount":3,"id":85670061133664256,"name":"111","viewCount":3,"voteCount":3}],"total":7},"success":true}
2021-08-27 16:50:40.871 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381862284562432 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 16:50:43.889 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381874963943424 [0;39m ------------- 开始 -------------
2021-08-27 16:50:43.889 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381874963943424 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:50:43.889 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381874963943424 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:50:43.890 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381874963943424 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:50:43.890 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381874963943424 [0;39m 请求参数: []
2021-08-27 16:50:43.890 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381874963943424 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:50:43.891 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381874963943424 [0;39m ==> Parameters: 
2021-08-27 16:50:43.891 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:50:43.891 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:50:43.892 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:50:43.892 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:50:43.892 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:50:43.892 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:50:43.892 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:50:43.892 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:50:43.892 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:50:43.893 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:50:43.893 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:50:43.893 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:50:43.893 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:50:43.893 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:50:43.893 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:50:43.893 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:50:43.894 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381874963943424 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:50:43.894 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381874963943424 [0;39m <==      Total: 16
2021-08-27 16:50:43.894 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381874963943424 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:50:43.894 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381874963943424 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 16:50:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381879678341120 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381879678341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381879678341120 [0;39m ==> Parameters: 
2021-08-27 16:50:45.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381879678341120 [0;39m <==    Updates: 0
2021-08-27 16:50:45.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381879678341120 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 16:50:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381900612112384 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381900612112384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381900612112384 [0;39m ==> Parameters: 
2021-08-27 16:50:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381900612112384 [0;39m <==    Updates: 0
2021-08-27 16:50:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381900612112384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:50:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381921612992512 [0;39m 生成今日电子书快照开始
2021-08-27 16:50:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381921612992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:50:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381921612992512 [0;39m ==> Parameters: 
2021-08-27 16:50:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381921612992512 [0;39m <==    Updates: 0
2021-08-27 16:50:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381921612992512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:51:00.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381942542569472 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381942542569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:00.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381942542569472 [0;39m ==> Parameters: 
2021-08-27 16:51:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381942542569472 [0;39m <==    Updates: 0
2021-08-27 16:51:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381942542569472 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:51:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86381963568615424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:51:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381963568615424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:51:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381963568615424 [0;39m ==> Parameters: 
2021-08-27 16:51:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86381963568615424 [0;39m <==    Updates: 5
2021-08-27 16:51:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86381963568615424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:51:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381963572809728 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381963572809728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381963572809728 [0;39m ==> Parameters: 
2021-08-27 16:51:05.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381963572809728 [0;39m <==    Updates: 0
2021-08-27 16:51:05.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381963572809728 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:51:07.060 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381972150161408 [0;39m ------------- 开始 -------------
2021-08-27 16:51:07.061 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381972150161408 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 16:51:07.062 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381972150161408 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 16:51:07.062 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381972150161408 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:51:07.062 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381972150161408 [0;39m 请求参数: []
2021-08-27 16:51:07.062 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381972150161408 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 16:51:07.063 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381972150161408 [0;39m ==> Parameters: 
2021-08-27 16:51:07.063 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 16:51:07.063 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 16:51:07.064 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 16:51:07.064 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 16:51:07.064 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 16:51:07.064 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 16:51:07.064 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 16:51:07.064 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 16:51:07.065 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 16:51:07.065 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 16:51:07.065 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 16:51:07.065 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 16:51:07.065 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 16:51:07.065 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 16:51:07.066 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 16:51:07.066 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 16:51:07.066 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86381972150161408 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 16:51:07.066 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86381972150161408 [0;39m <==      Total: 16
2021-08-27 16:51:07.067 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381972150161408 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 16:51:07.067 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381972150161408 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 16:51:07.107 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381972347293696 [0;39m ------------- 开始 -------------
2021-08-27 16:51:07.107 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381972347293696 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 16:51:07.108 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381972347293696 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 16:51:07.108 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381972347293696 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:51:07.108 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381972347293696 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 16:51:07.108 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381972347293696 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-08-27 16:51:07.109 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381972347293696 [0;39m ==> Parameters: 
2021-08-27 16:51:07.109 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381972347293696 [0;39m <==    Columns: count(0)
2021-08-27 16:51:07.110 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86381972347293696 [0;39m <==        Row: 7
2021-08-27 16:51:07.110 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86381972347293696 [0;39m <==      Total: 1
2021-08-27 16:51:07.110 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381972347293696 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-08-27 16:51:07.111 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381972347293696 [0;39m ==> Parameters: 10(Integer)
2021-08-27 16:51:07.111 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381972347293696 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 16:51:07.112 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381972347293696 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 16:51:07.112 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381972347293696 [0;39m <==        Row: 2, Vue 入门教程, 100, 101, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover1.png, 0, 0, 0
2021-08-27 16:51:07.112 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381972347293696 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 16:51:07.112 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381972347293696 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 16:51:07.113 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381972347293696 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 16:51:07.113 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381972347293696 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 16:51:07.113 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86381972347293696 [0;39m <==        Row: 85670061133664256, 111, 100, 82110017238601728, 111, 111, 3, 3, 3
2021-08-27 16:51:07.113 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86381972347293696 [0;39m <==      Total: 7
2021-08-27 16:51:07.114 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86381972347293696 [0;39m 总行数:7
2021-08-27 16:51:07.114 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86381972347293696 [0;39m 总页数:1
2021-08-27 16:51:07.115 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381972347293696 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3},{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1},{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":82110017238601728,"cover":"111","description":"111","docCount":3,"id":85670061133664256,"name":"111","viewCount":3,"voteCount":3}],"total":7},"success":true}
2021-08-27 16:51:07.115 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381972347293696 [0;39m ------------- 结束 耗时：8 ms -------------
2021-08-27 16:51:08.534 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86381978332565504 [0;39m ------------- 开始 -------------
2021-08-27 16:51:08.534 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86381978332565504 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/1 GET
2021-08-27 16:51:08.534 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86381978332565504 [0;39m 类名方法: com.haoyu.knowlagebase.controller.DocController.all
2021-08-27 16:51:08.534 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86381978332565504 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:51:08.535 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86381978332565504 [0;39m 请求参数: [1]
2021-08-27 16:51:08.539 DEBUG c.h.knowlagebase.mapper.DocMapper.selectByExample :137  [32m86381978332565504 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-08-27 16:51:08.540 DEBUG c.h.knowlagebase.mapper.DocMapper.selectByExample :137  [32m86381978332565504 [0;39m ==> Parameters: 1(Long)
2021-08-27 16:51:08.541 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-08-27 16:51:08.541 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 1, 1, 0, Ant Design Vue, 1, 24, 2
2021-08-27 16:51:08.541 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 2, 0
2021-08-27 16:51:08.541 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 4, 1, 3, 文档2.1, 1, 3, 1
2021-08-27 16:51:08.542 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 6, 1, 5, 文档2.2.1, 1, 2, 1
2021-08-27 16:51:08.542 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 85747953192538112, 1, 2, 8, 1, 1, 1
2021-08-27 16:51:08.542 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 85749087462363136, 1, 2, 9, 1, 1, 1
2021-08-27 16:51:08.542 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 85750049518260224, 1, 2, 10, 1, 1, 1
2021-08-27 16:51:08.542 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 3, 1, 0, 文档2, 2, 1, 0
2021-08-27 16:51:08.542 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 5, 1, 3, 文档2.2, 2, 2, 1
2021-08-27 16:51:08.543 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 85739590006214656, 1, 2, 4444, 4, 1, 1
2021-08-27 16:51:08.543 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 85740865577947136, 1, 2, 6666, 6, 1, 1
2021-08-27 16:51:08.543 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 85746827776888832, 1, 2, 7, 7, 2, 1
2021-08-27 16:51:08.543 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86381978332565504 [0;39m <==        Row: 85740705846267904, 1, 2, 555, 5555, 3, 1
2021-08-27 16:51:08.543 DEBUG c.h.knowlagebase.mapper.DocMapper.selectByExample :137  [32m86381978332565504 [0;39m <==      Total: 13
2021-08-27 16:51:08.549 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86381978332565504 [0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"Ant Design Vue","parent":0,"sort":1,"viewCount":24,"voteCount":2},{"ebookId":1,"id":2,"name":"文档1.1","parent":1,"sort":1,"viewCount":2,"voteCount":0},{"ebookId":1,"id":4,"name":"文档2.1","parent":3,"sort":1,"viewCount":3,"voteCount":1},{"ebookId":1,"id":6,"name":"文档2.2.1","parent":5,"sort":1,"viewCount":2,"voteCount":1},{"ebookId":1,"id":85747953192538112,"name":"8","parent":2,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85749087462363136,"name":"9","parent":2,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85750049518260224,"name":"10","parent":2,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":3,"name":"文档2","parent":0,"sort":2,"viewCount":1,"voteCount":0},{"ebookId":1,"id":5,"name":"文档2.2","parent":3,"sort":2,"viewCount":2,"voteCount":1},{"ebookId":1,"id":85739590006214656,"name":"4444","parent":2,"sort":4,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85740865577947136,"name":"6666","parent":2,"sort":6,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85746827776888832,"name":"7","parent":2,"sort":7,"viewCount":2,"voteCount":1},{"ebookId":1,"id":85740705846267904,"name":"555","parent":2,"sort":5555,"viewCount":3,"voteCount":1}],"success":true}
2021-08-27 16:51:08.550 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86381978332565504 [0;39m ------------- 结束 耗时：16 ms -------------
2021-08-27 16:51:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86381984485609472 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381984485609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381984485609472 [0;39m ==> Parameters: 
2021-08-27 16:51:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86381984485609472 [0;39m <==    Updates: 0
2021-08-27 16:51:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86381984485609472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:51:15.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382005457129472 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:15.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382005457129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:15.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382005457129472 [0;39m ==> Parameters: 
2021-08-27 16:51:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382005457129472 [0;39m <==    Updates: 0
2021-08-27 16:51:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382005457129472 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:51:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382026441232384 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382026441232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382026441232384 [0;39m ==> Parameters: 
2021-08-27 16:51:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382026441232384 [0;39m <==    Updates: 0
2021-08-27 16:51:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382026441232384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:51:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382047446306816 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382047446306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382047446306816 [0;39m ==> Parameters: 
2021-08-27 16:51:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382047446306816 [0;39m <==    Updates: 0
2021-08-27 16:51:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382047446306816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:51:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382068409438208 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382068409438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382068409438208 [0;39m ==> Parameters: 
2021-08-27 16:51:30.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382068409438208 [0;39m <==    Updates: 0
2021-08-27 16:51:30.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382068409438208 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 16:51:35.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86382089355792384 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:51:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382089355792384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:51:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382089355792384 [0;39m ==> Parameters: 
2021-08-27 16:51:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382089355792384 [0;39m <==    Updates: 5
2021-08-27 16:51:35.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86382089355792384 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:51:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382089364180992 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382089364180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382089364180992 [0;39m ==> Parameters: 
2021-08-27 16:51:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382089364180992 [0;39m <==    Updates: 0
2021-08-27 16:51:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382089364180992 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:51:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382110335700992 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382110335700992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382110335700992 [0;39m ==> Parameters: 
2021-08-27 16:51:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382110335700992 [0;39m <==    Updates: 0
2021-08-27 16:51:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382110335700992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:51:45.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382131286249472 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:45.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382131286249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382131286249472 [0;39m ==> Parameters: 
2021-08-27 16:51:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382131286249472 [0;39m <==    Updates: 0
2021-08-27 16:51:45.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382131286249472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:51:50.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382152257769472 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:50.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382152257769472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:50.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382152257769472 [0;39m ==> Parameters: 
2021-08-27 16:51:50.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382152257769472 [0;39m <==    Updates: 0
2021-08-27 16:51:50.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382152257769472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:51:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382173279621120 [0;39m 生成今日电子书快照开始
2021-08-27 16:51:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382173279621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:51:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382173279621120 [0;39m ==> Parameters: 
2021-08-27 16:51:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382173279621120 [0;39m <==    Updates: 0
2021-08-27 16:51:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382173279621120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:52:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382194225975296 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382194225975296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382194225975296 [0;39m ==> Parameters: 
2021-08-27 16:52:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382194225975296 [0;39m <==    Updates: 0
2021-08-27 16:52:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382194225975296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:52:05.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382215180718080 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382215180718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382215180718080 [0;39m ==> Parameters: 
2021-08-27 16:52:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382215180718080 [0;39m <==    Updates: 0
2021-08-27 16:52:05.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382215180718080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:52:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86382215189106688 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:52:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382215189106688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:52:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382215189106688 [0;39m ==> Parameters: 
2021-08-27 16:52:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382215189106688 [0;39m <==    Updates: 5
2021-08-27 16:52:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86382215189106688 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:52:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382236181598208 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382236181598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382236181598208 [0;39m ==> Parameters: 
2021-08-27 16:52:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382236181598208 [0;39m <==    Updates: 0
2021-08-27 16:52:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382236181598208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:52:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382257119563776 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382257119563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382257119563776 [0;39m ==> Parameters: 
2021-08-27 16:52:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382257119563776 [0;39m <==    Updates: 0
2021-08-27 16:52:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382257119563776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:52:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382278103666688 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382278103666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382278103666688 [0;39m ==> Parameters: 
2021-08-27 16:52:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382278103666688 [0;39m <==    Updates: 0
2021-08-27 16:52:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382278103666688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:52:25.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382299062603776 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382299062603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382299062603776 [0;39m ==> Parameters: 
2021-08-27 16:52:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382299062603776 [0;39m <==    Updates: 0
2021-08-27 16:52:25.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382299062603776 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 16:52:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382320084455424 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382320084455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382320084455424 [0;39m ==> Parameters: 
2021-08-27 16:52:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382320084455424 [0;39m <==    Updates: 0
2021-08-27 16:52:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382320084455424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:52:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86382341060169728 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:52:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382341060169728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:52:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382341060169728 [0;39m ==> Parameters: 
2021-08-27 16:52:35.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382341060169728 [0;39m <==    Updates: 5
2021-08-27 16:52:35.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86382341060169728 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:52:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382341068558336 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382341068558336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382341068558336 [0;39m ==> Parameters: 
2021-08-27 16:52:35.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382341068558336 [0;39m <==    Updates: 0
2021-08-27 16:52:35.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382341068558336 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:52:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382361998135296 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382361998135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382361998135296 [0;39m ==> Parameters: 
2021-08-27 16:52:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382361998135296 [0;39m <==    Updates: 0
2021-08-27 16:52:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382361998135296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:52:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382382999015424 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382382999015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382382999015424 [0;39m ==> Parameters: 
2021-08-27 16:52:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382382999015424 [0;39m <==    Updates: 0
2021-08-27 16:52:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382382999015424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:52:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382403932786688 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382403932786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382403932786688 [0;39m ==> Parameters: 
2021-08-27 16:52:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382403932786688 [0;39m <==    Updates: 0
2021-08-27 16:52:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382403932786688 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:52:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382424895918080 [0;39m 生成今日电子书快照开始
2021-08-27 16:52:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382424895918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:52:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382424895918080 [0;39m ==> Parameters: 
2021-08-27 16:52:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382424895918080 [0;39m <==    Updates: 0
2021-08-27 16:52:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382424895918080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:53:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382445896798208 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382445896798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382445896798208 [0;39m ==> Parameters: 
2021-08-27 16:53:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382445896798208 [0;39m <==    Updates: 0
2021-08-27 16:53:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382445896798208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:53:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86382466847346688 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:53:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382466847346688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:53:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382466847346688 [0;39m ==> Parameters: 
2021-08-27 16:53:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382466847346688 [0;39m <==    Updates: 5
2021-08-27 16:53:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86382466847346688 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:53:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382466851540992 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382466851540992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382466851540992 [0;39m ==> Parameters: 
2021-08-27 16:53:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382466851540992 [0;39m <==    Updates: 0
2021-08-27 16:53:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382466851540992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:53:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382487827255296 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382487827255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382487827255296 [0;39m ==> Parameters: 
2021-08-27 16:53:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382487827255296 [0;39m <==    Updates: 0
2021-08-27 16:53:10.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382487827255296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:53:15.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382508773609472 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:15.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382508773609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382508773609472 [0;39m ==> Parameters: 
2021-08-27 16:53:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382508773609472 [0;39m <==    Updates: 0
2021-08-27 16:53:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382508773609472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:53:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382529799655424 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382529799655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382529799655424 [0;39m ==> Parameters: 
2021-08-27 16:53:20.020 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382529799655424 [0;39m <==    Updates: 0
2021-08-27 16:53:20.021 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382529799655424 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 16:53:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382550762786816 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382550762786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382550762786816 [0;39m ==> Parameters: 
2021-08-27 16:53:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382550762786816 [0;39m <==    Updates: 0
2021-08-27 16:53:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382550762786816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:53:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382571721723904 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382571721723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382571721723904 [0;39m ==> Parameters: 
2021-08-27 16:53:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382571721723904 [0;39m <==    Updates: 0
2021-08-27 16:53:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382571721723904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:53:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382592684855296 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382592684855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382592684855296 [0;39m ==> Parameters: 
2021-08-27 16:53:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382592684855296 [0;39m <==    Updates: 0
2021-08-27 16:53:35.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382592684855296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:53:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86382592689049600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:53:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382592689049600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:53:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382592689049600 [0;39m ==> Parameters: 
2021-08-27 16:53:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382592689049600 [0;39m <==    Updates: 5
2021-08-27 16:53:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86382592689049600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:53:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382613685735424 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382613685735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382613685735424 [0;39m ==> Parameters: 
2021-08-27 16:53:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382613685735424 [0;39m <==    Updates: 0
2021-08-27 16:53:40.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382613685735424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:53:45.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382634606923776 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382634606923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382634606923776 [0;39m ==> Parameters: 
2021-08-27 16:53:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382634606923776 [0;39m <==    Updates: 0
2021-08-27 16:53:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382634606923776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:53:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382655624581120 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382655624581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382655624581120 [0;39m ==> Parameters: 
2021-08-27 16:53:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382655624581120 [0;39m <==    Updates: 0
2021-08-27 16:53:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382655624581120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:53:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382676583518208 [0;39m 生成今日电子书快照开始
2021-08-27 16:53:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382676583518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:53:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382676583518208 [0;39m ==> Parameters: 
2021-08-27 16:53:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382676583518208 [0;39m <==    Updates: 0
2021-08-27 16:53:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382676583518208 [0;39m 生成今日电子书快照结束，耗时：5毫秒
2021-08-27 16:54:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382697571815424 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382697571815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382697571815424 [0;39m ==> Parameters: 
2021-08-27 16:54:00.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382697571815424 [0;39m <==    Updates: 0
2021-08-27 16:54:00.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382697571815424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:54:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382718539141120 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382718539141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382718539141120 [0;39m ==> Parameters: 
2021-08-27 16:54:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382718539141120 [0;39m <==    Updates: 0
2021-08-27 16:54:05.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382718539141120 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:54:05.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86382718551724032 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:54:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382718551724032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:54:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382718551724032 [0;39m ==> Parameters: 
2021-08-27 16:54:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382718551724032 [0;39m <==    Updates: 5
2021-08-27 16:54:05.018 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86382718551724032 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:54:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382739519049728 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382739519049728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382739519049728 [0;39m ==> Parameters: 
2021-08-27 16:54:10.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382739519049728 [0;39m <==    Updates: 0
2021-08-27 16:54:10.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382739519049728 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:54:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382760477986816 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382760477986816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382760477986816 [0;39m ==> Parameters: 
2021-08-27 16:54:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382760477986816 [0;39m <==    Updates: 0
2021-08-27 16:54:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382760477986816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:54:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382781420146688 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382781420146688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382781420146688 [0;39m ==> Parameters: 
2021-08-27 16:54:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382781420146688 [0;39m <==    Updates: 0
2021-08-27 16:54:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382781420146688 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:54:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382802429415424 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382802429415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382802429415424 [0;39m ==> Parameters: 
2021-08-27 16:54:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382802429415424 [0;39m <==    Updates: 0
2021-08-27 16:54:25.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382802429415424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:54:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382823358992384 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382823358992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382823358992384 [0;39m ==> Parameters: 
2021-08-27 16:54:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382823358992384 [0;39m <==    Updates: 0
2021-08-27 16:54:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382823358992384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:54:35.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382844376649728 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382844376649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382844376649728 [0;39m ==> Parameters: 
2021-08-27 16:54:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382844376649728 [0;39m <==    Updates: 0
2021-08-27 16:54:35.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382844376649728 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:54:35.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86382844380844032 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:54:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382844380844032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:54:35.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382844380844032 [0;39m ==> Parameters: 
2021-08-27 16:54:35.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382844380844032 [0;39m <==    Updates: 5
2021-08-27 16:54:35.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86382844380844032 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:54:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382865306226688 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382865306226688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382865306226688 [0;39m ==> Parameters: 
2021-08-27 16:54:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382865306226688 [0;39m <==    Updates: 0
2021-08-27 16:54:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382865306226688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:54:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382886290329600 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382886290329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382886290329600 [0;39m ==> Parameters: 
2021-08-27 16:54:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382886290329600 [0;39m <==    Updates: 0
2021-08-27 16:54:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382886290329600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:54:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382907282821120 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382907282821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382907282821120 [0;39m ==> Parameters: 
2021-08-27 16:54:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382907282821120 [0;39m <==    Updates: 0
2021-08-27 16:54:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382907282821120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:54:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382928220786688 [0;39m 生成今日电子书快照开始
2021-08-27 16:54:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382928220786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:54:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382928220786688 [0;39m ==> Parameters: 
2021-08-27 16:54:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382928220786688 [0;39m <==    Updates: 0
2021-08-27 16:54:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382928220786688 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 16:55:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382949200695296 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382949200695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382949200695296 [0;39m ==> Parameters: 
2021-08-27 16:55:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382949200695296 [0;39m <==    Updates: 0
2021-08-27 16:55:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382949200695296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:55:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86382970176409600 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:55:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382970176409600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:55:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382970176409600 [0;39m ==> Parameters: 
2021-08-27 16:55:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86382970176409600 [0;39m <==    Updates: 5
2021-08-27 16:55:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86382970176409600 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:55:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382970184798208 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382970184798208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382970184798208 [0;39m ==> Parameters: 
2021-08-27 16:55:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382970184798208 [0;39m <==    Updates: 0
2021-08-27 16:55:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382970184798208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:55:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86382991177289728 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382991177289728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382991177289728 [0;39m ==> Parameters: 
2021-08-27 16:55:10.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86382991177289728 [0;39m <==    Updates: 0
2021-08-27 16:55:10.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86382991177289728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:55:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383012102672384 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383012102672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383012102672384 [0;39m ==> Parameters: 
2021-08-27 16:55:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383012102672384 [0;39m <==    Updates: 0
2021-08-27 16:55:15.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383012102672384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:55:20.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383033069998080 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383033069998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383033069998080 [0;39m ==> Parameters: 
2021-08-27 16:55:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383033069998080 [0;39m <==    Updates: 0
2021-08-27 16:55:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383033069998080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:55:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383054058295296 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383054058295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383054058295296 [0;39m ==> Parameters: 
2021-08-27 16:55:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383054058295296 [0;39m <==    Updates: 0
2021-08-27 16:55:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383054058295296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:55:26.042 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :42   [32m86381397983498240 [0;39m 连接关闭，token：pRoIVCRXsK，session id：5！当前连接数：0
2021-08-27 16:55:26.750 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :33   [32m86381862188093440 [0;39m 有新连接：token：ARBI71Oolf，session id：6，当前连接数：1
2021-08-27 16:55:26.852 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86383061796786176 [0;39m ------------- 开始 -------------
2021-08-27 16:55:26.853 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86383061796786176 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/1 GET
2021-08-27 16:55:26.853 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86383061796786176 [0;39m 类名方法: com.haoyu.knowlagebase.controller.DocController.all
2021-08-27 16:55:26.853 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86383061796786176 [0;39m 远程地址: 127.0.0.1
2021-08-27 16:55:26.853 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86383061796786176 [0;39m 请求参数: [1]
2021-08-27 16:55:26.854 DEBUG c.h.knowlagebase.mapper.DocMapper.selectByExample :137  [32m86383061796786176 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-08-27 16:55:26.854 DEBUG c.h.knowlagebase.mapper.DocMapper.selectByExample :137  [32m86383061796786176 [0;39m ==> Parameters: 1(Long)
2021-08-27 16:55:26.855 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-08-27 16:55:26.855 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 1, 1, 0, Ant Design Vue, 1, 24, 2
2021-08-27 16:55:26.856 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 2, 0
2021-08-27 16:55:26.856 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 4, 1, 3, 文档2.1, 1, 3, 1
2021-08-27 16:55:26.857 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 6, 1, 5, 文档2.2.1, 1, 2, 1
2021-08-27 16:55:26.857 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 85747953192538112, 1, 2, 8, 1, 1, 1
2021-08-27 16:55:26.857 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 85749087462363136, 1, 2, 9, 1, 1, 1
2021-08-27 16:55:26.858 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 85750049518260224, 1, 2, 10, 1, 1, 1
2021-08-27 16:55:26.858 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 3, 1, 0, 文档2, 2, 1, 0
2021-08-27 16:55:26.858 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 5, 1, 3, 文档2.2, 2, 2, 1
2021-08-27 16:55:26.858 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 85739590006214656, 1, 2, 4444, 4, 1, 1
2021-08-27 16:55:26.858 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 85740865577947136, 1, 2, 6666, 6, 1, 1
2021-08-27 16:55:26.858 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 85746827776888832, 1, 2, 7, 7, 2, 1
2021-08-27 16:55:26.858 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86383061796786176 [0;39m <==        Row: 85740705846267904, 1, 2, 555, 5555, 3, 1
2021-08-27 16:55:26.859 DEBUG c.h.knowlagebase.mapper.DocMapper.selectByExample :137  [32m86383061796786176 [0;39m <==      Total: 13
2021-08-27 16:55:26.860 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86383061796786176 [0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"Ant Design Vue","parent":0,"sort":1,"viewCount":24,"voteCount":2},{"ebookId":1,"id":2,"name":"文档1.1","parent":1,"sort":1,"viewCount":2,"voteCount":0},{"ebookId":1,"id":4,"name":"文档2.1","parent":3,"sort":1,"viewCount":3,"voteCount":1},{"ebookId":1,"id":6,"name":"文档2.2.1","parent":5,"sort":1,"viewCount":2,"voteCount":1},{"ebookId":1,"id":85747953192538112,"name":"8","parent":2,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85749087462363136,"name":"9","parent":2,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85750049518260224,"name":"10","parent":2,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":3,"name":"文档2","parent":0,"sort":2,"viewCount":1,"voteCount":0},{"ebookId":1,"id":5,"name":"文档2.2","parent":3,"sort":2,"viewCount":2,"voteCount":1},{"ebookId":1,"id":85739590006214656,"name":"4444","parent":2,"sort":4,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85740865577947136,"name":"6666","parent":2,"sort":6,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85746827776888832,"name":"7","parent":2,"sort":7,"viewCount":2,"voteCount":1},{"ebookId":1,"id":85740705846267904,"name":"555","parent":2,"sort":5555,"viewCount":3,"voteCount":1}],"success":true}
2021-08-27 16:55:26.860 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86383061796786176 [0;39m ------------- 结束 耗时：8 ms -------------
2021-08-27 16:55:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383075059175424 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383075059175424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383075059175424 [0;39m ==> Parameters: 
2021-08-27 16:55:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383075059175424 [0;39m <==    Updates: 0
2021-08-27 16:55:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383075059175424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:55:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383095984558080 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383095984558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383095984558080 [0;39m ==> Parameters: 
2021-08-27 16:55:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383095984558080 [0;39m <==    Updates: 0
2021-08-27 16:55:35.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383095984558080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:55:35.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86383095988752384 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:55:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383095988752384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:55:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383095988752384 [0;39m ==> Parameters: 
2021-08-27 16:55:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383095988752384 [0;39m <==    Updates: 5
2021-08-27 16:55:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86383095988752384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:55:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383116977049600 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383116977049600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383116977049600 [0;39m ==> Parameters: 
2021-08-27 16:55:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383116977049600 [0;39m <==    Updates: 0
2021-08-27 16:55:40.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383116977049600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:55:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383137977929728 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383137977929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383137977929728 [0;39m ==> Parameters: 
2021-08-27 16:55:45.020 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383137977929728 [0;39m <==    Updates: 0
2021-08-27 16:55:45.021 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383137977929728 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 16:55:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383158932672512 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383158932672512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383158932672512 [0;39m ==> Parameters: 
2021-08-27 16:55:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383158932672512 [0;39m <==    Updates: 0
2021-08-27 16:55:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383158932672512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:55:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383179887415296 [0;39m 生成今日电子书快照开始
2021-08-27 16:55:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383179887415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:55:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383179887415296 [0;39m ==> Parameters: 
2021-08-27 16:55:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383179887415296 [0;39m <==    Updates: 0
2021-08-27 16:55:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383179887415296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:56:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383200871518208 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383200871518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383200871518208 [0;39m ==> Parameters: 
2021-08-27 16:56:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383200871518208 [0;39m <==    Updates: 0
2021-08-27 16:56:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383200871518208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:56:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383221817872384 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383221817872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383221817872384 [0;39m ==> Parameters: 
2021-08-27 16:56:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383221817872384 [0;39m <==    Updates: 0
2021-08-27 16:56:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383221817872384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:56:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86383221826260992 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:56:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383221826260992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:56:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383221826260992 [0;39m ==> Parameters: 
2021-08-27 16:56:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383221826260992 [0;39m <==    Updates: 5
2021-08-27 16:56:05.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86383221826260992 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:56:10.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383242810363904 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383242810363904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383242810363904 [0;39m ==> Parameters: 
2021-08-27 16:56:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383242810363904 [0;39m <==    Updates: 0
2021-08-27 16:56:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383242810363904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:56:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383263773495296 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383263773495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383263773495296 [0;39m ==> Parameters: 
2021-08-27 16:56:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383263773495296 [0;39m <==    Updates: 0
2021-08-27 16:56:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383263773495296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:56:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383284761792512 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383284761792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383284761792512 [0;39m ==> Parameters: 
2021-08-27 16:56:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383284761792512 [0;39m <==    Updates: 0
2021-08-27 16:56:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383284761792512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:56:25.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383305754284032 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383305754284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383305754284032 [0;39m ==> Parameters: 
2021-08-27 16:56:25.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383305754284032 [0;39m <==    Updates: 0
2021-08-27 16:56:25.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383305754284032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:56:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383326704832512 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383326704832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383326704832512 [0;39m ==> Parameters: 
2021-08-27 16:56:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383326704832512 [0;39m <==    Updates: 0
2021-08-27 16:56:30.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383326704832512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:56:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86383347680546816 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:56:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383347680546816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:56:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383347680546816 [0;39m ==> Parameters: 
2021-08-27 16:56:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383347680546816 [0;39m <==    Updates: 5
2021-08-27 16:56:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86383347680546816 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 16:56:35.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383347693129728 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383347693129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383347693129728 [0;39m ==> Parameters: 
2021-08-27 16:56:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383347693129728 [0;39m <==    Updates: 0
2021-08-27 16:56:35.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383347693129728 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:56:40.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383368656261120 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:40.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383368656261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:40.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383368656261120 [0;39m ==> Parameters: 
2021-08-27 16:56:40.021 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383368656261120 [0;39m <==    Updates: 0
2021-08-27 16:56:40.021 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383368656261120 [0;39m 生成今日电子书快照结束，耗时：8毫秒
2021-08-27 16:56:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383389623586816 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383389623586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383389623586816 [0;39m ==> Parameters: 
2021-08-27 16:56:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383389623586816 [0;39m <==    Updates: 0
2021-08-27 16:56:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383389623586816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:56:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383410595106816 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383410595106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383410595106816 [0;39m ==> Parameters: 
2021-08-27 16:56:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383410595106816 [0;39m <==    Updates: 0
2021-08-27 16:56:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383410595106816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:56:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383431528878080 [0;39m 生成今日电子书快照开始
2021-08-27 16:56:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383431528878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:56:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383431528878080 [0;39m ==> Parameters: 
2021-08-27 16:56:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383431528878080 [0;39m <==    Updates: 0
2021-08-27 16:56:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383431528878080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:57:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383452504592384 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383452504592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383452504592384 [0;39m ==> Parameters: 
2021-08-27 16:57:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383452504592384 [0;39m <==    Updates: 0
2021-08-27 16:57:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383452504592384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:57:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383473492889600 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383473492889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383473492889600 [0;39m ==> Parameters: 
2021-08-27 16:57:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383473492889600 [0;39m <==    Updates: 0
2021-08-27 16:57:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383473492889600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:57:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86383473497083904 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:57:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383473497083904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:57:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383473497083904 [0;39m ==> Parameters: 
2021-08-27 16:57:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383473497083904 [0;39m <==    Updates: 5
2021-08-27 16:57:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86383473497083904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:57:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383494489575424 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383494489575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383494489575424 [0;39m ==> Parameters: 
2021-08-27 16:57:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383494489575424 [0;39m <==    Updates: 0
2021-08-27 16:57:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383494489575424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:57:15.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383515406569472 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383515406569472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383515406569472 [0;39m ==> Parameters: 
2021-08-27 16:57:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383515406569472 [0;39m <==    Updates: 0
2021-08-27 16:57:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383515406569472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:57:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383536403255296 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383536403255296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383536403255296 [0;39m ==> Parameters: 
2021-08-27 16:57:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383536403255296 [0;39m <==    Updates: 0
2021-08-27 16:57:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383536403255296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:57:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383557395746816 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383557395746816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383557395746816 [0;39m ==> Parameters: 
2021-08-27 16:57:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383557395746816 [0;39m <==    Updates: 0
2021-08-27 16:57:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383557395746816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:57:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383578346295296 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383578346295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383578346295296 [0;39m ==> Parameters: 
2021-08-27 16:57:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383578346295296 [0;39m <==    Updates: 0
2021-08-27 16:57:30.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383578346295296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:57:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383599317815296 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383599317815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383599317815296 [0;39m ==> Parameters: 
2021-08-27 16:57:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383599317815296 [0;39m <==    Updates: 0
2021-08-27 16:57:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383599317815296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:57:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86383599326203904 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:57:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383599326203904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:57:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383599326203904 [0;39m ==> Parameters: 
2021-08-27 16:57:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383599326203904 [0;39m <==    Updates: 5
2021-08-27 16:57:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86383599326203904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:57:40.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383620314501120 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383620314501120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383620314501120 [0;39m ==> Parameters: 
2021-08-27 16:57:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383620314501120 [0;39m <==    Updates: 0
2021-08-27 16:57:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383620314501120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:57:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383641286021120 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383641286021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383641286021120 [0;39m ==> Parameters: 
2021-08-27 16:57:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383641286021120 [0;39m <==    Updates: 0
2021-08-27 16:57:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383641286021120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:57:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383662257541120 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383662257541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383662257541120 [0;39m ==> Parameters: 
2021-08-27 16:57:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383662257541120 [0;39m <==    Updates: 0
2021-08-27 16:57:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383662257541120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:57:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383683216478208 [0;39m 生成今日电子书快照开始
2021-08-27 16:57:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383683216478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:57:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383683216478208 [0;39m ==> Parameters: 
2021-08-27 16:57:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383683216478208 [0;39m <==    Updates: 0
2021-08-27 16:57:55.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383683216478208 [0;39m 生成今日电子书快照结束，耗时：7毫秒
2021-08-27 16:58:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383704187998208 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383704187998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383704187998208 [0;39m ==> Parameters: 
2021-08-27 16:58:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383704187998208 [0;39m <==    Updates: 0
2021-08-27 16:58:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383704187998208 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:58:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383725167906816 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383725167906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383725167906816 [0;39m ==> Parameters: 
2021-08-27 16:58:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383725167906816 [0;39m <==    Updates: 0
2021-08-27 16:58:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383725167906816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:58:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86383725176295424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:58:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383725176295424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:58:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383725176295424 [0;39m ==> Parameters: 
2021-08-27 16:58:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383725176295424 [0;39m <==    Updates: 5
2021-08-27 16:58:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86383725176295424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:58:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383746105872384 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383746105872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383746105872384 [0;39m ==> Parameters: 
2021-08-27 16:58:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383746105872384 [0;39m <==    Updates: 0
2021-08-27 16:58:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383746105872384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:58:15.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383767081586688 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383767081586688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383767081586688 [0;39m ==> Parameters: 
2021-08-27 16:58:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383767081586688 [0;39m <==    Updates: 0
2021-08-27 16:58:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383767081586688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:58:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383788053106688 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383788053106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383788053106688 [0;39m ==> Parameters: 
2021-08-27 16:58:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383788053106688 [0;39m <==    Updates: 0
2021-08-27 16:58:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383788053106688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:58:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383809033015296 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383809033015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383809033015296 [0;39m ==> Parameters: 
2021-08-27 16:58:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383809033015296 [0;39m <==    Updates: 0
2021-08-27 16:58:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383809033015296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:58:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383829983563776 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383829983563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383829983563776 [0;39m ==> Parameters: 
2021-08-27 16:58:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383829983563776 [0;39m <==    Updates: 0
2021-08-27 16:58:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383829983563776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:58:35.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383851013804032 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383851013804032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383851013804032 [0;39m ==> Parameters: 
2021-08-27 16:58:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383851013804032 [0;39m <==    Updates: 0
2021-08-27 16:58:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383851013804032 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:58:35.018 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86383851022192640 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:58:35.018 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383851022192640 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:58:35.018 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383851022192640 [0;39m ==> Parameters: 
2021-08-27 16:58:35.018 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383851022192640 [0;39m <==    Updates: 5
2021-08-27 16:58:35.019 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86383851022192640 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:58:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383871939186688 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383871939186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383871939186688 [0;39m ==> Parameters: 
2021-08-27 16:58:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383871939186688 [0;39m <==    Updates: 0
2021-08-27 16:58:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383871939186688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:58:45.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383892889735168 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:45.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383892889735168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383892889735168 [0;39m ==> Parameters: 
2021-08-27 16:58:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383892889735168 [0;39m <==    Updates: 0
2021-08-27 16:58:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383892889735168 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 16:58:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383913903198208 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383913903198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383913903198208 [0;39m ==> Parameters: 
2021-08-27 16:58:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383913903198208 [0;39m <==    Updates: 0
2021-08-27 16:58:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383913903198208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:58:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383934862135296 [0;39m 生成今日电子书快照开始
2021-08-27 16:58:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383934862135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:58:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383934862135296 [0;39m ==> Parameters: 
2021-08-27 16:58:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383934862135296 [0;39m <==    Updates: 0
2021-08-27 16:58:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383934862135296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:59:00.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383955816878080 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383955816878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383955816878080 [0;39m ==> Parameters: 
2021-08-27 16:59:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383955816878080 [0;39m <==    Updates: 0
2021-08-27 16:59:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383955816878080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 16:59:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86383976796786688 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:59:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383976796786688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:59:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383976796786688 [0;39m ==> Parameters: 
2021-08-27 16:59:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86383976796786688 [0;39m <==    Updates: 5
2021-08-27 16:59:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86383976796786688 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 16:59:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383976805175296 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383976805175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383976805175296 [0;39m ==> Parameters: 
2021-08-27 16:59:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383976805175296 [0;39m <==    Updates: 0
2021-08-27 16:59:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383976805175296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:59:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86383997772500992 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383997772500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383997772500992 [0;39m ==> Parameters: 
2021-08-27 16:59:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86383997772500992 [0;39m <==    Updates: 0
2021-08-27 16:59:10.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86383997772500992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:59:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384018764992512 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384018764992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384018764992512 [0;39m ==> Parameters: 
2021-08-27 16:59:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384018764992512 [0;39m <==    Updates: 0
2021-08-27 16:59:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384018764992512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:59:20.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384039702958080 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384039702958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384039702958080 [0;39m ==> Parameters: 
2021-08-27 16:59:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384039702958080 [0;39m <==    Updates: 0
2021-08-27 16:59:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384039702958080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:59:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384060695449600 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384060695449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384060695449600 [0;39m ==> Parameters: 
2021-08-27 16:59:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384060695449600 [0;39m <==    Updates: 0
2021-08-27 16:59:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384060695449600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:59:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384081641803776 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384081641803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384081641803776 [0;39m ==> Parameters: 
2021-08-27 16:59:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384081641803776 [0;39m <==    Updates: 0
2021-08-27 16:59:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384081641803776 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 16:59:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384102659461120 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384102659461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384102659461120 [0;39m ==> Parameters: 
2021-08-27 16:59:35.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384102659461120 [0;39m <==    Updates: 0
2021-08-27 16:59:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384102659461120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:59:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86384102663655424 [0;39m 更新电子书下的文档数据开始
2021-08-27 16:59:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384102663655424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 16:59:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384102663655424 [0;39m ==> Parameters: 
2021-08-27 16:59:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384102663655424 [0;39m <==    Updates: 5
2021-08-27 16:59:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86384102663655424 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 16:59:40.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384123584843776 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384123584843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384123584843776 [0;39m ==> Parameters: 
2021-08-27 16:59:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384123584843776 [0;39m <==    Updates: 0
2021-08-27 16:59:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384123584843776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 16:59:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384144606695424 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384144606695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384144606695424 [0;39m ==> Parameters: 
2021-08-27 16:59:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384144606695424 [0;39m <==    Updates: 0
2021-08-27 16:59:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384144606695424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:59:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384165569826816 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384165569826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384165569826816 [0;39m ==> Parameters: 
2021-08-27 16:59:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384165569826816 [0;39m <==    Updates: 0
2021-08-27 16:59:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384165569826816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 16:59:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384186503598080 [0;39m 生成今日电子书快照开始
2021-08-27 16:59:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384186503598080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 16:59:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384186503598080 [0;39m ==> Parameters: 
2021-08-27 16:59:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384186503598080 [0;39m <==    Updates: 0
2021-08-27 16:59:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384186503598080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:00:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384207508672512 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384207508672512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384207508672512 [0;39m ==> Parameters: 
2021-08-27 17:00:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384207508672512 [0;39m <==    Updates: 0
2021-08-27 17:00:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384207508672512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:00:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384228492775424 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384228492775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384228492775424 [0;39m ==> Parameters: 
2021-08-27 17:00:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384228492775424 [0;39m <==    Updates: 0
2021-08-27 17:00:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384228492775424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:00:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86384228496969728 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:00:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384228496969728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:00:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384228496969728 [0;39m ==> Parameters: 
2021-08-27 17:00:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384228496969728 [0;39m <==    Updates: 5
2021-08-27 17:00:05.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86384228496969728 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:00:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384249418158080 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384249418158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384249418158080 [0;39m ==> Parameters: 
2021-08-27 17:00:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384249418158080 [0;39m <==    Updates: 0
2021-08-27 17:00:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384249418158080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:00:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384270406455296 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384270406455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384270406455296 [0;39m ==> Parameters: 
2021-08-27 17:00:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384270406455296 [0;39m <==    Updates: 0
2021-08-27 17:00:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384270406455296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:00:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384291373780992 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384291373780992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384291373780992 [0;39m ==> Parameters: 
2021-08-27 17:00:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384291373780992 [0;39m <==    Updates: 0
2021-08-27 17:00:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384291373780992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:00:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384312341106688 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384312341106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384312341106688 [0;39m ==> Parameters: 
2021-08-27 17:00:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384312341106688 [0;39m <==    Updates: 0
2021-08-27 17:00:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384312341106688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:00:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384333333598208 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384333333598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384333333598208 [0;39m ==> Parameters: 
2021-08-27 17:00:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384333333598208 [0;39m <==    Updates: 0
2021-08-27 17:00:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384333333598208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:00:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384354300923904 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384354300923904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384354300923904 [0;39m ==> Parameters: 
2021-08-27 17:00:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384354300923904 [0;39m <==    Updates: 0
2021-08-27 17:00:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384354300923904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:00:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86384354309312512 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:00:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384354309312512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:00:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384354309312512 [0;39m ==> Parameters: 
2021-08-27 17:00:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384354309312512 [0;39m <==    Updates: 5
2021-08-27 17:00:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86384354309312512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:00:40.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384375289221120 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384375289221120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384375289221120 [0;39m ==> Parameters: 
2021-08-27 17:00:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384375289221120 [0;39m <==    Updates: 0
2021-08-27 17:00:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384375289221120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:00:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384396222992384 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384396222992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384396222992384 [0;39m ==> Parameters: 
2021-08-27 17:00:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384396222992384 [0;39m <==    Updates: 0
2021-08-27 17:00:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384396222992384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:00:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384417236455424 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384417236455424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384417236455424 [0;39m ==> Parameters: 
2021-08-27 17:00:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384417236455424 [0;39m <==    Updates: 0
2021-08-27 17:00:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384417236455424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:00:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384438161838080 [0;39m 生成今日电子书快照开始
2021-08-27 17:00:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384438161838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:00:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384438161838080 [0;39m ==> Parameters: 
2021-08-27 17:00:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384438161838080 [0;39m <==    Updates: 0
2021-08-27 17:00:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384438161838080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:01:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384459141746688 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384459141746688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384459141746688 [0;39m ==> Parameters: 
2021-08-27 17:01:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384459141746688 [0;39m <==    Updates: 0
2021-08-27 17:01:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384459141746688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:01:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384480142626816 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384480142626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384480142626816 [0;39m ==> Parameters: 
2021-08-27 17:01:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384480142626816 [0;39m <==    Updates: 0
2021-08-27 17:01:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384480142626816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:01:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86384480146821120 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:01:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384480146821120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:01:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384480146821120 [0;39m ==> Parameters: 
2021-08-27 17:01:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384480146821120 [0;39m <==    Updates: 5
2021-08-27 17:01:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86384480146821120 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:01:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384501114146816 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384501114146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384501114146816 [0;39m ==> Parameters: 
2021-08-27 17:01:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384501114146816 [0;39m <==    Updates: 0
2021-08-27 17:01:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384501114146816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:01:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384522081472512 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384522081472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384522081472512 [0;39m ==> Parameters: 
2021-08-27 17:01:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384522081472512 [0;39m <==    Updates: 0
2021-08-27 17:01:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384522081472512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:01:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384543023632384 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384543023632384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384543023632384 [0;39m ==> Parameters: 
2021-08-27 17:01:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384543023632384 [0;39m <==    Updates: 0
2021-08-27 17:01:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384543023632384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:01:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384563999346688 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384563999346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384563999346688 [0;39m ==> Parameters: 
2021-08-27 17:01:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384563999346688 [0;39m <==    Updates: 0
2021-08-27 17:01:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384563999346688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:01:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384584975060992 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384584975060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384584975060992 [0;39m ==> Parameters: 
2021-08-27 17:01:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384584975060992 [0;39m <==    Updates: 0
2021-08-27 17:01:30.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384584975060992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:01:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384605980135424 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:35.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384605980135424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384605980135424 [0;39m ==> Parameters: 
2021-08-27 17:01:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384605980135424 [0;39m <==    Updates: 0
2021-08-27 17:01:35.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384605980135424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:01:35.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86384605988524032 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:01:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384605988524032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:01:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384605988524032 [0;39m ==> Parameters: 
2021-08-27 17:01:35.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384605988524032 [0;39m <==    Updates: 5
2021-08-27 17:01:35.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86384605988524032 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:01:40.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384626901323776 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:40.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384626901323776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:40.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384626901323776 [0;39m ==> Parameters: 
2021-08-27 17:01:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384626901323776 [0;39m <==    Updates: 0
2021-08-27 17:01:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384626901323776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:01:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384647889620992 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384647889620992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384647889620992 [0;39m ==> Parameters: 
2021-08-27 17:01:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384647889620992 [0;39m <==    Updates: 0
2021-08-27 17:01:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384647889620992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:01:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384668852752384 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384668852752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384668852752384 [0;39m ==> Parameters: 
2021-08-27 17:01:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384668852752384 [0;39m <==    Updates: 0
2021-08-27 17:01:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384668852752384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:01:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384689862021120 [0;39m 生成今日电子书快照开始
2021-08-27 17:01:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384689862021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:01:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384689862021120 [0;39m ==> Parameters: 
2021-08-27 17:01:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384689862021120 [0;39m <==    Updates: 0
2021-08-27 17:01:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384689862021120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384710820958208 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384710820958208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384710820958208 [0;39m ==> Parameters: 
2021-08-27 17:02:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384710820958208 [0;39m <==    Updates: 0
2021-08-27 17:02:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384710820958208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86384731784089600 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:02:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384731784089600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:02:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384731784089600 [0;39m ==> Parameters: 
2021-08-27 17:02:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384731784089600 [0;39m <==    Updates: 5
2021-08-27 17:02:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86384731784089600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:02:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384731788283904 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384731788283904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384731788283904 [0;39m ==> Parameters: 
2021-08-27 17:02:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384731788283904 [0;39m <==    Updates: 0
2021-08-27 17:02:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384731788283904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:02:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384752738832384 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384752738832384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384752738832384 [0;39m ==> Parameters: 
2021-08-27 17:02:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384752738832384 [0;39m <==    Updates: 0
2021-08-27 17:02:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384752738832384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:15.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384773748101120 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384773748101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384773748101120 [0;39m ==> Parameters: 
2021-08-27 17:02:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384773748101120 [0;39m <==    Updates: 0
2021-08-27 17:02:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384773748101120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:20.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384794732204032 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384794732204032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384794732204032 [0;39m ==> Parameters: 
2021-08-27 17:02:20.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384794732204032 [0;39m <==    Updates: 0
2021-08-27 17:02:20.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384794732204032 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:02:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384815678558208 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384815678558208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384815678558208 [0;39m ==> Parameters: 
2021-08-27 17:02:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384815678558208 [0;39m <==    Updates: 0
2021-08-27 17:02:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384815678558208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384836666855424 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384836666855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384836666855424 [0;39m ==> Parameters: 
2021-08-27 17:02:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384836666855424 [0;39m <==    Updates: 0
2021-08-27 17:02:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384836666855424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384857609015296 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384857609015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384857609015296 [0;39m ==> Parameters: 
2021-08-27 17:02:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384857609015296 [0;39m <==    Updates: 0
2021-08-27 17:02:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384857609015296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86384857617403904 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:02:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384857617403904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:02:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384857617403904 [0;39m ==> Parameters: 
2021-08-27 17:02:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384857617403904 [0;39m <==    Updates: 5
2021-08-27 17:02:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86384857617403904 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 17:02:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384878576340992 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384878576340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384878576340992 [0;39m ==> Parameters: 
2021-08-27 17:02:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384878576340992 [0;39m <==    Updates: 0
2021-08-27 17:02:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384878576340992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384899547860992 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384899547860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384899547860992 [0;39m ==> Parameters: 
2021-08-27 17:02:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384899547860992 [0;39m <==    Updates: 0
2021-08-27 17:02:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384899547860992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384920540352512 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384920540352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384920540352512 [0;39m ==> Parameters: 
2021-08-27 17:02:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384920540352512 [0;39m <==    Updates: 0
2021-08-27 17:02:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384920540352512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:02:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384941478318080 [0;39m 生成今日电子书快照开始
2021-08-27 17:02:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384941478318080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:02:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384941478318080 [0;39m ==> Parameters: 
2021-08-27 17:02:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384941478318080 [0;39m <==    Updates: 0
2021-08-27 17:02:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384941478318080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:03:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384962454032384 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384962454032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384962454032384 [0;39m ==> Parameters: 
2021-08-27 17:03:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384962454032384 [0;39m <==    Updates: 0
2021-08-27 17:03:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384962454032384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:03:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86384983454912512 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384983454912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384983454912512 [0;39m ==> Parameters: 
2021-08-27 17:03:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86384983454912512 [0;39m <==    Updates: 0
2021-08-27 17:03:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86384983454912512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:03:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86384983463301120 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:03:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384983463301120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:03:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384983463301120 [0;39m ==> Parameters: 
2021-08-27 17:03:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86384983463301120 [0;39m <==    Updates: 5
2021-08-27 17:03:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86384983463301120 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:03:10.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385004413849600 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385004413849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385004413849600 [0;39m ==> Parameters: 
2021-08-27 17:03:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385004413849600 [0;39m <==    Updates: 0
2021-08-27 17:03:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385004413849600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:03:15.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385025393758208 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385025393758208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385025393758208 [0;39m ==> Parameters: 
2021-08-27 17:03:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385025393758208 [0;39m <==    Updates: 0
2021-08-27 17:03:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385025393758208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:03:20.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385046331723776 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385046331723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385046331723776 [0;39m ==> Parameters: 
2021-08-27 17:03:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385046331723776 [0;39m <==    Updates: 0
2021-08-27 17:03:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385046331723776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:03:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385067315826688 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385067315826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385067315826688 [0;39m ==> Parameters: 
2021-08-27 17:03:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385067315826688 [0;39m <==    Updates: 0
2021-08-27 17:03:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385067315826688 [0;39m 生成今日电子书快照结束，耗时：5毫秒
2021-08-27 17:03:30.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385088333484032 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385088333484032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385088333484032 [0;39m ==> Parameters: 
2021-08-27 17:03:30.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385088333484032 [0;39m <==    Updates: 0
2021-08-27 17:03:30.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385088333484032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:03:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385109250478080 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385109250478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385109250478080 [0;39m ==> Parameters: 
2021-08-27 17:03:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385109250478080 [0;39m <==    Updates: 0
2021-08-27 17:03:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385109250478080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:03:35.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86385109263060992 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:03:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385109263060992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:03:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385109263060992 [0;39m ==> Parameters: 
2021-08-27 17:03:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385109263060992 [0;39m <==    Updates: 5
2021-08-27 17:03:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86385109263060992 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:03:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385130221998080 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385130221998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385130221998080 [0;39m ==> Parameters: 
2021-08-27 17:03:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385130221998080 [0;39m <==    Updates: 0
2021-08-27 17:03:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385130221998080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:03:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385151218683904 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385151218683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385151218683904 [0;39m ==> Parameters: 
2021-08-27 17:03:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385151218683904 [0;39m <==    Updates: 0
2021-08-27 17:03:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385151218683904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:03:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385172198592512 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385172198592512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385172198592512 [0;39m ==> Parameters: 
2021-08-27 17:03:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385172198592512 [0;39m <==    Updates: 0
2021-08-27 17:03:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385172198592512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:03:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385193174306816 [0;39m 生成今日电子书快照开始
2021-08-27 17:03:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385193174306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:03:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385193174306816 [0;39m ==> Parameters: 
2021-08-27 17:03:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385193174306816 [0;39m <==    Updates: 0
2021-08-27 17:03:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385193174306816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:04:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385214124855296 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385214124855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385214124855296 [0;39m ==> Parameters: 
2021-08-27 17:04:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385214124855296 [0;39m <==    Updates: 0
2021-08-27 17:04:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385214124855296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:04:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86385235092180992 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:04:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385235092180992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:04:05.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385235092180992 [0;39m ==> Parameters: 
2021-08-27 17:04:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385235092180992 [0;39m <==    Updates: 5
2021-08-27 17:04:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86385235092180992 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 17:04:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385235100569600 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385235100569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385235100569600 [0;39m ==> Parameters: 
2021-08-27 17:04:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385235100569600 [0;39m <==    Updates: 0
2021-08-27 17:04:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385235100569600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:04:10.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385256105644032 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:10.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385256105644032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:10.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385256105644032 [0;39m ==> Parameters: 
2021-08-27 17:04:10.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385256105644032 [0;39m <==    Updates: 0
2021-08-27 17:04:10.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385256105644032 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:04:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385277060386816 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385277060386816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385277060386816 [0;39m ==> Parameters: 
2021-08-27 17:04:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385277060386816 [0;39m <==    Updates: 0
2021-08-27 17:04:15.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385277060386816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:04:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385298027712512 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385298027712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385298027712512 [0;39m ==> Parameters: 
2021-08-27 17:04:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385298027712512 [0;39m <==    Updates: 0
2021-08-27 17:04:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385298027712512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:04:25.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385318961483776 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385318961483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385318961483776 [0;39m ==> Parameters: 
2021-08-27 17:04:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385318961483776 [0;39m <==    Updates: 0
2021-08-27 17:04:25.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385318961483776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:04:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385339941392384 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385339941392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385339941392384 [0;39m ==> Parameters: 
2021-08-27 17:04:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385339941392384 [0;39m <==    Updates: 0
2021-08-27 17:04:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385339941392384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:04:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385360942272512 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385360942272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385360942272512 [0;39m ==> Parameters: 
2021-08-27 17:04:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385360942272512 [0;39m <==    Updates: 0
2021-08-27 17:04:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385360942272512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:04:35.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86385360950661120 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:04:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385360950661120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:04:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385360950661120 [0;39m ==> Parameters: 
2021-08-27 17:04:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385360950661120 [0;39m <==    Updates: 5
2021-08-27 17:04:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86385360950661120 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:04:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385381926375424 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385381926375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385381926375424 [0;39m ==> Parameters: 
2021-08-27 17:04:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385381926375424 [0;39m <==    Updates: 0
2021-08-27 17:04:40.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385381926375424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:04:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385402902089728 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385402902089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385402902089728 [0;39m ==> Parameters: 
2021-08-27 17:04:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385402902089728 [0;39m <==    Updates: 0
2021-08-27 17:04:45.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385402902089728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:04:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385423856832512 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385423856832512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385423856832512 [0;39m ==> Parameters: 
2021-08-27 17:04:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385423856832512 [0;39m <==    Updates: 0
2021-08-27 17:04:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385423856832512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:04:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385444794798080 [0;39m 生成今日电子书快照开始
2021-08-27 17:04:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385444794798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:04:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385444794798080 [0;39m ==> Parameters: 
2021-08-27 17:04:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385444794798080 [0;39m <==    Updates: 0
2021-08-27 17:04:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385444794798080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385465795678208 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385465795678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385465795678208 [0;39m ==> Parameters: 
2021-08-27 17:05:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385465795678208 [0;39m <==    Updates: 0
2021-08-27 17:05:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385465795678208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:05.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86385486737838080 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:05:05.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385486737838080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:05:05.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385486737838080 [0;39m ==> Parameters: 
2021-08-27 17:05:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385486737838080 [0;39m <==    Updates: 5
2021-08-27 17:05:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86385486737838080 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:05:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385486742032384 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385486742032384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385486742032384 [0;39m ==> Parameters: 
2021-08-27 17:05:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385486742032384 [0;39m <==    Updates: 0
2021-08-27 17:05:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385486742032384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385507751301120 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385507751301120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385507751301120 [0;39m ==> Parameters: 
2021-08-27 17:05:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385507751301120 [0;39m <==    Updates: 0
2021-08-27 17:05:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385507751301120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:05:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385528685072384 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385528685072384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385528685072384 [0;39m ==> Parameters: 
2021-08-27 17:05:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385528685072384 [0;39m <==    Updates: 0
2021-08-27 17:05:15.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385528685072384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:20.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385549648203776 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:20.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385549648203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:20.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385549648203776 [0;39m ==> Parameters: 
2021-08-27 17:05:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385549648203776 [0;39m <==    Updates: 0
2021-08-27 17:05:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385549648203776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385570623918080 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385570623918080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385570623918080 [0;39m ==> Parameters: 
2021-08-27 17:05:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385570623918080 [0;39m <==    Updates: 0
2021-08-27 17:05:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385570623918080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385591628992512 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385591628992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385591628992512 [0;39m ==> Parameters: 
2021-08-27 17:05:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385591628992512 [0;39m <==    Updates: 0
2021-08-27 17:05:30.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385591628992512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385612575346688 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385612575346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385612575346688 [0;39m ==> Parameters: 
2021-08-27 17:05:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385612575346688 [0;39m <==    Updates: 0
2021-08-27 17:05:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385612575346688 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:05:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86385612583735296 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:05:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385612583735296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:05:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385612583735296 [0;39m ==> Parameters: 
2021-08-27 17:05:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385612583735296 [0;39m <==    Updates: 5
2021-08-27 17:05:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86385612583735296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:05:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385633538478080 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385633538478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385633538478080 [0;39m ==> Parameters: 
2021-08-27 17:05:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385633538478080 [0;39m <==    Updates: 0
2021-08-27 17:05:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385633538478080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385654518386688 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385654518386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385654518386688 [0;39m ==> Parameters: 
2021-08-27 17:05:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385654518386688 [0;39m <==    Updates: 0
2021-08-27 17:05:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385654518386688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385675527655424 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385675527655424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385675527655424 [0;39m ==> Parameters: 
2021-08-27 17:05:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385675527655424 [0;39m <==    Updates: 0
2021-08-27 17:05:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385675527655424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:05:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385696469815296 [0;39m 生成今日电子书快照开始
2021-08-27 17:05:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385696469815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:05:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385696469815296 [0;39m ==> Parameters: 
2021-08-27 17:05:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385696469815296 [0;39m <==    Updates: 0
2021-08-27 17:05:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385696469815296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:06:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385717428752384 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385717428752384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385717428752384 [0;39m ==> Parameters: 
2021-08-27 17:06:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385717428752384 [0;39m <==    Updates: 0
2021-08-27 17:06:00.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385717428752384 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:06:05.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385738391883776 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385738391883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385738391883776 [0;39m ==> Parameters: 
2021-08-27 17:06:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385738391883776 [0;39m <==    Updates: 0
2021-08-27 17:06:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385738391883776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:06:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86385738400272384 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:06:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385738400272384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:06:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385738400272384 [0;39m ==> Parameters: 
2021-08-27 17:06:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385738400272384 [0;39m <==    Updates: 5
2021-08-27 17:06:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86385738400272384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:06:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385759401152512 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385759401152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385759401152512 [0;39m ==> Parameters: 
2021-08-27 17:06:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385759401152512 [0;39m <==    Updates: 0
2021-08-27 17:06:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385759401152512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:06:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385780339118080 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385780339118080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385780339118080 [0;39m ==> Parameters: 
2021-08-27 17:06:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385780339118080 [0;39m <==    Updates: 0
2021-08-27 17:06:15.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385780339118080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:06:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385801335803904 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385801335803904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385801335803904 [0;39m ==> Parameters: 
2021-08-27 17:06:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385801335803904 [0;39m <==    Updates: 0
2021-08-27 17:06:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385801335803904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:06:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385822311518208 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385822311518208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385822311518208 [0;39m ==> Parameters: 
2021-08-27 17:06:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385822311518208 [0;39m <==    Updates: 0
2021-08-27 17:06:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385822311518208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:06:30.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385843274649600 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385843274649600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385843274649600 [0;39m ==> Parameters: 
2021-08-27 17:06:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385843274649600 [0;39m <==    Updates: 0
2021-08-27 17:06:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385843274649600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:06:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385864225198080 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385864225198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385864225198080 [0;39m ==> Parameters: 
2021-08-27 17:06:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385864225198080 [0;39m <==    Updates: 0
2021-08-27 17:06:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385864225198080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:06:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86385864233586688 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:06:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385864233586688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:06:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385864233586688 [0;39m ==> Parameters: 
2021-08-27 17:06:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385864233586688 [0;39m <==    Updates: 5
2021-08-27 17:06:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86385864233586688 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 17:06:40.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385885238661120 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385885238661120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385885238661120 [0;39m ==> Parameters: 
2021-08-27 17:06:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385885238661120 [0;39m <==    Updates: 0
2021-08-27 17:06:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385885238661120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:06:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385906172432384 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385906172432384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385906172432384 [0;39m ==> Parameters: 
2021-08-27 17:06:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385906172432384 [0;39m <==    Updates: 0
2021-08-27 17:06:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385906172432384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:06:47.398 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86385916213596160 [0;39m ------------- 开始 -------------
2021-08-27 17:06:47.398 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86385916213596160 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 17:06:47.398 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86385916213596160 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 17:06:47.399 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86385916213596160 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:06:47.399 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86385916213596160 [0;39m 请求参数: []
2021-08-27 17:06:47.399 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86385916213596160 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 17:06:47.399 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86385916213596160 [0;39m ==> Parameters: 
2021-08-27 17:06:47.400 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 17:06:47.400 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 17:06:47.400 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 17:06:47.401 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 17:06:47.401 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 17:06:47.401 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 17:06:47.401 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 17:06:47.401 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 17:06:47.401 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 17:06:47.402 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 17:06:47.402 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 17:06:47.402 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 17:06:47.402 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 17:06:47.402 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 17:06:47.402 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 17:06:47.402 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 17:06:47.403 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385916213596160 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 17:06:47.403 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86385916213596160 [0;39m <==      Total: 16
2021-08-27 17:06:47.403 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86385916213596160 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 17:06:47.403 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86385916213596160 [0;39m ------------- 结束 耗时：5 ms -------------
2021-08-27 17:06:48.177 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86385919480958976 [0;39m ------------- 开始 -------------
2021-08-27 17:06:48.177 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86385919480958976 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 17:06:48.177 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86385919480958976 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 17:06:48.177 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86385919480958976 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:06:48.178 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86385919480958976 [0;39m 请求参数: []
2021-08-27 17:06:48.178 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86385919480958976 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 17:06:48.178 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86385919480958976 [0;39m ==> Parameters: 
2021-08-27 17:06:48.179 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 17:06:48.179 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 17:06:48.179 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 17:06:48.179 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 17:06:48.179 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 17:06:48.179 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 17:06:48.179 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 17:06:48.179 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 17:06:48.180 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 17:06:48.180 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 17:06:48.180 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 17:06:48.180 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 17:06:48.180 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 17:06:48.180 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 17:06:48.180 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 17:06:48.181 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 17:06:48.181 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385919480958976 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 17:06:48.181 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86385919480958976 [0;39m <==      Total: 16
2021-08-27 17:06:48.181 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86385919480958976 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 17:06:48.181 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86385919480958976 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 17:06:48.221 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86385919665508352 [0;39m ------------- 开始 -------------
2021-08-27 17:06:48.222 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86385919665508352 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 17:06:48.222 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86385919665508352 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 17:06:48.222 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86385919665508352 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:06:48.222 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86385919665508352 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 17:06:48.223 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86385919665508352 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-08-27 17:06:48.224 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86385919665508352 [0;39m ==> Parameters: 
2021-08-27 17:06:48.225 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86385919665508352 [0;39m <==    Columns: count(0)
2021-08-27 17:06:48.225 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86385919665508352 [0;39m <==        Row: 7
2021-08-27 17:06:48.225 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86385919665508352 [0;39m <==      Total: 1
2021-08-27 17:06:48.225 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86385919665508352 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-08-27 17:06:48.226 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86385919665508352 [0;39m ==> Parameters: 10(Integer)
2021-08-27 17:06:48.226 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86385919665508352 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 17:06:48.226 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86385919665508352 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 17:06:48.226 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86385919665508352 [0;39m <==        Row: 2, Vue 入门教程, 100, 101, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover1.png, 0, 0, 0
2021-08-27 17:06:48.227 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86385919665508352 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 17:06:48.227 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86385919665508352 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 17:06:48.227 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86385919665508352 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 17:06:48.227 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86385919665508352 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 17:06:48.227 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86385919665508352 [0;39m <==        Row: 85670061133664256, 111, 100, 82110017238601728, 111, 111, 3, 3, 3
2021-08-27 17:06:48.227 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86385919665508352 [0;39m <==      Total: 7
2021-08-27 17:06:48.228 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86385919665508352 [0;39m 总行数:7
2021-08-27 17:06:48.228 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86385919665508352 [0;39m 总页数:1
2021-08-27 17:06:48.228 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86385919665508352 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3},{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1},{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":82110017238601728,"cover":"111","description":"111","docCount":3,"id":85670061133664256,"name":"111","viewCount":3,"voteCount":3}],"total":7},"success":true}
2021-08-27 17:06:48.228 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86385919665508352 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 17:06:48.676 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m86381386017148928 [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 17:06:48.676 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m86381386017148928 [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2021-08-27 17:06:48.677 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m86381978332565504 [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 17:06:48.677 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :43   [32m86381978332565504 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/user/list
2021-08-27 17:06:48.678 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :47   [32m86381978332565504 [0;39m 登录校验开始，token：86381451326656512
2021-08-27 17:06:48.679 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :59   [32m86381978332565504 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"86381451326656512"}
2021-08-27 17:06:48.679 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86385921586499584 [0;39m ------------- 开始 -------------
2021-08-27 17:06:48.680 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86385921586499584 [0;39m 请求地址: http://127.0.0.1:8880/user/list GET
2021-08-27 17:06:48.680 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86385921586499584 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.list
2021-08-27 17:06:48.680 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86385921586499584 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:06:48.680 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86385921586499584 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 17:06:48.681 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86385921586499584 [0;39m ==>  Preparing: SELECT count(0) FROM user
2021-08-27 17:06:48.681 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86385921586499584 [0;39m ==> Parameters: 
2021-08-27 17:06:48.681 TRACE c.h.k.mapper.UserMapper.selectByExample_COUNT     :143  [32m86385921586499584 [0;39m <==    Columns: count(0)
2021-08-27 17:06:48.682 TRACE c.h.k.mapper.UserMapper.selectByExample_COUNT     :143  [32m86385921586499584 [0;39m <==        Row: 2
2021-08-27 17:06:48.682 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86385921586499584 [0;39m <==      Total: 1
2021-08-27 17:06:48.682 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86385921586499584 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-08-27 17:06:48.682 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86385921586499584 [0;39m ==> Parameters: 10(Integer)
2021-08-27 17:06:48.683 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86385921586499584 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 17:06:48.683 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86385921586499584 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 17:06:48.683 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86385921586499584 [0;39m <==        Row: 84603304096698368, 11111, 111111, b9207c7ae418edcbdef11219daae3474
2021-08-27 17:06:48.683 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86385921586499584 [0;39m <==      Total: 2
2021-08-27 17:06:48.683 INFO  com.haoyu.knowlagebase.service.UserService        :52   [32m86385921586499584 [0;39m 总行数:2
2021-08-27 17:06:48.683 INFO  com.haoyu.knowlagebase.service.UserService        :53   [32m86385921586499584 [0;39m 总页数:1
2021-08-27 17:06:48.683 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86385921586499584 [0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":84603304096698368,"loginName":"11111","name":"111111"}],"total":2},"success":true}
2021-08-27 17:06:48.683 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86385921586499584 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 17:06:48.684 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m86385921586499584 [0;39m ------------- LoginInterceptor 结束 耗时：7 ms -------------
2021-08-27 17:06:49.084 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86385923285192704 [0;39m ------------- 开始 -------------
2021-08-27 17:06:49.084 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86385923285192704 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 17:06:49.084 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86385923285192704 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 17:06:49.084 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86385923285192704 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86385923285192704 [0;39m 请求参数: []
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86385923289387008 [0;39m ------------- 开始 -------------
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86385923289387009 [0;39m ------------- 开始 -------------
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86385923289387008 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86385923289387009 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86385923289387008 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 17:06:49.085 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86385923285192704 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86385923289387009 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86385923289387008 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86385923289387009 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:06:49.085 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86385923285192704 [0;39m ==> Parameters: 
2021-08-27 17:06:49.085 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86385923289387008 [0;39m 请求参数: []
2021-08-27 17:06:49.086 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86385923289387009 [0;39m 请求参数: []
2021-08-27 17:06:49.086 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86385923289387008 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 17:06:49.087 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86385923289387008 [0;39m ==> Parameters: 
2021-08-27 17:06:49.087 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86385923289387009 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 17:06:49.087 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 17:06:49.087 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86385923289387009 [0;39m ==> Parameters: 
2021-08-27 17:06:49.087 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 17:06:49.087 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 17:06:49.088 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86385923289387008 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 17:06:49.088 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 17:06:49.088 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 17:06:49.088 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86385923289387008 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 17:06:49.088 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 17:06:49.088 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86385923289387008 [0;39m <==      Total: 1
2021-08-27 17:06:49.088 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86385923289387009 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 17:06:49.088 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 17:06:49.088 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 17:06:49.088 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86385923289387008 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 17:06:49.088 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86385923289387009 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 17:06:49.089 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86385923289387008 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 17:06:49.089 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 17:06:49.089 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 17:06:49.089 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86385923289387009 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 17:06:49.089 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 17:06:49.089 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86385923289387009 [0;39m <==      Total: 2
2021-08-27 17:06:49.089 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 17:06:49.089 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86385923289387009 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 17:06:49.089 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 17:06:49.089 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86385923289387009 [0;39m ------------- 结束 耗时：4 ms -------------
2021-08-27 17:06:49.089 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 17:06:49.089 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 17:06:49.089 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 17:06:49.090 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86385923285192704 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 17:06:49.090 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86385923285192704 [0;39m <==      Total: 16
2021-08-27 17:06:49.090 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86385923285192704 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 17:06:49.090 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86385923285192704 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 17:06:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385927181701120 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385927181701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385927181701120 [0;39m ==> Parameters: 
2021-08-27 17:06:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385927181701120 [0;39m <==    Updates: 0
2021-08-27 17:06:50.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385927181701120 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:06:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385948149026816 [0;39m 生成今日电子书快照开始
2021-08-27 17:06:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385948149026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:06:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385948149026816 [0;39m ==> Parameters: 
2021-08-27 17:06:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385948149026816 [0;39m <==    Updates: 0
2021-08-27 17:06:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385948149026816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:07:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385969116352512 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385969116352512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385969116352512 [0;39m ==> Parameters: 
2021-08-27 17:07:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385969116352512 [0;39m <==    Updates: 0
2021-08-27 17:07:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385969116352512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:07:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86385990083678208 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385990083678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385990083678208 [0;39m ==> Parameters: 
2021-08-27 17:07:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86385990083678208 [0;39m <==    Updates: 0
2021-08-27 17:07:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86385990083678208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:07:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86385990087872512 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:07:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385990087872512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:07:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385990087872512 [0;39m ==> Parameters: 
2021-08-27 17:07:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86385990087872512 [0;39m <==    Updates: 5
2021-08-27 17:07:05.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86385990087872512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:07:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386011059392512 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386011059392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386011059392512 [0;39m ==> Parameters: 
2021-08-27 17:07:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386011059392512 [0;39m <==    Updates: 0
2021-08-27 17:07:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386011059392512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:07:15.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386032018329600 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386032018329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386032018329600 [0;39m ==> Parameters: 
2021-08-27 17:07:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386032018329600 [0;39m <==    Updates: 0
2021-08-27 17:07:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386032018329600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:07:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386053002432512 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386053002432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386053002432512 [0;39m ==> Parameters: 
2021-08-27 17:07:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386053002432512 [0;39m <==    Updates: 0
2021-08-27 17:07:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386053002432512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:07:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386073973952512 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386073973952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386073973952512 [0;39m ==> Parameters: 
2021-08-27 17:07:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386073973952512 [0;39m <==    Updates: 0
2021-08-27 17:07:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386073973952512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:07:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386094907723776 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386094907723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386094907723776 [0;39m ==> Parameters: 
2021-08-27 17:07:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386094907723776 [0;39m <==    Updates: 0
2021-08-27 17:07:30.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386094907723776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:07:35.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386115904409600 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386115904409600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386115904409600 [0;39m ==> Parameters: 
2021-08-27 17:07:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386115904409600 [0;39m <==    Updates: 0
2021-08-27 17:07:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386115904409600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:07:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86386115908603904 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:07:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386115908603904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:07:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386115908603904 [0;39m ==> Parameters: 
2021-08-27 17:07:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386115908603904 [0;39m <==    Updates: 5
2021-08-27 17:07:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86386115908603904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:07:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386136854958080 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386136854958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386136854958080 [0;39m ==> Parameters: 
2021-08-27 17:07:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386136854958080 [0;39m <==    Updates: 0
2021-08-27 17:07:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386136854958080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:07:45.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386157826478080 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386157826478080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386157826478080 [0;39m ==> Parameters: 
2021-08-27 17:07:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386157826478080 [0;39m <==    Updates: 0
2021-08-27 17:07:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386157826478080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:07:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386178806386688 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386178806386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386178806386688 [0;39m ==> Parameters: 
2021-08-27 17:07:50.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386178806386688 [0;39m <==    Updates: 0
2021-08-27 17:07:50.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386178806386688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:07:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386199803072512 [0;39m 生成今日电子书快照开始
2021-08-27 17:07:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386199803072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:07:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386199803072512 [0;39m ==> Parameters: 
2021-08-27 17:07:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386199803072512 [0;39m <==    Updates: 0
2021-08-27 17:07:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386199803072512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:08:00.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386220736843776 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386220736843776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:00.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386220736843776 [0;39m ==> Parameters: 
2021-08-27 17:08:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386220736843776 [0;39m <==    Updates: 0
2021-08-27 17:08:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386220736843776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:08:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386241758695424 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386241758695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386241758695424 [0;39m ==> Parameters: 
2021-08-27 17:08:05.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386241758695424 [0;39m <==    Updates: 0
2021-08-27 17:08:05.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386241758695424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:08:05.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86386241767084032 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:08:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386241767084032 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:08:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386241767084032 [0;39m ==> Parameters: 
2021-08-27 17:08:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386241767084032 [0;39m <==    Updates: 5
2021-08-27 17:08:05.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86386241767084032 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:08:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386262684078080 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386262684078080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386262684078080 [0;39m ==> Parameters: 
2021-08-27 17:08:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386262684078080 [0;39m <==    Updates: 0
2021-08-27 17:08:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386262684078080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:08:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386283705929728 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386283705929728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386283705929728 [0;39m ==> Parameters: 
2021-08-27 17:08:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386283705929728 [0;39m <==    Updates: 0
2021-08-27 17:08:15.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386283705929728 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:08:20.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386304622923776 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:20.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386304622923776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386304622923776 [0;39m ==> Parameters: 
2021-08-27 17:08:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386304622923776 [0;39m <==    Updates: 0
2021-08-27 17:08:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386304622923776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:08:25.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386325590249472 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:25.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386325590249472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386325590249472 [0;39m ==> Parameters: 
2021-08-27 17:08:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386325590249472 [0;39m <==    Updates: 0
2021-08-27 17:08:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386325590249472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:08:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386346578546688 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386346578546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386346578546688 [0;39m ==> Parameters: 
2021-08-27 17:08:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386346578546688 [0;39m <==    Updates: 0
2021-08-27 17:08:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386346578546688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:08:35.002 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86386367537483776 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:08:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386367537483776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:08:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386367537483776 [0;39m ==> Parameters: 
2021-08-27 17:08:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386367537483776 [0;39m <==    Updates: 5
2021-08-27 17:08:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86386367537483776 [0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2021-08-27 17:08:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386367558455296 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386367558455296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386367558455296 [0;39m ==> Parameters: 
2021-08-27 17:08:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386367558455296 [0;39m <==    Updates: 0
2021-08-27 17:08:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386367558455296 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:08:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386388529975296 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386388529975296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386388529975296 [0;39m ==> Parameters: 
2021-08-27 17:08:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386388529975296 [0;39m <==    Updates: 0
2021-08-27 17:08:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386388529975296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:08:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386409518272512 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386409518272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386409518272512 [0;39m ==> Parameters: 
2021-08-27 17:08:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386409518272512 [0;39m <==    Updates: 0
2021-08-27 17:08:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386409518272512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:08:50.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386430447849472 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386430447849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386430447849472 [0;39m ==> Parameters: 
2021-08-27 17:08:50.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386430447849472 [0;39m <==    Updates: 0
2021-08-27 17:08:50.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386430447849472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:08:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386451444535296 [0;39m 生成今日电子书快照开始
2021-08-27 17:08:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386451444535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:08:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386451444535296 [0;39m ==> Parameters: 
2021-08-27 17:08:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386451444535296 [0;39m <==    Updates: 0
2021-08-27 17:08:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386451444535296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:09:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386472411860992 [0;39m 生成今日电子书快照开始
2021-08-27 17:09:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386472411860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:09:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386472411860992 [0;39m ==> Parameters: 
2021-08-27 17:09:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386472411860992 [0;39m <==    Updates: 0
2021-08-27 17:09:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386472411860992 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:09:05.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386493366603776 [0;39m 生成今日电子书快照开始
2021-08-27 17:09:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386493366603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:09:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386493366603776 [0;39m ==> Parameters: 
2021-08-27 17:09:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386493366603776 [0;39m <==    Updates: 0
2021-08-27 17:09:05.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386493366603776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:09:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86386493374992384 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:09:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386493374992384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:09:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386493374992384 [0;39m ==> Parameters: 
2021-08-27 17:09:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386493374992384 [0;39m <==    Updates: 5
2021-08-27 17:09:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86386493374992384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:09:10.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386514367483904 [0;39m 生成今日电子书快照开始
2021-08-27 17:09:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386514367483904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:09:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386514367483904 [0;39m ==> Parameters: 
2021-08-27 17:09:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386514367483904 [0;39m <==    Updates: 0
2021-08-27 17:09:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386514367483904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:09:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386535330615296 [0;39m 生成今日电子书快照开始
2021-08-27 17:09:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386535330615296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:09:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386535330615296 [0;39m ==> Parameters: 
2021-08-27 17:09:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386535330615296 [0;39m <==    Updates: 0
2021-08-27 17:09:15.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386535330615296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:09:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386556289552384 [0;39m 生成今日电子书快照开始
2021-08-27 17:09:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386556289552384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:09:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386556289552384 [0;39m ==> Parameters: 
2021-08-27 17:09:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386556289552384 [0;39m <==    Updates: 0
2021-08-27 17:09:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386556289552384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:09:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386577282043904 [0;39m 生成今日电子书快照开始
2021-08-27 17:09:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386577282043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:09:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386577282043904 [0;39m ==> Parameters: 
2021-08-27 17:09:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386577282043904 [0;39m <==    Updates: 0
2021-08-27 17:09:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386577282043904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:09:30.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386598266146816 [0;39m 生成今日电子书快照开始
2021-08-27 17:09:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386598266146816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:09:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386598266146816 [0;39m ==> Parameters: 
2021-08-27 17:09:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386598266146816 [0;39m <==    Updates: 0
2021-08-27 17:09:30.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386598266146816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:09:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386619212500992 [0;39m 生成今日电子书快照开始
2021-08-27 17:09:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386619212500992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:09:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386619212500992 [0;39m ==> Parameters: 
2021-08-27 17:09:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386619212500992 [0;39m <==    Updates: 0
2021-08-27 17:09:35.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386619212500992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:09:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86386619220889600 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:09:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386619220889600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:09:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386619220889600 [0;39m ==> Parameters: 
2021-08-27 17:09:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386619220889600 [0;39m <==    Updates: 5
2021-08-27 17:09:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86386619220889600 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 17:10:16.100 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2021-08-27 17:10:16.103 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :55   [32m                  [0;39m Starting KnowlagebaseApplication using Java 1.8.0_261 on DESKTOP-CTIIJC1 with PID 20260 (E:\code\java\knowlagebase\target\classes started by MECHREVO in E:\code\java\knowlagebase)
2021-08-27 17:10:16.104 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-08-27 17:10:16.143 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-08-27 17:10:16.144 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-08-27 17:10:16.587 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-08-27 17:10:16.589 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-08-27 17:10:16.602 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2021-08-27 17:10:17.118 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2021-08-27 17:10:17.124 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2021-08-27 17:10:17.124 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-08-27 17:10:17.124 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2021-08-27 17:10:17.184 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-08-27 17:10:17.184 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1040 ms
2021-08-27 17:10:17.836 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2021-08-27 17:10:18.130 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2021-08-27 17:10:18.168 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-08-27 17:10:18.187 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2021-08-27 17:10:18.200 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2021-08-27 17:10:18.212 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :61   [32m                  [0;39m Started KnowlagebaseApplication in 2.503 seconds (JVM running for 3.675)
2021-08-27 17:10:18.214 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :28   [32m                  [0;39m 启动成功！
2021-08-27 17:10:18.215 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :29   [32m                  [0;39m 地址：	http://127.0.0.1:8880
2021-08-27 17:10:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386807951986688 [0;39m 生成今日电子书快照开始
2021-08-27 17:10:20.016 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m86386807951986688 [0;39m HikariPool-1 - Starting...
2021-08-27 17:10:20.675 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m86386807951986688 [0;39m HikariPool-1 - Start completed.
2021-08-27 17:10:20.680 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386807951986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:10:20.695 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386807951986688 [0;39m ==> Parameters: 
2021-08-27 17:10:20.697 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386807951986688 [0;39m <==    Updates: 0
2021-08-27 17:10:20.699 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386807951986688 [0;39m 生成今日电子书快照结束，耗时：693毫秒
2021-08-27 17:10:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386828961255424 [0;39m 生成今日电子书快照开始
2021-08-27 17:10:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386828961255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:10:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386828961255424 [0;39m ==> Parameters: 
2021-08-27 17:10:25.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386828961255424 [0;39m <==    Updates: 0
2021-08-27 17:10:25.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386828961255424 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:10:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386849920192512 [0;39m 生成今日电子书快照开始
2021-08-27 17:10:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386849920192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:10:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386849920192512 [0;39m ==> Parameters: 
2021-08-27 17:10:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386849920192512 [0;39m <==    Updates: 0
2021-08-27 17:10:30.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386849920192512 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:10:35.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86386870858158080 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:10:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386870858158080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:10:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386870858158080 [0;39m ==> Parameters: 
2021-08-27 17:10:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386870858158080 [0;39m <==    Updates: 5
2021-08-27 17:10:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86386870858158080 [0;39m 更新电子书下的文档数据结束，耗时：11毫秒
2021-08-27 17:10:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386870904295424 [0;39m 生成今日电子书快照开始
2021-08-27 17:10:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386870904295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:10:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386870904295424 [0;39m ==> Parameters: 
2021-08-27 17:10:35.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386870904295424 [0;39m <==    Updates: 0
2021-08-27 17:10:35.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386870904295424 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:10:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386891859038208 [0;39m 生成今日电子书快照开始
2021-08-27 17:10:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386891859038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:10:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386891859038208 [0;39m ==> Parameters: 
2021-08-27 17:10:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386891859038208 [0;39m <==    Updates: 0
2021-08-27 17:10:40.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386891859038208 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:10:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386912834752512 [0;39m 生成今日电子书快照开始
2021-08-27 17:10:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386912834752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:10:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386912834752512 [0;39m ==> Parameters: 
2021-08-27 17:10:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386912834752512 [0;39m <==    Updates: 0
2021-08-27 17:10:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386912834752512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:10:50.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386933760135168 [0;39m 生成今日电子书快照开始
2021-08-27 17:10:50.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386933760135168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:10:50.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386933760135168 [0;39m ==> Parameters: 
2021-08-27 17:10:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386933760135168 [0;39m <==    Updates: 0
2021-08-27 17:10:50.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386933760135168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:10:55.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386954735849472 [0;39m 生成今日电子书快照开始
2021-08-27 17:10:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386954735849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:10:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386954735849472 [0;39m ==> Parameters: 
2021-08-27 17:10:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386954735849472 [0;39m <==    Updates: 0
2021-08-27 17:10:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386954735849472 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:11:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386975728340992 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386975728340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386975728340992 [0;39m ==> Parameters: 
2021-08-27 17:11:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386975728340992 [0;39m <==    Updates: 0
2021-08-27 17:11:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386975728340992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:11:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86386996699860992 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386996699860992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386996699860992 [0;39m ==> Parameters: 
2021-08-27 17:11:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86386996699860992 [0;39m <==    Updates: 0
2021-08-27 17:11:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86386996699860992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:11:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86386996716638208 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:11:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386996716638208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:11:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386996716638208 [0;39m ==> Parameters: 
2021-08-27 17:11:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86386996716638208 [0;39m <==    Updates: 5
2021-08-27 17:11:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86386996716638208 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:11:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387017658798080 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387017658798080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387017658798080 [0;39m ==> Parameters: 
2021-08-27 17:11:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387017658798080 [0;39m <==    Updates: 0
2021-08-27 17:11:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387017658798080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:11:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387038668066816 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387038668066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387038668066816 [0;39m ==> Parameters: 
2021-08-27 17:11:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387038668066816 [0;39m <==    Updates: 0
2021-08-27 17:11:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387038668066816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:11:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387059622809600 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387059622809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387059622809600 [0;39m ==> Parameters: 
2021-08-27 17:11:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387059622809600 [0;39m <==    Updates: 0
2021-08-27 17:11:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387059622809600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:11:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387080590135296 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387080590135296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387080590135296 [0;39m ==> Parameters: 
2021-08-27 17:11:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387080590135296 [0;39m <==    Updates: 0
2021-08-27 17:11:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387080590135296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:11:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387101561655296 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387101561655296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387101561655296 [0;39m ==> Parameters: 
2021-08-27 17:11:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387101561655296 [0;39m <==    Updates: 0
2021-08-27 17:11:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387101561655296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:11:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387122562535424 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387122562535424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387122562535424 [0;39m ==> Parameters: 
2021-08-27 17:11:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387122562535424 [0;39m <==    Updates: 0
2021-08-27 17:11:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387122562535424 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:11:35.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86387122575118336 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:11:35.018 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387122575118336 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:11:35.018 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387122575118336 [0;39m ==> Parameters: 
2021-08-27 17:11:35.019 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387122575118336 [0;39m <==    Updates: 5
2021-08-27 17:11:35.019 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86387122575118336 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 17:11:40.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387143542444032 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:40.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387143542444032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:40.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387143542444032 [0;39m ==> Parameters: 
2021-08-27 17:11:40.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387143542444032 [0;39m <==    Updates: 0
2021-08-27 17:11:40.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387143542444032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:11:45.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387164513964032 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:45.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387164513964032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:45.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387164513964032 [0;39m ==> Parameters: 
2021-08-27 17:11:45.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387164513964032 [0;39m <==    Updates: 0
2021-08-27 17:11:45.020 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387164513964032 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:11:50.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387185430958080 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387185430958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387185430958080 [0;39m ==> Parameters: 
2021-08-27 17:11:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387185430958080 [0;39m <==    Updates: 0
2021-08-27 17:11:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387185430958080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:11:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387206427643904 [0;39m 生成今日电子书快照开始
2021-08-27 17:11:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387206427643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:11:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387206427643904 [0;39m ==> Parameters: 
2021-08-27 17:11:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387206427643904 [0;39m <==    Updates: 0
2021-08-27 17:11:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387206427643904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:12:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387227399163904 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387227399163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387227399163904 [0;39m ==> Parameters: 
2021-08-27 17:12:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387227399163904 [0;39m <==    Updates: 0
2021-08-27 17:12:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387227399163904 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:12:05.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387248337129472 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:05.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387248337129472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387248337129472 [0;39m ==> Parameters: 
2021-08-27 17:12:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387248337129472 [0;39m <==    Updates: 0
2021-08-27 17:12:05.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387248337129472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:12:05.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86387248345518080 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:12:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387248345518080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:12:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387248345518080 [0;39m ==> Parameters: 
2021-08-27 17:12:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387248345518080 [0;39m <==    Updates: 5
2021-08-27 17:12:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86387248345518080 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 17:12:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387269358981120 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387269358981120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:10.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387269358981120 [0;39m ==> Parameters: 
2021-08-27 17:12:10.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387269358981120 [0;39m <==    Updates: 0
2021-08-27 17:12:10.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387269358981120 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:12:15.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387290317918208 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387290317918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387290317918208 [0;39m ==> Parameters: 
2021-08-27 17:12:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387290317918208 [0;39m <==    Updates: 0
2021-08-27 17:12:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387290317918208 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:12:20.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387311255883776 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:20.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387311255883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387311255883776 [0;39m ==> Parameters: 
2021-08-27 17:12:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387311255883776 [0;39m <==    Updates: 0
2021-08-27 17:12:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387311255883776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:12:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387332256763904 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387332256763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387332256763904 [0;39m ==> Parameters: 
2021-08-27 17:12:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387332256763904 [0;39m <==    Updates: 0
2021-08-27 17:12:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387332256763904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:12:30.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387353194729472 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387353194729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387353194729472 [0;39m ==> Parameters: 
2021-08-27 17:12:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387353194729472 [0;39m <==    Updates: 0
2021-08-27 17:12:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387353194729472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:12:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387374216581120 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387374216581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387374216581120 [0;39m ==> Parameters: 
2021-08-27 17:12:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387374216581120 [0;39m <==    Updates: 0
2021-08-27 17:12:35.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387374216581120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:12:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86387374224969728 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:12:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387374224969728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:12:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387374224969728 [0;39m ==> Parameters: 
2021-08-27 17:12:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387374224969728 [0;39m <==    Updates: 5
2021-08-27 17:12:35.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86387374224969728 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:12:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387395192295424 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387395192295424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387395192295424 [0;39m ==> Parameters: 
2021-08-27 17:12:40.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387395192295424 [0;39m <==    Updates: 0
2021-08-27 17:12:40.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387395192295424 [0;39m 生成今日电子书快照结束，耗时：5毫秒
2021-08-27 17:12:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387416130260992 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387416130260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387416130260992 [0;39m ==> Parameters: 
2021-08-27 17:12:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387416130260992 [0;39m <==    Updates: 0
2021-08-27 17:12:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387416130260992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:12:50.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387437085003776 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387437085003776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:50.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387437085003776 [0;39m ==> Parameters: 
2021-08-27 17:12:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387437085003776 [0;39m <==    Updates: 0
2021-08-27 17:12:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387437085003776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:12:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387458064912384 [0;39m 生成今日电子书快照开始
2021-08-27 17:12:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387458064912384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:12:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387458064912384 [0;39m ==> Parameters: 
2021-08-27 17:12:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387458064912384 [0;39m <==    Updates: 0
2021-08-27 17:12:55.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387458064912384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:13:00.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387479023849472 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387479023849472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387479023849472 [0;39m ==> Parameters: 
2021-08-27 17:13:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387479023849472 [0;39m <==    Updates: 0
2021-08-27 17:13:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387479023849472 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:13:05.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387500003758080 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387500003758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387500003758080 [0;39m ==> Parameters: 
2021-08-27 17:13:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387500003758080 [0;39m <==    Updates: 0
2021-08-27 17:13:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387500003758080 [0;39m 生成今日电子书快照结束，耗时：5毫秒
2021-08-27 17:13:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86387500028923904 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:13:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387500028923904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:13:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387500028923904 [0;39m ==> Parameters: 
2021-08-27 17:13:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387500028923904 [0;39m <==    Updates: 5
2021-08-27 17:13:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86387500028923904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:13:10.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387521000443904 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387521000443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387521000443904 [0;39m ==> Parameters: 
2021-08-27 17:13:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387521000443904 [0;39m <==    Updates: 0
2021-08-27 17:13:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387521000443904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:13:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387541971963904 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387541971963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387541971963904 [0;39m ==> Parameters: 
2021-08-27 17:13:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387541971963904 [0;39m <==    Updates: 0
2021-08-27 17:13:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387541971963904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:13:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387562922512384 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387562922512384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387562922512384 [0;39m ==> Parameters: 
2021-08-27 17:13:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387562922512384 [0;39m <==    Updates: 0
2021-08-27 17:13:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387562922512384 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:13:25.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387583902420992 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:25.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387583902420992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387583902420992 [0;39m ==> Parameters: 
2021-08-27 17:13:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387583902420992 [0;39m <==    Updates: 0
2021-08-27 17:13:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387583902420992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:13:34.589 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2021-08-27 17:13:34.591 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :55   [32m                  [0;39m Starting KnowlagebaseApplication using Java 1.8.0_261 on DESKTOP-CTIIJC1 with PID 19944 (E:\code\java\knowlagebase\target\classes started by MECHREVO in E:\code\java\knowlagebase)
2021-08-27 17:13:34.591 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-08-27 17:13:34.628 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-08-27 17:13:34.628 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-08-27 17:13:35.038 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-08-27 17:13:35.039 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-08-27 17:13:35.051 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2021-08-27 17:13:35.518 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2021-08-27 17:13:35.523 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2021-08-27 17:13:35.523 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-08-27 17:13:35.524 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2021-08-27 17:13:35.573 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-08-27 17:13:35.573 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 944 ms
2021-08-27 17:13:36.162 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2021-08-27 17:13:36.428 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2021-08-27 17:13:36.462 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-08-27 17:13:36.480 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2021-08-27 17:13:36.490 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2021-08-27 17:13:36.500 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :61   [32m                  [0;39m Started KnowlagebaseApplication in 2.244 seconds (JVM running for 3.25)
2021-08-27 17:13:36.502 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :28   [32m                  [0;39m 启动成功！
2021-08-27 17:13:36.502 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :29   [32m                  [0;39m 地址：	http://127.0.0.1:8880
2021-08-27 17:13:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387646812786688 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:40.015 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m86387646812786688 [0;39m HikariPool-1 - Starting...
2021-08-27 17:13:40.603 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m86387646812786688 [0;39m HikariPool-1 - Start completed.
2021-08-27 17:13:40.607 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387646812786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:40.620 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387646812786688 [0;39m ==> Parameters: 
2021-08-27 17:13:40.622 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387646812786688 [0;39m <==    Updates: 0
2021-08-27 17:13:40.623 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387646812786688 [0;39m 生成今日电子书快照结束，耗时：618毫秒
2021-08-27 17:13:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387667784306688 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387667784306688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387667784306688 [0;39m ==> Parameters: 
2021-08-27 17:13:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387667784306688 [0;39m <==    Updates: 0
2021-08-27 17:13:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387667784306688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:13:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387688793575424 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387688793575424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387688793575424 [0;39m ==> Parameters: 
2021-08-27 17:13:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387688793575424 [0;39m <==    Updates: 0
2021-08-27 17:13:50.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387688793575424 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:13:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387709756706816 [0;39m 生成今日电子书快照开始
2021-08-27 17:13:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387709756706816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:13:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387709756706816 [0;39m ==> Parameters: 
2021-08-27 17:13:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387709756706816 [0;39m <==    Updates: 0
2021-08-27 17:13:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387709756706816 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:14:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387730719838208 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387730719838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387730719838208 [0;39m ==> Parameters: 
2021-08-27 17:14:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387730719838208 [0;39m <==    Updates: 0
2021-08-27 17:14:00.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387730719838208 [0;39m 生成今日电子书快照结束，耗时：5毫秒
2021-08-27 17:14:02.169 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-08-27 17:14:02.170 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-08-27 17:14:02.171 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-08-27 17:14:02.199 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :33   [32m                  [0;39m 有新连接：token：sondcvoYHS，session id：0，当前连接数：1
2021-08-27 17:14:02.332 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86387740454817794 [0;39m ------------- 开始 -------------
2021-08-27 17:14:02.332 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86387740454817793 [0;39m ------------- 开始 -------------
2021-08-27 17:14:02.332 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86387740454817792 [0;39m ------------- 开始 -------------
2021-08-27 17:14:02.333 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86387740454817792 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 17:14:02.333 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86387740454817794 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 17:14:02.333 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86387740454817793 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 17:14:02.333 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86387740454817792 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 17:14:02.333 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86387740454817793 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 17:14:02.333 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86387740454817794 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 17:14:02.333 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86387740454817793 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:14:02.333 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86387740454817792 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:14:02.333 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86387740454817794 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:14:02.361 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86387740454817793 [0;39m 请求参数: []
2021-08-27 17:14:02.361 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86387740454817794 [0;39m 请求参数: []
2021-08-27 17:14:02.361 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86387740454817792 [0;39m 请求参数: []
2021-08-27 17:14:02.367 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86387740454817793 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 17:14:02.367 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86387740454817792 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 17:14:02.367 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86387740454817792 [0;39m ==> Parameters: 
2021-08-27 17:14:02.367 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86387740454817793 [0;39m ==> Parameters: 
2021-08-27 17:14:02.379 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86387740454817794 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 17:14:02.380 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86387740454817794 [0;39m ==> Parameters: 
2021-08-27 17:14:02.386 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86387740454817792 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 17:14:02.386 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86387740454817793 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 17:14:02.386 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 17:14:02.387 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 17:14:02.387 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86387740454817793 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 17:14:02.387 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86387740454817792 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 17:14:02.388 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 17:14:02.389 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 17:14:02.389 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86387740454817792 [0;39m <==      Total: 1
2021-08-27 17:14:02.389 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86387740454817793 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 17:14:02.389 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 17:14:02.389 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86387740454817793 [0;39m <==      Total: 2
2021-08-27 17:14:02.389 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 17:14:02.390 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 17:14:02.391 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 17:14:02.391 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 17:14:02.391 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 17:14:02.392 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 17:14:02.392 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 17:14:02.393 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 17:14:02.393 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 17:14:02.393 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 17:14:02.394 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 17:14:02.394 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86387740454817794 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 17:14:02.395 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86387740454817794 [0;39m <==      Total: 16
2021-08-27 17:14:02.411 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86387740454817794 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 17:14:02.412 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86387740454817794 [0;39m ------------- 结束 耗时：81 ms -------------
2021-08-27 17:14:02.413 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86387740454817792 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 17:14:02.413 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86387740454817793 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 17:14:02.413 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86387740454817792 [0;39m ------------- 结束 耗时：82 ms -------------
2021-08-27 17:14:02.413 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86387740454817793 [0;39m ------------- 结束 耗时：82 ms -------------
2021-08-27 17:14:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86387751670386688 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:14:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387751670386688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:14:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387751670386688 [0;39m ==> Parameters: 
2021-08-27 17:14:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387751670386688 [0;39m <==    Updates: 5
2021-08-27 17:14:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86387751670386688 [0;39m 更新电子书下的文档数据结束，耗时：4毫秒
2021-08-27 17:14:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387751691358208 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387751691358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387751691358208 [0;39m ==> Parameters: 
2021-08-27 17:14:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387751691358208 [0;39m <==    Updates: 0
2021-08-27 17:14:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387751691358208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:14:10.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387772667072512 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387772667072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387772667072512 [0;39m ==> Parameters: 
2021-08-27 17:14:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387772667072512 [0;39m <==    Updates: 0
2021-08-27 17:14:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387772667072512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:14:13.984 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86387789331042304 [0;39m ------------- 开始 -------------
2021-08-27 17:14:13.984 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86387789331042304 [0;39m 请求地址: http://127.0.0.1:8880/user/login POST
2021-08-27 17:14:13.985 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86387789331042304 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.login
2021-08-27 17:14:13.985 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86387789331042304 [0;39m 远程地址: 127.0.0.1
2021-08-27 17:14:13.986 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86387789331042304 [0;39m 请求参数: [{"loginName":"test"}]
2021-08-27 17:14:13.994 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86387789331042304 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-08-27 17:14:13.995 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86387789331042304 [0;39m ==> Parameters: test(String)
2021-08-27 17:14:13.996 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86387789331042304 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 17:14:13.996 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86387789331042304 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 17:14:13.997 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86387789331042304 [0;39m <==      Total: 1
2021-08-27 17:14:14.000 INFO  com.haoyu.knowlagebase.controller.UserController  :81   [32m86387789331042304 [0;39m 生成单点登录token：86387789398151168，并放入redis中
2021-08-27 17:14:14.878 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86387789331042304 [0;39m 返回结果: {"content":{"id":1,"loginName":"test","name":"测试","token":"86387789398151168"},"success":true}
2021-08-27 17:14:14.878 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86387789331042304 [0;39m ------------- 结束 耗时：894 ms -------------
2021-08-27 17:14:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387793605038080 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387793605038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387793605038080 [0;39m ==> Parameters: 
2021-08-27 17:14:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387793605038080 [0;39m <==    Updates: 0
2021-08-27 17:14:15.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387793605038080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:14:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387814622695424 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387814622695424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:20.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387814622695424 [0;39m ==> Parameters: 
2021-08-27 17:14:20.021 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387814622695424 [0;39m <==    Updates: 0
2021-08-27 17:14:20.021 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387814622695424 [0;39m 生成今日电子书快照结束，耗时：7毫秒
2021-08-27 17:14:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387835598409728 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387835598409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387835598409728 [0;39m ==> Parameters: 
2021-08-27 17:14:25.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387835598409728 [0;39m <==    Updates: 0
2021-08-27 17:14:25.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387835598409728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:14:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387856527986688 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387856527986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387856527986688 [0;39m ==> Parameters: 
2021-08-27 17:14:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387856527986688 [0;39m <==    Updates: 0
2021-08-27 17:14:30.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387856527986688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:14:35.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387877545644032 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387877545644032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:35.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387877545644032 [0;39m ==> Parameters: 
2021-08-27 17:14:35.020 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387877545644032 [0;39m <==    Updates: 0
2021-08-27 17:14:35.020 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387877545644032 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:14:35.020 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86387877562421248 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:14:35.020 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387877562421248 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:14:35.021 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387877562421248 [0;39m ==> Parameters: 
2021-08-27 17:14:35.022 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86387877562421248 [0;39m <==    Updates: 5
2021-08-27 17:14:35.022 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86387877562421248 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 17:14:40.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387898504581120 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387898504581120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387898504581120 [0;39m ==> Parameters: 
2021-08-27 17:14:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387898504581120 [0;39m <==    Updates: 0
2021-08-27 17:14:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387898504581120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:14:45.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387919434158080 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387919434158080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387919434158080 [0;39m ==> Parameters: 
2021-08-27 17:14:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387919434158080 [0;39m <==    Updates: 0
2021-08-27 17:14:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387919434158080 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:14:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387940451815424 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387940451815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387940451815424 [0;39m ==> Parameters: 
2021-08-27 17:14:50.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387940451815424 [0;39m <==    Updates: 0
2021-08-27 17:14:50.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387940451815424 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:14:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387961381392384 [0;39m 生成今日电子书快照开始
2021-08-27 17:14:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387961381392384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:14:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387961381392384 [0;39m ==> Parameters: 
2021-08-27 17:14:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387961381392384 [0;39m <==    Updates: 0
2021-08-27 17:14:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387961381392384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:15:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86387982394855424 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:00.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387982394855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:00.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387982394855424 [0;39m ==> Parameters: 
2021-08-27 17:15:00.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86387982394855424 [0;39m <==    Updates: 0
2021-08-27 17:15:00.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86387982394855424 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:15:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388003332820992 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388003332820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388003332820992 [0;39m ==> Parameters: 
2021-08-27 17:15:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388003332820992 [0;39m <==    Updates: 0
2021-08-27 17:15:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388003332820992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:15:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86388003345403904 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:15:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388003345403904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:15:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388003345403904 [0;39m ==> Parameters: 
2021-08-27 17:15:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388003345403904 [0;39m <==    Updates: 5
2021-08-27 17:15:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86388003345403904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:15:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388024283369472 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388024283369472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388024283369472 [0;39m ==> Parameters: 
2021-08-27 17:15:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388024283369472 [0;39m <==    Updates: 0
2021-08-27 17:15:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388024283369472 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:15:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388045309415424 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388045309415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388045309415424 [0;39m ==> Parameters: 
2021-08-27 17:15:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388045309415424 [0;39m <==    Updates: 0
2021-08-27 17:15:15.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388045309415424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:15:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388066255769600 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388066255769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388066255769600 [0;39m ==> Parameters: 
2021-08-27 17:15:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388066255769600 [0;39m <==    Updates: 0
2021-08-27 17:15:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388066255769600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:15:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388087223095296 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388087223095296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388087223095296 [0;39m ==> Parameters: 
2021-08-27 17:15:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388087223095296 [0;39m <==    Updates: 0
2021-08-27 17:15:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388087223095296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:15:30.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388108215586816 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388108215586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388108215586816 [0;39m ==> Parameters: 
2021-08-27 17:15:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388108215586816 [0;39m <==    Updates: 0
2021-08-27 17:15:30.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388108215586816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:15:35.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86388129161940992 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:15:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388129161940992 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:15:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388129161940992 [0;39m ==> Parameters: 
2021-08-27 17:15:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388129161940992 [0;39m <==    Updates: 5
2021-08-27 17:15:35.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86388129161940992 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 17:15:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388129174523904 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388129174523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388129174523904 [0;39m ==> Parameters: 
2021-08-27 17:15:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388129174523904 [0;39m <==    Updates: 0
2021-08-27 17:15:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388129174523904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 17:15:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388150158626816 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388150158626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388150158626816 [0;39m ==> Parameters: 
2021-08-27 17:15:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388150158626816 [0;39m <==    Updates: 0
2021-08-27 17:15:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388150158626816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:15:45.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388171146924032 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388171146924032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:45.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388171146924032 [0;39m ==> Parameters: 
2021-08-27 17:15:45.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388171146924032 [0;39m <==    Updates: 0
2021-08-27 17:15:45.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388171146924032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:15:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388192084889600 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388192084889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388192084889600 [0;39m ==> Parameters: 
2021-08-27 17:15:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388192084889600 [0;39m <==    Updates: 0
2021-08-27 17:15:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388192084889600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:15:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388213052215296 [0;39m 生成今日电子书快照开始
2021-08-27 17:15:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388213052215296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:15:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388213052215296 [0;39m ==> Parameters: 
2021-08-27 17:15:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388213052215296 [0;39m <==    Updates: 0
2021-08-27 17:15:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388213052215296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:16:00.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388234006958080 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388234006958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388234006958080 [0;39m ==> Parameters: 
2021-08-27 17:16:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388234006958080 [0;39m <==    Updates: 0
2021-08-27 17:16:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388234006958080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:16:05.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86388254978478080 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:16:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388254978478080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:16:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388254978478080 [0;39m ==> Parameters: 
2021-08-27 17:16:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388254978478080 [0;39m <==    Updates: 5
2021-08-27 17:16:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86388254978478080 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 17:16:05.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388254986866688 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388254986866688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388254986866688 [0;39m ==> Parameters: 
2021-08-27 17:16:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388254986866688 [0;39m <==    Updates: 0
2021-08-27 17:16:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388254986866688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:16:10.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388275970969600 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388275970969600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388275970969600 [0;39m ==> Parameters: 
2021-08-27 17:16:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388275970969600 [0;39m <==    Updates: 0
2021-08-27 17:16:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388275970969600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:16:15.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388296942489600 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388296942489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388296942489600 [0;39m ==> Parameters: 
2021-08-27 17:16:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388296942489600 [0;39m <==    Updates: 0
2021-08-27 17:16:15.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388296942489600 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 17:16:20.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388317947564032 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388317947564032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:20.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388317947564032 [0;39m ==> Parameters: 
2021-08-27 17:16:20.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388317947564032 [0;39m <==    Updates: 0
2021-08-27 17:16:20.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388317947564032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:16:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388338864558080 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388338864558080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388338864558080 [0;39m ==> Parameters: 
2021-08-27 17:16:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388338864558080 [0;39m <==    Updates: 0
2021-08-27 17:16:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388338864558080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:16:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388359844466688 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388359844466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388359844466688 [0;39m ==> Parameters: 
2021-08-27 17:16:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388359844466688 [0;39m <==    Updates: 0
2021-08-27 17:16:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388359844466688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:16:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388380820180992 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388380820180992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388380820180992 [0;39m ==> Parameters: 
2021-08-27 17:16:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388380820180992 [0;39m <==    Updates: 0
2021-08-27 17:16:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388380820180992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:16:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86388380836958208 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:16:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388380836958208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:16:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388380836958208 [0;39m ==> Parameters: 
2021-08-27 17:16:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388380836958208 [0;39m <==    Updates: 5
2021-08-27 17:16:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86388380836958208 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 17:16:40.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388401770729472 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:40.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388401770729472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:40.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388401770729472 [0;39m ==> Parameters: 
2021-08-27 17:16:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388401770729472 [0;39m <==    Updates: 0
2021-08-27 17:16:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388401770729472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:16:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388422779998208 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388422779998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388422779998208 [0;39m ==> Parameters: 
2021-08-27 17:16:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388422779998208 [0;39m <==    Updates: 0
2021-08-27 17:16:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388422779998208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:16:50.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388443717963776 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388443717963776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:50.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388443717963776 [0;39m ==> Parameters: 
2021-08-27 17:16:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388443717963776 [0;39m <==    Updates: 0
2021-08-27 17:16:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388443717963776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:16:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388464697872384 [0;39m 生成今日电子书快照开始
2021-08-27 17:16:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388464697872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:16:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388464697872384 [0;39m ==> Parameters: 
2021-08-27 17:16:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388464697872384 [0;39m <==    Updates: 0
2021-08-27 17:16:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388464697872384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:17:00.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388485652615168 [0;39m 生成今日电子书快照开始
2021-08-27 17:17:00.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388485652615168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:17:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388485652615168 [0;39m ==> Parameters: 
2021-08-27 17:17:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388485652615168 [0;39m <==    Updates: 0
2021-08-27 17:17:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388485652615168 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 17:17:05.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86388506636718080 [0;39m 更新电子书下的文档数据开始
2021-08-27 17:17:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388506636718080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 17:17:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388506636718080 [0;39m ==> Parameters: 
2021-08-27 17:17:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86388506636718080 [0;39m <==    Updates: 5
2021-08-27 17:17:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86388506636718080 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 17:17:05.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388506645106688 [0;39m 生成今日电子书快照开始
2021-08-27 17:17:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388506645106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:17:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388506645106688 [0;39m ==> Parameters: 
2021-08-27 17:17:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388506645106688 [0;39m <==    Updates: 0
2021-08-27 17:17:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388506645106688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:17:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388527620820992 [0;39m 生成今日电子书快照开始
2021-08-27 17:17:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388527620820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:17:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388527620820992 [0;39m ==> Parameters: 
2021-08-27 17:17:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388527620820992 [0;39m <==    Updates: 0
2021-08-27 17:17:10.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388527620820992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:17:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388548625895424 [0;39m 生成今日电子书快照开始
2021-08-27 17:17:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388548625895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:17:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388548625895424 [0;39m ==> Parameters: 
2021-08-27 17:17:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388548625895424 [0;39m <==    Updates: 0
2021-08-27 17:17:15.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388548625895424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 17:17:17.849 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :42   [32m                  [0;39m 连接关闭，token：sondcvoYHS，session id：0！当前连接数：0
2021-08-27 17:17:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86388569601609728 [0;39m 生成今日电子书快照开始
2021-08-27 17:17:20.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388569601609728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 17:17:20.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388569601609728 [0;39m ==> Parameters: 
2021-08-27 17:17:20.022 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86388569601609728 [0;39m <==    Updates: 0
2021-08-27 17:17:20.023 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86388569601609728 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 21:43:28.415 INFO  org.hibernate.validator.internal.util.Version     :21   [32m                  [0;39m HV000001: Hibernate Validator 6.1.6.Final
2021-08-27 21:43:28.422 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :55   [32m                  [0;39m Starting KnowlagebaseApplication using Java 1.8.0_261 on DESKTOP-CTIIJC1 with PID 20132 (E:\code\java\knowlagebase\target\classes started by MECHREVO in E:\code\java\knowlagebase)
2021-08-27 21:43:28.422 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :660  [32m                  [0;39m No active profile set, falling back to default profiles: default
2021-08-27 21:43:28.460 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2021-08-27 21:43:28.460 INFO  o.s.b.d.env.DevToolsPropertyDefaultsPostProcessor :255  [32m                  [0;39m For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2021-08-27 21:43:29.241 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :250  [32m                  [0;39m Multiple Spring Data modules found, entering strict repository configuration mode!
2021-08-27 21:43:29.243 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :128  [32m                  [0;39m Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2021-08-27 21:43:29.258 INFO  o.s.d.r.config.RepositoryConfigurationDelegate    :188  [32m                  [0;39m Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2021-08-27 21:43:29.793 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :108  [32m                  [0;39m Tomcat initialized with port(s): 8880 (http)
2021-08-27 21:43:29.800 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Initializing ProtocolHandler ["http-nio-8880"]
2021-08-27 21:43:29.800 INFO  org.apache.catalina.core.StandardService          :173  [32m                  [0;39m Starting service [Tomcat]
2021-08-27 21:43:29.800 INFO  org.apache.catalina.core.StandardEngine           :173  [32m                  [0;39m Starting Servlet engine: [Apache Tomcat/9.0.39]
2021-08-27 21:43:29.858 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring embedded WebApplicationContext
2021-08-27 21:43:29.858 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext    :289  [32m                  [0;39m Root WebApplicationContext: initialization completed in 1398 ms
2021-08-27 21:43:30.590 INFO  o.s.scheduling.concurrent.ThreadPoolTaskExecutor  :181  [32m                  [0;39m Initializing ExecutorService 'applicationTaskExecutor'
2021-08-27 21:43:30.900 INFO  o.s.scheduling.concurrent.ThreadPoolTaskScheduler :181  [32m                  [0;39m Initializing ExecutorService 'taskScheduler'
2021-08-27 21:43:30.937 INFO  o.s.b.d.autoconfigure.OptionalLiveReloadServer    :58   [32m                  [0;39m LiveReload server is running on port 35729
2021-08-27 21:43:30.955 INFO  org.apache.coyote.http11.Http11NioProtocol        :173  [32m                  [0;39m Starting ProtocolHandler ["http-nio-8880"]
2021-08-27 21:43:30.967 INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer      :220  [32m                  [0;39m Tomcat started on port(s): 8880 (http) with context path ''
2021-08-27 21:43:30.977 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :61   [32m                  [0;39m Started KnowlagebaseApplication in 2.928 seconds (JVM running for 4.465)
2021-08-27 21:43:30.979 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :28   [32m                  [0;39m 启动成功！
2021-08-27 21:43:30.979 INFO  c.h.knowlagebase.config.KnowlagebaseApplication   :29   [32m                  [0;39m 地址：	http://127.0.0.1:8880
2021-08-27 21:43:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86455573578649600 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:43:35.025 INFO  com.zaxxer.hikari.HikariDataSource                :110  [32m86455573578649600 [0;39m HikariPool-1 - Starting...
2021-08-27 21:43:35.839 INFO  com.zaxxer.hikari.HikariDataSource                :123  [32m86455573578649600 [0;39m HikariPool-1 - Start completed.
2021-08-27 21:43:35.844 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455573578649600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:43:35.859 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455573578649600 [0;39m ==> Parameters: 
2021-08-27 21:43:35.862 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455573578649600 [0;39m <==    Updates: 5
2021-08-27 21:43:35.863 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86455573578649600 [0;39m 更新电子书下的文档数据结束，耗时：855毫秒
2021-08-27 21:43:35.863 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455577164779520 [0;39m 生成今日电子书快照开始
2021-08-27 21:43:35.864 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455577164779520 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:43:35.865 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455577164779520 [0;39m ==> Parameters: 
2021-08-27 21:43:35.867 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455577164779520 [0;39m <==    Updates: 0
2021-08-27 21:43:35.867 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455577164779520 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 21:43:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455594529198080 [0;39m 生成今日电子书快照开始
2021-08-27 21:43:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455594529198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:43:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455594529198080 [0;39m ==> Parameters: 
2021-08-27 21:43:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455594529198080 [0;39m <==    Updates: 0
2021-08-27 21:43:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455594529198080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:43:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455615509106688 [0;39m 生成今日电子书快照开始
2021-08-27 21:43:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455615509106688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:43:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455615509106688 [0;39m ==> Parameters: 
2021-08-27 21:43:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455615509106688 [0;39m <==    Updates: 0
2021-08-27 21:43:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455615509106688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:43:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455636484820992 [0;39m 生成今日电子书快照开始
2021-08-27 21:43:50.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455636484820992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:43:50.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455636484820992 [0;39m ==> Parameters: 
2021-08-27 21:43:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455636484820992 [0;39m <==    Updates: 0
2021-08-27 21:43:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455636484820992 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 21:43:55.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455657435369472 [0;39m 生成今日电子书快照开始
2021-08-27 21:43:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455657435369472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:43:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455657435369472 [0;39m ==> Parameters: 
2021-08-27 21:43:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455657435369472 [0;39m <==    Updates: 0
2021-08-27 21:43:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455657435369472 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:44:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455678423666688 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455678423666688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455678423666688 [0;39m ==> Parameters: 
2021-08-27 21:44:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455678423666688 [0;39m <==    Updates: 0
2021-08-27 21:44:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455678423666688 [0;39m 生成今日电子书快照结束，耗时：5毫秒
2021-08-27 21:44:05.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455699395186688 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:05.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455699395186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455699395186688 [0;39m ==> Parameters: 
2021-08-27 21:44:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455699395186688 [0;39m <==    Updates: 0
2021-08-27 21:44:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455699395186688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:44:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86455699407769600 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:44:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455699407769600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:44:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455699407769600 [0;39m ==> Parameters: 
2021-08-27 21:44:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455699407769600 [0;39m <==    Updates: 5
2021-08-27 21:44:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86455699407769600 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:44:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455720400261120 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455720400261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455720400261120 [0;39m ==> Parameters: 
2021-08-27 21:44:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455720400261120 [0;39m <==    Updates: 0
2021-08-27 21:44:10.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455720400261120 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:44:15.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455741321449472 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:15.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455741321449472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455741321449472 [0;39m ==> Parameters: 
2021-08-27 21:44:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455741321449472 [0;39m <==    Updates: 0
2021-08-27 21:44:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455741321449472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:44:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455762339106816 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455762339106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455762339106816 [0;39m ==> Parameters: 
2021-08-27 21:44:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455762339106816 [0;39m <==    Updates: 0
2021-08-27 21:44:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455762339106816 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:44:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455783272878080 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455783272878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455783272878080 [0;39m ==> Parameters: 
2021-08-27 21:44:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455783272878080 [0;39m <==    Updates: 0
2021-08-27 21:44:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455783272878080 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 21:44:26.780 INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] :173  [32m                  [0;39m Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-08-27 21:44:26.780 INFO  org.springframework.web.servlet.DispatcherServlet :525  [32m                  [0;39m Initializing Servlet 'dispatcherServlet'
2021-08-27 21:44:26.781 INFO  org.springframework.web.servlet.DispatcherServlet :547  [32m                  [0;39m Completed initialization in 1 ms
2021-08-27 21:44:26.829 INFO  com.haoyu.knowlagebase.websocket.WebSocketServer  :33   [32m                  [0;39m 有新连接：token：aVuXexlupv，session id：0，当前连接数：1
2021-08-27 21:44:26.943 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86455791405633537 [0;39m ------------- 开始 -------------
2021-08-27 21:44:26.943 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86455791405633538 [0;39m ------------- 开始 -------------
2021-08-27 21:44:26.943 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86455791405633536 [0;39m ------------- 开始 -------------
2021-08-27 21:44:26.944 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86455791405633537 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-statistic GET
2021-08-27 21:44:26.944 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86455791405633538 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 21:44:26.944 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86455791405633536 [0;39m 请求地址: http://127.0.0.1:8880/ebook-snapshot/get-30-statistic GET
2021-08-27 21:44:26.944 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86455791405633537 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.getStatistic
2021-08-27 21:44:26.944 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86455791405633536 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookSnapshotController.get30Statistic
2021-08-27 21:44:26.944 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86455791405633538 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 21:44:26.944 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86455791405633536 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:44:26.944 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86455791405633537 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:44:26.944 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86455791405633538 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:44:26.982 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86455791405633537 [0;39m 请求参数: []
2021-08-27 21:44:26.982 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86455791405633538 [0;39m 请求参数: []
2021-08-27 21:44:26.982 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86455791405633536 [0;39m 请求参数: []
2021-08-27 21:44:26.991 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86455791405633536 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` between date_sub(curdate(), interval 30 day) and date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 21:44:26.991 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86455791405633537 [0;39m ==>  Preparing: select t1.`date` as `date`, sum(t1.view_count) as viewCount, sum(t1.vote_count) as voteCount, sum(t1.view_increase) as viewIncrease, sum(t1.vote_increase) as voteIncrease from ebook_snapshot t1 where t1.`date` >= date_sub(curdate(), interval 1 day) group by t1.`date` order by t1.`date` asc;
2021-08-27 21:44:26.991 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86455791405633537 [0;39m ==> Parameters: 
2021-08-27 21:44:26.991 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86455791405633536 [0;39m ==> Parameters: 
2021-08-27 21:44:27.009 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86455791405633538 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 21:44:27.010 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86455791405633538 [0;39m ==> Parameters: 
2021-08-27 21:44:27.013 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86455791405633536 [0;39m <==    Columns: date, viewIncrease, voteIncrease
2021-08-27 21:44:27.013 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 21:44:27.013 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86455791405633537 [0;39m <==    Columns: date, viewCount, voteCount, viewIncrease, voteIncrease
2021-08-27 21:44:27.013 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 21:44:27.014 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86455791405633537 [0;39m <==        Row: 2021-08-26, 62, 19, 62, 19
2021-08-27 21:44:27.014 TRACE c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :143  [32m86455791405633536 [0;39m <==        Row: 2021-08-26, 62, 19
2021-08-27 21:44:27.015 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 21:44:27.015 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 21:44:27.016 DEBUG c.h.k.m.EbookSnapshotMapperCust.get30Statistic    :137  [32m86455791405633536 [0;39m <==      Total: 1
2021-08-27 21:44:27.016 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 21:44:27.016 TRACE c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :143  [32m86455791405633537 [0;39m <==        Row: 2021-08-27, 62, 19, 0, 0
2021-08-27 21:44:27.016 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 21:44:27.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.getStatistic :137  [32m86455791405633537 [0;39m <==      Total: 2
2021-08-27 21:44:27.016 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 21:44:27.017 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 21:44:27.018 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 21:44:27.019 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 21:44:27.019 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 21:44:27.019 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 21:44:27.020 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 21:44:27.020 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 21:44:27.020 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 21:44:27.021 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 21:44:27.021 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86455791405633538 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 21:44:27.022 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86455791405633538 [0;39m <==      Total: 16
2021-08-27 21:44:27.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86455791405633538 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 21:44:27.054 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86455791405633538 [0;39m ------------- 结束 耗时：112 ms -------------
2021-08-27 21:44:27.055 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86455791405633536 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":0,"viewIncrease":62,"voteCount":0,"voteIncrease":19}],"success":true}
2021-08-27 21:44:27.055 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86455791405633537 [0;39m 返回结果: {"content":[{"date":1629907200000,"viewCount":62,"viewIncrease":62,"voteCount":19,"voteIncrease":19},{"date":1629993600000,"viewCount":62,"viewIncrease":0,"voteCount":19,"voteIncrease":0}],"success":true}
2021-08-27 21:44:27.056 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86455791405633536 [0;39m ------------- 结束 耗时：114 ms -------------
2021-08-27 21:44:27.056 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86455791405633537 [0;39m ------------- 结束 耗时：114 ms -------------
2021-08-27 21:44:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455804248592384 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455804248592384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455804248592384 [0;39m ==> Parameters: 
2021-08-27 21:44:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455804248592384 [0;39m <==    Updates: 0
2021-08-27 21:44:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455804248592384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:44:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455825245278208 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455825245278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455825245278208 [0;39m ==> Parameters: 
2021-08-27 21:44:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455825245278208 [0;39m <==    Updates: 0
2021-08-27 21:44:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455825245278208 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:44:35.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86455825257861120 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:44:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455825257861120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:44:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455825257861120 [0;39m ==> Parameters: 
2021-08-27 21:44:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455825257861120 [0;39m <==    Updates: 5
2021-08-27 21:44:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86455825257861120 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:44:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455846237769728 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455846237769728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455846237769728 [0;39m ==> Parameters: 
2021-08-27 21:44:40.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455846237769728 [0;39m <==    Updates: 0
2021-08-27 21:44:40.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455846237769728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:44:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455867163152384 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455867163152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455867163152384 [0;39m ==> Parameters: 
2021-08-27 21:44:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455867163152384 [0;39m <==    Updates: 0
2021-08-27 21:44:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455867163152384 [0;39m 生成今日电子书快照结束，耗时：5毫秒
2021-08-27 21:44:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455888151449600 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455888151449600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455888151449600 [0;39m ==> Parameters: 
2021-08-27 21:44:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455888151449600 [0;39m <==    Updates: 0
2021-08-27 21:44:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455888151449600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:44:55.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455909093609472 [0;39m 生成今日电子书快照开始
2021-08-27 21:44:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455909093609472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:44:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455909093609472 [0;39m ==> Parameters: 
2021-08-27 21:44:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455909093609472 [0;39m <==    Updates: 0
2021-08-27 21:44:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455909093609472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:45:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455930081906688 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455930081906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455930081906688 [0;39m ==> Parameters: 
2021-08-27 21:45:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455930081906688 [0;39m <==    Updates: 0
2021-08-27 21:45:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455930081906688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:45:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86455951074398208 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:45:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455951074398208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:45:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455951074398208 [0;39m ==> Parameters: 
2021-08-27 21:45:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86455951074398208 [0;39m <==    Updates: 5
2021-08-27 21:45:05.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86455951074398208 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:45:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455951082786816 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455951082786816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455951082786816 [0;39m ==> Parameters: 
2021-08-27 21:45:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455951082786816 [0;39m <==    Updates: 0
2021-08-27 21:45:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455951082786816 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:45:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455972008169472 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455972008169472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455972008169472 [0;39m ==> Parameters: 
2021-08-27 21:45:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455972008169472 [0;39m <==    Updates: 0
2021-08-27 21:45:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455972008169472 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:45:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86455993013243904 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455993013243904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455993013243904 [0;39m ==> Parameters: 
2021-08-27 21:45:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86455993013243904 [0;39m <==    Updates: 0
2021-08-27 21:45:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86455993013243904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:45:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456013963792384 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456013963792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456013963792384 [0;39m ==> Parameters: 
2021-08-27 21:45:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456013963792384 [0;39m <==    Updates: 0
2021-08-27 21:45:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456013963792384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:45:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456034947895296 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456034947895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456034947895296 [0;39m ==> Parameters: 
2021-08-27 21:45:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456034947895296 [0;39m <==    Updates: 0
2021-08-27 21:45:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456034947895296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:45:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456055936192512 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456055936192512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456055936192512 [0;39m ==> Parameters: 
2021-08-27 21:45:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456055936192512 [0;39m <==    Updates: 0
2021-08-27 21:45:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456055936192512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:45:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86456076907712512 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:45:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456076907712512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:45:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456076907712512 [0;39m ==> Parameters: 
2021-08-27 21:45:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456076907712512 [0;39m <==    Updates: 5
2021-08-27 21:45:35.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86456076907712512 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:45:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456076916101120 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456076916101120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456076916101120 [0;39m ==> Parameters: 
2021-08-27 21:45:35.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456076916101120 [0;39m <==    Updates: 0
2021-08-27 21:45:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456076916101120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:45:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456097875038208 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456097875038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456097875038208 [0;39m ==> Parameters: 
2021-08-27 21:45:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456097875038208 [0;39m <==    Updates: 0
2021-08-27 21:45:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456097875038208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:45:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456118838169600 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456118838169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456118838169600 [0;39m ==> Parameters: 
2021-08-27 21:45:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456118838169600 [0;39m <==    Updates: 0
2021-08-27 21:45:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456118838169600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:45:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456139801300992 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:50.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456139801300992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456139801300992 [0;39m ==> Parameters: 
2021-08-27 21:45:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456139801300992 [0;39m <==    Updates: 0
2021-08-27 21:45:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456139801300992 [0;39m 生成今日电子书快照结束，耗时：8毫秒
2021-08-27 21:45:55.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456160756043776 [0;39m 生成今日电子书快照开始
2021-08-27 21:45:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456160756043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:45:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456160756043776 [0;39m ==> Parameters: 
2021-08-27 21:45:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456160756043776 [0;39m <==    Updates: 0
2021-08-27 21:45:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456160756043776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:46:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456181744340992 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456181744340992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456181744340992 [0;39m ==> Parameters: 
2021-08-27 21:46:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456181744340992 [0;39m <==    Updates: 0
2021-08-27 21:46:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456181744340992 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:46:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86456202753609728 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:46:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456202753609728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:46:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456202753609728 [0;39m ==> Parameters: 
2021-08-27 21:46:05.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456202753609728 [0;39m <==    Updates: 5
2021-08-27 21:46:05.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86456202753609728 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:46:05.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456202761998336 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:05.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456202761998336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:05.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456202761998336 [0;39m ==> Parameters: 
2021-08-27 21:46:05.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456202761998336 [0;39m <==    Updates: 0
2021-08-27 21:46:05.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456202761998336 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:46:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456223704158208 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456223704158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456223704158208 [0;39m ==> Parameters: 
2021-08-27 21:46:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456223704158208 [0;39m <==    Updates: 0
2021-08-27 21:46:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456223704158208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:46:13.290 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86456237461475328 [0;39m ------------- 开始 -------------
2021-08-27 21:46:13.291 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86456237461475328 [0;39m 请求地址: http://127.0.0.1:8880/user/login POST
2021-08-27 21:46:13.291 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86456237461475328 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.login
2021-08-27 21:46:13.291 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86456237461475328 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:46:13.292 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86456237461475328 [0;39m 请求参数: [{"loginName":"test"}]
2021-08-27 21:46:13.301 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86456237461475328 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user WHERE ( login_name = ? )
2021-08-27 21:46:13.302 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86456237461475328 [0;39m ==> Parameters: test(String)
2021-08-27 21:46:13.303 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86456237461475328 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 21:46:13.303 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86456237461475328 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 21:46:13.303 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86456237461475328 [0;39m <==      Total: 1
2021-08-27 21:46:13.306 INFO  com.haoyu.knowlagebase.controller.UserController  :81   [32m86456237461475328 [0;39m 生成单点登录token：86456237528584192，并放入redis中
2021-08-27 21:46:14.230 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86456237461475328 [0;39m 返回结果: {"content":{"id":1,"loginName":"test","name":"测试","token":"86456237528584192"},"success":true}
2021-08-27 21:46:14.231 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86456237461475328 [0;39m ------------- 结束 耗时：941 ms -------------
2021-08-27 21:46:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456244696649728 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456244696649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:15.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456244696649728 [0;39m ==> Parameters: 
2021-08-27 21:46:15.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456244696649728 [0;39m <==    Updates: 0
2021-08-27 21:46:15.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456244696649728 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:46:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456265638809600 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456265638809600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456265638809600 [0;39m ==> Parameters: 
2021-08-27 21:46:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456265638809600 [0;39m <==    Updates: 0
2021-08-27 21:46:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456265638809600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:46:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456286631301120 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456286631301120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456286631301120 [0;39m ==> Parameters: 
2021-08-27 21:46:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456286631301120 [0;39m <==    Updates: 0
2021-08-27 21:46:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456286631301120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:46:29.239 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 21:46:29.240 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m                  [0;39m ------------- LoginInterceptor 结束 耗时：1 ms -------------
2021-08-27 21:46:29.242 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m                  [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 21:46:29.242 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :43   [32m                  [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/user/list
2021-08-27 21:46:29.242 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :47   [32m                  [0;39m 登录校验开始，token：86456237528584192
2021-08-27 21:46:29.245 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :59   [32m                  [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"86456237528584192"}
2021-08-27 21:46:29.265 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86456304465481728 [0;39m ------------- 开始 -------------
2021-08-27 21:46:29.265 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86456304465481728 [0;39m 请求地址: http://127.0.0.1:8880/user/list GET
2021-08-27 21:46:29.265 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86456304465481728 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.list
2021-08-27 21:46:29.265 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86456304465481728 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:46:29.266 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86456304465481728 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 21:46:29.287 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86456304465481728 [0;39m ==>  Preparing: SELECT count(0) FROM user
2021-08-27 21:46:29.287 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86456304465481728 [0;39m ==> Parameters: 
2021-08-27 21:46:29.288 TRACE c.h.k.mapper.UserMapper.selectByExample_COUNT     :143  [32m86456304465481728 [0;39m <==    Columns: count(0)
2021-08-27 21:46:29.289 TRACE c.h.k.mapper.UserMapper.selectByExample_COUNT     :143  [32m86456304465481728 [0;39m <==        Row: 2
2021-08-27 21:46:29.289 DEBUG c.h.k.mapper.UserMapper.selectByExample_COUNT     :137  [32m86456304465481728 [0;39m <==      Total: 1
2021-08-27 21:46:29.291 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86456304465481728 [0;39m ==>  Preparing: select id, login_name, `name`, `password` from user LIMIT ?
2021-08-27 21:46:29.291 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86456304465481728 [0;39m ==> Parameters: 10(Integer)
2021-08-27 21:46:29.292 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86456304465481728 [0;39m <==    Columns: id, login_name, name, password
2021-08-27 21:46:29.293 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86456304465481728 [0;39m <==        Row: 1, test, 测试, e70e2222a9d67c4f2eae107533359aa4
2021-08-27 21:46:29.293 TRACE c.h.knowlagebase.mapper.UserMapper.selectByExample:143  [32m86456304465481728 [0;39m <==        Row: 84603304096698368, 11111, 111111, b9207c7ae418edcbdef11219daae3474
2021-08-27 21:46:29.294 DEBUG c.h.knowlagebase.mapper.UserMapper.selectByExample:137  [32m86456304465481728 [0;39m <==      Total: 2
2021-08-27 21:46:29.295 INFO  com.haoyu.knowlagebase.service.UserService        :52   [32m86456304465481728 [0;39m 总行数:2
2021-08-27 21:46:29.295 INFO  com.haoyu.knowlagebase.service.UserService        :53   [32m86456304465481728 [0;39m 总页数:1
2021-08-27 21:46:29.299 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86456304465481728 [0;39m 返回结果: {"content":{"list":[{"id":1,"loginName":"test","name":"测试"},{"id":84603304096698368,"loginName":"11111","name":"111111"}],"total":2},"success":true}
2021-08-27 21:46:29.299 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86456304465481728 [0;39m ------------- 结束 耗时：34 ms -------------
2021-08-27 21:46:29.302 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m86456304465481728 [0;39m ------------- LoginInterceptor 结束 耗时：60 ms -------------
2021-08-27 21:46:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456307586043904 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456307586043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456307586043904 [0;39m ==> Parameters: 
2021-08-27 21:46:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456307586043904 [0;39m <==    Updates: 0
2021-08-27 21:46:30.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456307586043904 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:46:35.002 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86456328528203776 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:46:35.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456328528203776 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:46:35.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456328528203776 [0;39m ==> Parameters: 
2021-08-27 21:46:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456328528203776 [0;39m <==    Updates: 5
2021-08-27 21:46:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86456328528203776 [0;39m 更新电子书下的文档数据结束，耗时：3毫秒
2021-08-27 21:46:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456328540786688 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456328540786688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456328540786688 [0;39m ==> Parameters: 
2021-08-27 21:46:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456328540786688 [0;39m <==    Updates: 0
2021-08-27 21:46:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456328540786688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:46:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456349533278208 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456349533278208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456349533278208 [0;39m ==> Parameters: 
2021-08-27 21:46:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456349533278208 [0;39m <==    Updates: 0
2021-08-27 21:46:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456349533278208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:46:42.998 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86456362065858560 [0;39m ------------- 开始 -------------
2021-08-27 21:46:42.998 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86456362065858560 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 21:46:42.999 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86456362065858560 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 21:46:42.999 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86456362065858560 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:46:42.999 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86456362065858560 [0;39m 请求参数: []
2021-08-27 21:46:43.000 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86456362065858560 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 21:46:43.000 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86456362065858560 [0;39m ==> Parameters: 
2021-08-27 21:46:43.001 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 21:46:43.001 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 21:46:43.001 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 21:46:43.002 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 21:46:43.002 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 21:46:43.002 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 21:46:43.002 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 21:46:43.002 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 21:46:43.003 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 21:46:43.003 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 21:46:43.003 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 21:46:43.003 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 21:46:43.004 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 21:46:43.004 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 21:46:43.004 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 21:46:43.004 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 21:46:43.004 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456362065858560 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 21:46:43.005 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86456362065858560 [0;39m <==      Total: 16
2021-08-27 21:46:43.005 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86456362065858560 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 21:46:43.006 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86456362065858560 [0;39m ------------- 结束 耗时：8 ms -------------
2021-08-27 21:46:43.035 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86456362221047808 [0;39m ------------- 开始 -------------
2021-08-27 21:46:43.035 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86456362221047808 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 21:46:43.035 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86456362221047808 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 21:46:43.035 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86456362221047808 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:46:43.037 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86456362221047808 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 21:46:43.041 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86456362221047808 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-08-27 21:46:43.041 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86456362221047808 [0;39m ==> Parameters: 
2021-08-27 21:46:43.042 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86456362221047808 [0;39m <==    Columns: count(0)
2021-08-27 21:46:43.042 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86456362221047808 [0;39m <==        Row: 7
2021-08-27 21:46:43.042 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86456362221047808 [0;39m <==      Total: 1
2021-08-27 21:46:43.043 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86456362221047808 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-08-27 21:46:43.043 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86456362221047808 [0;39m ==> Parameters: 10(Integer)
2021-08-27 21:46:43.044 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456362221047808 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 21:46:43.044 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456362221047808 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 21:46:43.044 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456362221047808 [0;39m <==        Row: 2, Vue 入门教程, 100, 101, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover1.png, 0, 0, 0
2021-08-27 21:46:43.044 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456362221047808 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 21:46:43.045 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456362221047808 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 21:46:43.045 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456362221047808 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 21:46:43.046 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456362221047808 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 21:46:43.046 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456362221047808 [0;39m <==        Row: 85670061133664256, 111, 100, 82110017238601728, 111, 111, 3, 3, 3
2021-08-27 21:46:43.047 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86456362221047808 [0;39m <==      Total: 7
2021-08-27 21:46:43.047 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86456362221047808 [0;39m 总行数:7
2021-08-27 21:46:43.047 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86456362221047808 [0;39m 总页数:1
2021-08-27 21:46:43.055 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86456362221047808 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3},{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1},{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":82110017238601728,"cover":"111","description":"111","docCount":3,"id":85670061133664256,"name":"111","viewCount":3,"voteCount":3}],"total":7},"success":true}
2021-08-27 21:46:43.055 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86456362221047808 [0;39m ------------- 结束 耗时：20 ms -------------
2021-08-27 21:46:45.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456370462855168 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:45.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456370462855168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:45.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456370462855168 [0;39m ==> Parameters: 
2021-08-27 21:46:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456370462855168 [0;39m <==    Updates: 0
2021-08-27 21:46:45.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456370462855168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:46:50.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456391472123904 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456391472123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456391472123904 [0;39m ==> Parameters: 
2021-08-27 21:46:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456391472123904 [0;39m <==    Updates: 0
2021-08-27 21:46:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456391472123904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:46:55.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456412414283776 [0;39m 生成今日电子书快照开始
2021-08-27 21:46:55.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456412414283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:46:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456412414283776 [0;39m ==> Parameters: 
2021-08-27 21:46:55.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456412414283776 [0;39m <==    Updates: 0
2021-08-27 21:46:55.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456412414283776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:47:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456433398386688 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456433398386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456433398386688 [0;39m ==> Parameters: 
2021-08-27 21:47:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456433398386688 [0;39m <==    Updates: 0
2021-08-27 21:47:00.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456433398386688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:47:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456454403461120 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456454403461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456454403461120 [0;39m ==> Parameters: 
2021-08-27 21:47:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456454403461120 [0;39m <==    Updates: 0
2021-08-27 21:47:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456454403461120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:47:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86456454411849728 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:47:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456454411849728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:47:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456454411849728 [0;39m ==> Parameters: 
2021-08-27 21:47:05.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456454411849728 [0;39m <==    Updates: 5
2021-08-27 21:47:05.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86456454411849728 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:47:10.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456475341426688 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456475341426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456475341426688 [0;39m ==> Parameters: 
2021-08-27 21:47:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456475341426688 [0;39m <==    Updates: 0
2021-08-27 21:47:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456475341426688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:47:15.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456496333918208 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456496333918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456496333918208 [0;39m ==> Parameters: 
2021-08-27 21:47:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456496333918208 [0;39m <==    Updates: 0
2021-08-27 21:47:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456496333918208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:47:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456517313826816 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456517313826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456517313826816 [0;39m ==> Parameters: 
2021-08-27 21:47:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456517313826816 [0;39m <==    Updates: 0
2021-08-27 21:47:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456517313826816 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:47:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456538281152512 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456538281152512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456538281152512 [0;39m ==> Parameters: 
2021-08-27 21:47:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456538281152512 [0;39m <==    Updates: 0
2021-08-27 21:47:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456538281152512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:47:27.778 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86456549886791680 [0;39m ------------- 开始 -------------
2021-08-27 21:47:27.779 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86456549886791680 [0;39m 请求地址: http://127.0.0.1:8880/doc/all/1 GET
2021-08-27 21:47:27.779 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86456549886791680 [0;39m 类名方法: com.haoyu.knowlagebase.controller.DocController.all
2021-08-27 21:47:27.779 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86456549886791680 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:47:27.779 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86456549886791680 [0;39m 请求参数: [1]
2021-08-27 21:47:27.787 DEBUG c.h.knowlagebase.mapper.DocMapper.selectByExample :137  [32m86456549886791680 [0;39m ==>  Preparing: select id, ebook_id, parent, `name`, sort, view_count, vote_count from doc WHERE ( ebook_id = ? ) order by sort asc
2021-08-27 21:47:27.787 DEBUG c.h.knowlagebase.mapper.DocMapper.selectByExample :137  [32m86456549886791680 [0;39m ==> Parameters: 1(Long)
2021-08-27 21:47:27.789 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==    Columns: id, ebook_id, parent, name, sort, view_count, vote_count
2021-08-27 21:47:27.789 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 1, 1, 0, Ant Design Vue, 1, 24, 2
2021-08-27 21:47:27.789 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 2, 1, 1, 文档1.1, 1, 2, 0
2021-08-27 21:47:27.790 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 4, 1, 3, 文档2.1, 1, 3, 1
2021-08-27 21:47:27.790 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 6, 1, 5, 文档2.2.1, 1, 2, 1
2021-08-27 21:47:27.790 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 85747953192538112, 1, 2, 8, 1, 1, 1
2021-08-27 21:47:27.791 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 85749087462363136, 1, 2, 9, 1, 1, 1
2021-08-27 21:47:27.791 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 85750049518260224, 1, 2, 10, 1, 1, 1
2021-08-27 21:47:27.791 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 3, 1, 0, 文档2, 2, 1, 0
2021-08-27 21:47:27.792 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 5, 1, 3, 文档2.2, 2, 2, 1
2021-08-27 21:47:27.792 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 85739590006214656, 1, 2, 4444, 4, 1, 1
2021-08-27 21:47:27.792 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 85740865577947136, 1, 2, 6666, 6, 1, 1
2021-08-27 21:47:27.792 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 85746827776888832, 1, 2, 7, 7, 2, 1
2021-08-27 21:47:27.793 TRACE c.h.knowlagebase.mapper.DocMapper.selectByExample :143  [32m86456549886791680 [0;39m <==        Row: 85740705846267904, 1, 2, 555, 5555, 3, 1
2021-08-27 21:47:27.793 DEBUG c.h.knowlagebase.mapper.DocMapper.selectByExample :137  [32m86456549886791680 [0;39m <==      Total: 13
2021-08-27 21:47:27.798 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86456549886791680 [0;39m 返回结果: {"content":[{"ebookId":1,"id":1,"name":"Ant Design Vue","parent":0,"sort":1,"viewCount":24,"voteCount":2},{"ebookId":1,"id":2,"name":"文档1.1","parent":1,"sort":1,"viewCount":2,"voteCount":0},{"ebookId":1,"id":4,"name":"文档2.1","parent":3,"sort":1,"viewCount":3,"voteCount":1},{"ebookId":1,"id":6,"name":"文档2.2.1","parent":5,"sort":1,"viewCount":2,"voteCount":1},{"ebookId":1,"id":85747953192538112,"name":"8","parent":2,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85749087462363136,"name":"9","parent":2,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85750049518260224,"name":"10","parent":2,"sort":1,"viewCount":1,"voteCount":1},{"ebookId":1,"id":3,"name":"文档2","parent":0,"sort":2,"viewCount":1,"voteCount":0},{"ebookId":1,"id":5,"name":"文档2.2","parent":3,"sort":2,"viewCount":2,"voteCount":1},{"ebookId":1,"id":85739590006214656,"name":"4444","parent":2,"sort":4,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85740865577947136,"name":"6666","parent":2,"sort":6,"viewCount":1,"voteCount":1},{"ebookId":1,"id":85746827776888832,"name":"7","parent":2,"sort":7,"viewCount":2,"voteCount":1},{"ebookId":1,"id":85740705846267904,"name":"555","parent":2,"sort":5555,"viewCount":3,"voteCount":1}],"success":true}
2021-08-27 21:47:27.799 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86456549886791680 [0;39m ------------- 结束 耗时：21 ms -------------
2021-08-27 21:47:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456559235895296 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456559235895296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456559235895296 [0;39m ==> Parameters: 
2021-08-27 21:47:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456559235895296 [0;39m <==    Updates: 0
2021-08-27 21:47:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456559235895296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:47:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456580219998208 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456580219998208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456580219998208 [0;39m ==> Parameters: 
2021-08-27 21:47:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456580219998208 [0;39m <==    Updates: 0
2021-08-27 21:47:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456580219998208 [0;39m 生成今日电子书快照结束，耗时：4毫秒
2021-08-27 21:47:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86456580236775424 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:47:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456580236775424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:47:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456580236775424 [0;39m ==> Parameters: 
2021-08-27 21:47:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456580236775424 [0;39m <==    Updates: 5
2021-08-27 21:47:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86456580236775424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:47:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456601183129600 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456601183129600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456601183129600 [0;39m ==> Parameters: 
2021-08-27 21:47:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456601183129600 [0;39m <==    Updates: 0
2021-08-27 21:47:40.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456601183129600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:47:43.884 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86456617440251904 [0;39m ------------- 开始 -------------
2021-08-27 21:47:43.885 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86456617440251904 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 21:47:43.885 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86456617440251904 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 21:47:43.885 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86456617440251904 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:47:43.885 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86456617440251904 [0;39m 请求参数: []
2021-08-27 21:47:43.886 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86456617440251904 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 21:47:43.887 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86456617440251904 [0;39m ==> Parameters: 
2021-08-27 21:47:43.887 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 21:47:43.888 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 21:47:43.888 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 21:47:43.888 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 21:47:43.888 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 21:47:43.888 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 21:47:43.889 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 21:47:43.889 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 21:47:43.889 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 21:47:43.890 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 21:47:43.890 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 21:47:43.890 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 21:47:43.890 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 21:47:43.890 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 21:47:43.891 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 21:47:43.891 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 21:47:43.892 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456617440251904 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 21:47:43.892 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86456617440251904 [0;39m <==      Total: 16
2021-08-27 21:47:43.893 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86456617440251904 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 21:47:43.894 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86456617440251904 [0;39m ------------- 结束 耗时：10 ms -------------
2021-08-27 21:47:43.906 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86456617532526592 [0;39m ------------- 开始 -------------
2021-08-27 21:47:43.906 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86456617532526592 [0;39m 请求地址: http://127.0.0.1:8880/ebook/list GET
2021-08-27 21:47:43.906 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86456617532526592 [0;39m 类名方法: com.haoyu.knowlagebase.controller.EbookController.list
2021-08-27 21:47:43.906 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86456617532526592 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:47:43.907 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86456617532526592 [0;39m 请求参数: [{"page":1,"size":10}]
2021-08-27 21:47:43.908 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86456617532526592 [0;39m ==>  Preparing: SELECT count(0) FROM ebook
2021-08-27 21:47:43.908 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86456617532526592 [0;39m ==> Parameters: 
2021-08-27 21:47:43.909 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86456617532526592 [0;39m <==    Columns: count(0)
2021-08-27 21:47:43.909 TRACE c.h.k.mapper.EbookMapper.selectByExample_COUNT    :143  [32m86456617532526592 [0;39m <==        Row: 7
2021-08-27 21:47:43.909 DEBUG c.h.k.mapper.EbookMapper.selectByExample_COUNT    :137  [32m86456617532526592 [0;39m <==      Total: 1
2021-08-27 21:47:43.910 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86456617532526592 [0;39m ==>  Preparing: select id, `name`, category1_id, category2_id, description, cover, doc_count, view_count, vote_count from ebook LIMIT ?
2021-08-27 21:47:43.910 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86456617532526592 [0;39m ==> Parameters: 10(Integer)
2021-08-27 21:47:43.911 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456617532526592 [0;39m <==    Columns: id, name, category1_id, category2_id, description, cover, doc_count, view_count, vote_count
2021-08-27 21:47:43.911 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456617532526592 [0;39m <==        Row: 1, Spring Boot 入门教程, 200, 201, 零基础入门 Java 开发，企业级应用开发最佳首选框架, /image/cover2.png, 13, 44, 12
2021-08-27 21:47:43.911 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456617532526592 [0;39m <==        Row: 2, Vue 入门教程, 100, 101, 零基础入门 Vue 开发，企业级应用开发最佳首选框架, /image/cover1.png, 0, 0, 0
2021-08-27 21:47:43.911 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456617532526592 [0;39m <==        Row: 3, Python 入门教程, 300, 301, 零基础入门 Python 开发，企业级应用开发最佳首选框架, null, 3, 14, 3
2021-08-27 21:47:43.911 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456617532526592 [0;39m <==        Row: 4, Mysql 入门教程, 400, 401, 零基础入门 Mysql 开发，企业级应用开发最佳首选框架, null, 1, 0, 0
2021-08-27 21:47:43.912 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456617532526592 [0;39m <==        Row: 5, Oracle 入门教程, 400, 401, 零基础入门 Oracle 开发，企业级应用开发最佳首选框架, null, 1, 1, 1
2021-08-27 21:47:43.912 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456617532526592 [0;39m <==        Row: 83286321791111168, 1, 200, 202, 1, 1, 0, 0, 0
2021-08-27 21:47:43.912 TRACE c.h.k.mapper.EbookMapper.selectByExample          :143  [32m86456617532526592 [0;39m <==        Row: 85670061133664256, 111, 100, 82110017238601728, 111, 111, 3, 3, 3
2021-08-27 21:47:43.912 DEBUG c.h.k.mapper.EbookMapper.selectByExample          :137  [32m86456617532526592 [0;39m <==      Total: 7
2021-08-27 21:47:43.912 INFO  com.haoyu.knowlagebase.service.EbookService       :49   [32m86456617532526592 [0;39m 总行数:7
2021-08-27 21:47:43.912 INFO  com.haoyu.knowlagebase.service.EbookService       :50   [32m86456617532526592 [0;39m 总页数:1
2021-08-27 21:47:43.913 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86456617532526592 [0;39m 返回结果: {"content":{"list":[{"category1Id":200,"category2Id":201,"cover":"/image/cover2.png","description":"零基础入门 Java 开发，企业级应用开发最佳首选框架","docCount":13,"id":1,"name":"Spring Boot 入门教程","viewCount":44,"voteCount":12},{"category1Id":100,"category2Id":101,"cover":"/image/cover1.png","description":"零基础入门 Vue 开发，企业级应用开发最佳首选框架","docCount":0,"id":2,"name":"Vue 入门教程","viewCount":0,"voteCount":0},{"category1Id":300,"category2Id":301,"description":"零基础入门 Python 开发，企业级应用开发最佳首选框架","docCount":3,"id":3,"name":"Python 入门教程","viewCount":14,"voteCount":3},{"category1Id":400,"category2Id":401,"description":"零基础入门 Mysql 开发，企业级应用开发最佳首选框架","docCount":1,"id":4,"name":"Mysql 入门教程","viewCount":0,"voteCount":0},{"category1Id":400,"category2Id":401,"description":"零基础入门 Oracle 开发，企业级应用开发最佳首选框架","docCount":1,"id":5,"name":"Oracle 入门教程","viewCount":1,"voteCount":1},{"category1Id":200,"category2Id":202,"cover":"1","description":"1","docCount":0,"id":83286321791111168,"name":"1","viewCount":0,"voteCount":0},{"category1Id":100,"category2Id":82110017238601728,"cover":"111","description":"111","docCount":3,"id":85670061133664256,"name":"111","viewCount":3,"voteCount":3}],"total":7},"success":true}
2021-08-27 21:47:43.913 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86456617532526592 [0;39m ------------- 结束 耗时：7 ms -------------
2021-08-27 21:47:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456622171426816 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456622171426816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456622171426816 [0;39m ==> Parameters: 
2021-08-27 21:47:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456622171426816 [0;39m <==    Updates: 0
2021-08-27 21:47:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456622171426816 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:47:49.754 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86456642060816384 [0;39m ------------- 开始 -------------
2021-08-27 21:47:49.754 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86456642060816384 [0;39m 请求地址: http://127.0.0.1:8880/category/all GET
2021-08-27 21:47:49.754 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86456642060816384 [0;39m 类名方法: com.haoyu.knowlagebase.controller.CategoryController.all
2021-08-27 21:47:49.755 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86456642060816384 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:47:49.755 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86456642060816384 [0;39m 请求参数: []
2021-08-27 21:47:49.755 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86456642060816384 [0;39m ==>  Preparing: select id, parent, `name`, sort from category order by sort asc
2021-08-27 21:47:49.755 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86456642060816384 [0;39m ==> Parameters: 
2021-08-27 21:47:49.756 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==    Columns: id, parent, name, sort
2021-08-27 21:47:49.756 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 82110017238601728, 100, test2, 1
2021-08-27 21:47:49.757 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 100, 0, 前端开发, 100
2021-08-27 21:47:49.757 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 101, 100, Vue, 101
2021-08-27 21:47:49.757 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 102, 100, HTML & CSS, 102
2021-08-27 21:47:49.757 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 200, 0, Java, 200
2021-08-27 21:47:49.757 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 201, 200, 基础应用, 201
2021-08-27 21:47:49.757 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 202, 200, 框架应用, 202
2021-08-27 21:47:49.758 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 300, 0, Python, 300
2021-08-27 21:47:49.758 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 301, 300, 基础应用, 301
2021-08-27 21:47:49.758 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 302, 300, 进阶方向应用, 302
2021-08-27 21:47:49.758 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 400, 0, 数据库, 400
2021-08-27 21:47:49.758 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 401, 400, MySQL, 401
2021-08-27 21:47:49.758 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 500, 0, 其它, 500
2021-08-27 21:47:49.758 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 501, 500, 服务器, 501
2021-08-27 21:47:49.759 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 502, 500, 开发工具, 502
2021-08-27 21:47:49.759 TRACE c.h.k.mapper.CategoryMapper.selectByExample       :143  [32m86456642060816384 [0;39m <==        Row: 503, 500, 热门服务端语言, 503
2021-08-27 21:47:49.759 DEBUG c.h.k.mapper.CategoryMapper.selectByExample       :137  [32m86456642060816384 [0;39m <==      Total: 16
2021-08-27 21:47:49.759 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86456642060816384 [0;39m 返回结果: {"content":[{"id":82110017238601728,"name":"test2","parent":100,"sort":1},{"id":100,"name":"前端开发","parent":0,"sort":100},{"id":101,"name":"Vue","parent":100,"sort":101},{"id":102,"name":"HTML & CSS","parent":100,"sort":102},{"id":200,"name":"Java","parent":0,"sort":200},{"id":201,"name":"基础应用","parent":200,"sort":201},{"id":202,"name":"框架应用","parent":200,"sort":202},{"id":300,"name":"Python","parent":0,"sort":300},{"id":301,"name":"基础应用","parent":300,"sort":301},{"id":302,"name":"进阶方向应用","parent":300,"sort":302},{"id":400,"name":"数据库","parent":0,"sort":400},{"id":401,"name":"MySQL","parent":400,"sort":401},{"id":500,"name":"其它","parent":0,"sort":500},{"id":501,"name":"服务器","parent":500,"sort":501},{"id":502,"name":"开发工具","parent":500,"sort":502},{"id":503,"name":"热门服务端语言","parent":500,"sort":503}],"success":true}
2021-08-27 21:47:49.760 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86456642060816384 [0;39m ------------- 结束 耗时：6 ms -------------
2021-08-27 21:47:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456643159724032 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456643159724032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:50.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456643159724032 [0;39m ==> Parameters: 
2021-08-27 21:47:50.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456643159724032 [0;39m <==    Updates: 0
2021-08-27 21:47:50.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456643159724032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:47:55.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456664097689600 [0;39m 生成今日电子书快照开始
2021-08-27 21:47:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456664097689600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:47:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456664097689600 [0;39m ==> Parameters: 
2021-08-27 21:47:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456664097689600 [0;39m <==    Updates: 0
2021-08-27 21:47:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456664097689600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:48:00.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456685069209600 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456685069209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456685069209600 [0;39m ==> Parameters: 
2021-08-27 21:48:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456685069209600 [0;39m <==    Updates: 0
2021-08-27 21:48:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456685069209600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:48:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456706036535296 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456706036535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456706036535296 [0;39m ==> Parameters: 
2021-08-27 21:48:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456706036535296 [0;39m <==    Updates: 0
2021-08-27 21:48:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456706036535296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:48:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86456706049118208 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:48:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456706049118208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:48:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456706049118208 [0;39m ==> Parameters: 
2021-08-27 21:48:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456706049118208 [0;39m <==    Updates: 5
2021-08-27 21:48:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86456706049118208 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:48:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456726982889472 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456726982889472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456726982889472 [0;39m ==> Parameters: 
2021-08-27 21:48:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456726982889472 [0;39m <==    Updates: 0
2021-08-27 21:48:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456726982889472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:48:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456747966992384 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456747966992384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456747966992384 [0;39m ==> Parameters: 
2021-08-27 21:48:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456747966992384 [0;39m <==    Updates: 0
2021-08-27 21:48:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456747966992384 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:48:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456768963678208 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456768963678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456768963678208 [0;39m ==> Parameters: 
2021-08-27 21:48:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456768963678208 [0;39m <==    Updates: 0
2021-08-27 21:48:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456768963678208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:48:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456789951975424 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456789951975424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456789951975424 [0;39m ==> Parameters: 
2021-08-27 21:48:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456789951975424 [0;39m <==    Updates: 0
2021-08-27 21:48:25.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456789951975424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:48:30.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456810915106816 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456810915106816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456810915106816 [0;39m ==> Parameters: 
2021-08-27 21:48:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456810915106816 [0;39m <==    Updates: 0
2021-08-27 21:48:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456810915106816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:48:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456831874043904 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456831874043904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456831874043904 [0;39m ==> Parameters: 
2021-08-27 21:48:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456831874043904 [0;39m <==    Updates: 0
2021-08-27 21:48:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456831874043904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:48:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86456831882432512 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:48:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456831882432512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:48:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456831882432512 [0;39m ==> Parameters: 
2021-08-27 21:48:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456831882432512 [0;39m <==    Updates: 5
2021-08-27 21:48:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86456831882432512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:48:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456852837175296 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456852837175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456852837175296 [0;39m ==> Parameters: 
2021-08-27 21:48:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456852837175296 [0;39m <==    Updates: 0
2021-08-27 21:48:40.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456852837175296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:48:45.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456873787723776 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456873787723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456873787723776 [0;39m ==> Parameters: 
2021-08-27 21:48:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456873787723776 [0;39m <==    Updates: 0
2021-08-27 21:48:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456873787723776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:48:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456894801186816 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456894801186816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456894801186816 [0;39m ==> Parameters: 
2021-08-27 21:48:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456894801186816 [0;39m <==    Updates: 0
2021-08-27 21:48:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456894801186816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:48:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456915760123904 [0;39m 生成今日电子书快照开始
2021-08-27 21:48:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456915760123904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:48:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456915760123904 [0;39m ==> Parameters: 
2021-08-27 21:48:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456915760123904 [0;39m <==    Updates: 0
2021-08-27 21:48:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456915760123904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:49:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456936740032512 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456936740032512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456936740032512 [0;39m ==> Parameters: 
2021-08-27 21:49:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456936740032512 [0;39m <==    Updates: 0
2021-08-27 21:49:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456936740032512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:49:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456957694775296 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456957694775296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456957694775296 [0;39m ==> Parameters: 
2021-08-27 21:49:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456957694775296 [0;39m <==    Updates: 0
2021-08-27 21:49:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456957694775296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:49:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86456957707358208 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:49:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456957707358208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:49:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456957707358208 [0;39m ==> Parameters: 
2021-08-27 21:49:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86456957707358208 [0;39m <==    Updates: 5
2021-08-27 21:49:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86456957707358208 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:49:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456978653712384 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456978653712384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456978653712384 [0;39m ==> Parameters: 
2021-08-27 21:49:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456978653712384 [0;39m <==    Updates: 0
2021-08-27 21:49:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456978653712384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:49:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86456999637815296 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456999637815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456999637815296 [0;39m ==> Parameters: 
2021-08-27 21:49:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86456999637815296 [0;39m <==    Updates: 0
2021-08-27 21:49:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86456999637815296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:49:20.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457020647084032 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457020647084032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:20.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457020647084032 [0;39m ==> Parameters: 
2021-08-27 21:49:20.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457020647084032 [0;39m <==    Updates: 0
2021-08-27 21:49:20.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457020647084032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:49:25.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457041580855296 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:25.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457041580855296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457041580855296 [0;39m ==> Parameters: 
2021-08-27 21:49:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457041580855296 [0;39m <==    Updates: 0
2021-08-27 21:49:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457041580855296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:49:30.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457062556569600 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457062556569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457062556569600 [0;39m ==> Parameters: 
2021-08-27 21:49:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457062556569600 [0;39m <==    Updates: 0
2021-08-27 21:49:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457062556569600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:49:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86457083523895296 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:49:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457083523895296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:49:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457083523895296 [0;39m ==> Parameters: 
2021-08-27 21:49:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457083523895296 [0;39m <==    Updates: 5
2021-08-27 21:49:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86457083523895296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:49:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457083528089600 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457083528089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457083528089600 [0;39m ==> Parameters: 
2021-08-27 21:49:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457083528089600 [0;39m <==    Updates: 0
2021-08-27 21:49:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457083528089600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:49:40.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457104503803904 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457104503803904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457104503803904 [0;39m ==> Parameters: 
2021-08-27 21:49:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457104503803904 [0;39m <==    Updates: 0
2021-08-27 21:49:40.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457104503803904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:49:45.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457125462740992 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457125462740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457125462740992 [0;39m ==> Parameters: 
2021-08-27 21:49:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457125462740992 [0;39m <==    Updates: 0
2021-08-27 21:49:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457125462740992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:49:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457146425872384 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457146425872384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457146425872384 [0;39m ==> Parameters: 
2021-08-27 21:49:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457146425872384 [0;39m <==    Updates: 0
2021-08-27 21:49:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457146425872384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:49:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457167409975296 [0;39m 生成今日电子书快照开始
2021-08-27 21:49:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457167409975296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:49:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457167409975296 [0;39m ==> Parameters: 
2021-08-27 21:49:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457167409975296 [0;39m <==    Updates: 0
2021-08-27 21:49:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457167409975296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:50:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457188394078208 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457188394078208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457188394078208 [0;39m ==> Parameters: 
2021-08-27 21:50:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457188394078208 [0;39m <==    Updates: 0
2021-08-27 21:50:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457188394078208 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:50:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86457209365598208 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:50:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457209365598208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:50:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457209365598208 [0;39m ==> Parameters: 
2021-08-27 21:50:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457209365598208 [0;39m <==    Updates: 5
2021-08-27 21:50:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86457209365598208 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:50:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457209369792512 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457209369792512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457209369792512 [0;39m ==> Parameters: 
2021-08-27 21:50:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457209369792512 [0;39m <==    Updates: 0
2021-08-27 21:50:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457209369792512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:50:10.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457230362284032 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:10.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457230362284032 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:10.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457230362284032 [0;39m ==> Parameters: 
2021-08-27 21:50:10.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457230362284032 [0;39m <==    Updates: 0
2021-08-27 21:50:10.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457230362284032 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:50:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457251325415424 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457251325415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457251325415424 [0;39m ==> Parameters: 
2021-08-27 21:50:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457251325415424 [0;39m <==    Updates: 0
2021-08-27 21:50:15.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457251325415424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:50:20.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457272288546816 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457272288546816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457272288546816 [0;39m ==> Parameters: 
2021-08-27 21:50:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457272288546816 [0;39m <==    Updates: 0
2021-08-27 21:50:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457272288546816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:50:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457293260066816 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457293260066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457293260066816 [0;39m ==> Parameters: 
2021-08-27 21:50:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457293260066816 [0;39m <==    Updates: 0
2021-08-27 21:50:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457293260066816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:50:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457314227392512 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457314227392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:30.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457314227392512 [0;39m ==> Parameters: 
2021-08-27 21:50:30.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457314227392512 [0;39m <==    Updates: 0
2021-08-27 21:50:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457314227392512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:50:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457335190523904 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457335190523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457335190523904 [0;39m ==> Parameters: 
2021-08-27 21:50:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457335190523904 [0;39m <==    Updates: 0
2021-08-27 21:50:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457335190523904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:50:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86457335198912512 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:50:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457335198912512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:50:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457335198912512 [0;39m ==> Parameters: 
2021-08-27 21:50:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457335198912512 [0;39m <==    Updates: 5
2021-08-27 21:50:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86457335198912512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:50:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457356136878080 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457356136878080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457356136878080 [0;39m ==> Parameters: 
2021-08-27 21:50:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457356136878080 [0;39m <==    Updates: 0
2021-08-27 21:50:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457356136878080 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:50:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457377141952512 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457377141952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:45.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457377141952512 [0;39m ==> Parameters: 
2021-08-27 21:50:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457377141952512 [0;39m <==    Updates: 0
2021-08-27 21:50:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457377141952512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:50:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457398100889600 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:50.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457398100889600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457398100889600 [0;39m ==> Parameters: 
2021-08-27 21:50:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457398100889600 [0;39m <==    Updates: 0
2021-08-27 21:50:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457398100889600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:50:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457419093381120 [0;39m 生成今日电子书快照开始
2021-08-27 21:50:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457419093381120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:50:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457419093381120 [0;39m ==> Parameters: 
2021-08-27 21:50:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457419093381120 [0;39m <==    Updates: 0
2021-08-27 21:50:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457419093381120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:51:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457440031346688 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457440031346688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457440031346688 [0;39m ==> Parameters: 
2021-08-27 21:51:00.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457440031346688 [0;39m <==    Updates: 0
2021-08-27 21:51:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457440031346688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:51:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86457460998672384 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:51:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457460998672384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:51:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457460998672384 [0;39m ==> Parameters: 
2021-08-27 21:51:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457460998672384 [0;39m <==    Updates: 5
2021-08-27 21:51:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86457460998672384 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:51:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457461007060992 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457461007060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457461007060992 [0;39m ==> Parameters: 
2021-08-27 21:51:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457461007060992 [0;39m <==    Updates: 0
2021-08-27 21:51:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457461007060992 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:51:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457481961803776 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457481961803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457481961803776 [0;39m ==> Parameters: 
2021-08-27 21:51:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457481961803776 [0;39m <==    Updates: 0
2021-08-27 21:51:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457481961803776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:51:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457502954295296 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457502954295296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457502954295296 [0;39m ==> Parameters: 
2021-08-27 21:51:15.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457502954295296 [0;39m <==    Updates: 0
2021-08-27 21:51:15.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457502954295296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:51:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457523959369728 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457523959369728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457523959369728 [0;39m ==> Parameters: 
2021-08-27 21:51:20.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457523959369728 [0;39m <==    Updates: 0
2021-08-27 21:51:20.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457523959369728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:51:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457544914112512 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457544914112512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457544914112512 [0;39m ==> Parameters: 
2021-08-27 21:51:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457544914112512 [0;39m <==    Updates: 0
2021-08-27 21:51:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457544914112512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:51:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457565847883776 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457565847883776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457565847883776 [0;39m ==> Parameters: 
2021-08-27 21:51:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457565847883776 [0;39m <==    Updates: 0
2021-08-27 21:51:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457565847883776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:51:35.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457586811015168 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:35.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457586811015168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:35.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457586811015168 [0;39m ==> Parameters: 
2021-08-27 21:51:35.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457586811015168 [0;39m <==    Updates: 0
2021-08-27 21:51:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457586811015168 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:51:35.003 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86457586823598080 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:51:35.003 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457586823598080 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:51:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457586823598080 [0;39m ==> Parameters: 
2021-08-27 21:51:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457586823598080 [0;39m <==    Updates: 5
2021-08-27 21:51:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86457586823598080 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:51:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457607824478208 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457607824478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457607824478208 [0;39m ==> Parameters: 
2021-08-27 21:51:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457607824478208 [0;39m <==    Updates: 0
2021-08-27 21:51:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457607824478208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:51:45.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457628766638080 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457628766638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457628766638080 [0;39m ==> Parameters: 
2021-08-27 21:51:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457628766638080 [0;39m <==    Updates: 0
2021-08-27 21:51:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457628766638080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:51:50.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457649742352384 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457649742352384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457649742352384 [0;39m ==> Parameters: 
2021-08-27 21:51:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457649742352384 [0;39m <==    Updates: 0
2021-08-27 21:51:50.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457649742352384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:51:55.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457670705483776 [0;39m 生成今日电子书快照开始
2021-08-27 21:51:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457670705483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:51:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457670705483776 [0;39m ==> Parameters: 
2021-08-27 21:51:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457670705483776 [0;39m <==    Updates: 0
2021-08-27 21:51:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457670705483776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:52:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457691714752512 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457691714752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457691714752512 [0;39m ==> Parameters: 
2021-08-27 21:52:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457691714752512 [0;39m <==    Updates: 0
2021-08-27 21:52:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457691714752512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:52:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457712686272512 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457712686272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457712686272512 [0;39m ==> Parameters: 
2021-08-27 21:52:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457712686272512 [0;39m <==    Updates: 0
2021-08-27 21:52:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457712686272512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:52:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86457712694661120 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:52:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457712694661120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:52:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457712694661120 [0;39m ==> Parameters: 
2021-08-27 21:52:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457712694661120 [0;39m <==    Updates: 5
2021-08-27 21:52:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86457712694661120 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:52:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457733666181120 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457733666181120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457733666181120 [0;39m ==> Parameters: 
2021-08-27 21:52:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457733666181120 [0;39m <==    Updates: 0
2021-08-27 21:52:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457733666181120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:52:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457754591563776 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457754591563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457754591563776 [0;39m ==> Parameters: 
2021-08-27 21:52:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457754591563776 [0;39m <==    Updates: 0
2021-08-27 21:52:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457754591563776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:52:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457775588249600 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457775588249600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457775588249600 [0;39m ==> Parameters: 
2021-08-27 21:52:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457775588249600 [0;39m <==    Updates: 0
2021-08-27 21:52:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457775588249600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:52:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457796589129728 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457796589129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:25.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457796589129728 [0;39m ==> Parameters: 
2021-08-27 21:52:25.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457796589129728 [0;39m <==    Updates: 0
2021-08-27 21:52:25.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457796589129728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:52:30.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457817560649728 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457817560649728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:30.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457817560649728 [0;39m ==> Parameters: 
2021-08-27 21:52:30.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457817560649728 [0;39m <==    Updates: 0
2021-08-27 21:52:30.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457817560649728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:52:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86457838527975424 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:52:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457838527975424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:52:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457838527975424 [0;39m ==> Parameters: 
2021-08-27 21:52:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457838527975424 [0;39m <==    Updates: 5
2021-08-27 21:52:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86457838527975424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:52:35.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457838532169728 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457838532169728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:35.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457838532169728 [0;39m ==> Parameters: 
2021-08-27 21:52:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457838532169728 [0;39m <==    Updates: 0
2021-08-27 21:52:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457838532169728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:52:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457859474329600 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457859474329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457859474329600 [0;39m ==> Parameters: 
2021-08-27 21:52:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457859474329600 [0;39m <==    Updates: 0
2021-08-27 21:52:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457859474329600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:52:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457880466821120 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457880466821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457880466821120 [0;39m ==> Parameters: 
2021-08-27 21:52:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457880466821120 [0;39m <==    Updates: 0
2021-08-27 21:52:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457880466821120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:52:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457901438341120 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457901438341120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457901438341120 [0;39m ==> Parameters: 
2021-08-27 21:52:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457901438341120 [0;39m <==    Updates: 0
2021-08-27 21:52:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457901438341120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:52:55.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457922409861120 [0;39m 生成今日电子书快照开始
2021-08-27 21:52:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457922409861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:52:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457922409861120 [0;39m ==> Parameters: 
2021-08-27 21:52:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457922409861120 [0;39m <==    Updates: 0
2021-08-27 21:52:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457922409861120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:53:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457943372992512 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457943372992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457943372992512 [0;39m ==> Parameters: 
2021-08-27 21:53:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457943372992512 [0;39m <==    Updates: 0
2021-08-27 21:53:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457943372992512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:53:05.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457964306763776 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457964306763776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457964306763776 [0;39m ==> Parameters: 
2021-08-27 21:53:05.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457964306763776 [0;39m <==    Updates: 0
2021-08-27 21:53:05.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457964306763776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:53:05.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86457964319346688 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:53:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457964319346688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:53:05.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457964319346688 [0;39m ==> Parameters: 
2021-08-27 21:53:05.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86457964319346688 [0;39m <==    Updates: 5
2021-08-27 21:53:05.006 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86457964319346688 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:53:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86457985311838208 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457985311838208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457985311838208 [0;39m ==> Parameters: 
2021-08-27 21:53:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86457985311838208 [0;39m <==    Updates: 0
2021-08-27 21:53:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86457985311838208 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:53:15.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458006283358208 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:15.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458006283358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:15.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458006283358208 [0;39m ==> Parameters: 
2021-08-27 21:53:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458006283358208 [0;39m <==    Updates: 0
2021-08-27 21:53:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458006283358208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:53:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458027259072512 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458027259072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458027259072512 [0;39m ==> Parameters: 
2021-08-27 21:53:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458027259072512 [0;39m <==    Updates: 0
2021-08-27 21:53:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458027259072512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:53:25.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458048222203904 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458048222203904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458048222203904 [0;39m ==> Parameters: 
2021-08-27 21:53:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458048222203904 [0;39m <==    Updates: 0
2021-08-27 21:53:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458048222203904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:53:30.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458069218889728 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458069218889728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458069218889728 [0;39m ==> Parameters: 
2021-08-27 21:53:30.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458069218889728 [0;39m <==    Updates: 0
2021-08-27 21:53:30.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458069218889728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:53:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86458090161049600 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:53:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458090161049600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:53:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458090161049600 [0;39m ==> Parameters: 
2021-08-27 21:53:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458090161049600 [0;39m <==    Updates: 5
2021-08-27 21:53:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86458090161049600 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:53:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458090169438208 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458090169438208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458090169438208 [0;39m ==> Parameters: 
2021-08-27 21:53:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458090169438208 [0;39m <==    Updates: 0
2021-08-27 21:53:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458090169438208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:53:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458111115792384 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458111115792384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458111115792384 [0;39m ==> Parameters: 
2021-08-27 21:53:40.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458111115792384 [0;39m <==    Updates: 0
2021-08-27 21:53:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458111115792384 [0;39m 生成今日电子书快照结束，耗时：6毫秒
2021-08-27 21:53:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458132104089600 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458132104089600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458132104089600 [0;39m ==> Parameters: 
2021-08-27 21:53:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458132104089600 [0;39m <==    Updates: 0
2021-08-27 21:53:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458132104089600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:53:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458153100775424 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458153100775424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458153100775424 [0;39m ==> Parameters: 
2021-08-27 21:53:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458153100775424 [0;39m <==    Updates: 0
2021-08-27 21:53:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458153100775424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:53:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458174034546688 [0;39m 生成今日电子书快照开始
2021-08-27 21:53:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458174034546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:53:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458174034546688 [0;39m ==> Parameters: 
2021-08-27 21:53:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458174034546688 [0;39m <==    Updates: 0
2021-08-27 21:53:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458174034546688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458195027038208 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458195027038208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458195027038208 [0;39m ==> Parameters: 
2021-08-27 21:54:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458195027038208 [0;39m <==    Updates: 0
2021-08-27 21:54:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458195027038208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86458215994363904 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:54:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458215994363904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:54:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458215994363904 [0;39m ==> Parameters: 
2021-08-27 21:54:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458215994363904 [0;39m <==    Updates: 5
2021-08-27 21:54:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86458215994363904 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:54:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458216002752512 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458216002752512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458216002752512 [0;39m ==> Parameters: 
2021-08-27 21:54:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458216002752512 [0;39m <==    Updates: 0
2021-08-27 21:54:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458216002752512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:54:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458236986855424 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458236986855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458236986855424 [0;39m ==> Parameters: 
2021-08-27 21:54:10.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458236986855424 [0;39m <==    Updates: 0
2021-08-27 21:54:10.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458236986855424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458257908043776 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458257908043776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458257908043776 [0;39m ==> Parameters: 
2021-08-27 21:54:15.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458257908043776 [0;39m <==    Updates: 0
2021-08-27 21:54:15.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458257908043776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458278887952384 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458278887952384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458278887952384 [0;39m ==> Parameters: 
2021-08-27 21:54:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458278887952384 [0;39m <==    Updates: 0
2021-08-27 21:54:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458278887952384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458299893026816 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458299893026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458299893026816 [0;39m ==> Parameters: 
2021-08-27 21:54:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458299893026816 [0;39m <==    Updates: 0
2021-08-27 21:54:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458299893026816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458320851963904 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458320851963904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458320851963904 [0;39m ==> Parameters: 
2021-08-27 21:54:30.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458320851963904 [0;39m <==    Updates: 0
2021-08-27 21:54:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458320851963904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458341831872512 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458341831872512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:35.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458341831872512 [0;39m ==> Parameters: 
2021-08-27 21:54:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458341831872512 [0;39m <==    Updates: 0
2021-08-27 21:54:35.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458341831872512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:35.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86458341844455424 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:54:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458341844455424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:54:35.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458341844455424 [0;39m ==> Parameters: 
2021-08-27 21:54:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458341844455424 [0;39m <==    Updates: 5
2021-08-27 21:54:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86458341844455424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:54:40.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458362811781120 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458362811781120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:40.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458362811781120 [0;39m ==> Parameters: 
2021-08-27 21:54:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458362811781120 [0;39m <==    Updates: 0
2021-08-27 21:54:40.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458362811781120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458383766523904 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458383766523904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458383766523904 [0;39m ==> Parameters: 
2021-08-27 21:54:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458383766523904 [0;39m <==    Updates: 0
2021-08-27 21:54:45.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458383766523904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:54:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458404746432512 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458404746432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458404746432512 [0;39m ==> Parameters: 
2021-08-27 21:54:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458404746432512 [0;39m <==    Updates: 0
2021-08-27 21:54:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458404746432512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:54:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458425701175296 [0;39m 生成今日电子书快照开始
2021-08-27 21:54:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458425701175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:54:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458425701175296 [0;39m ==> Parameters: 
2021-08-27 21:54:55.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458425701175296 [0;39m <==    Updates: 0
2021-08-27 21:54:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458425701175296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458446702055424 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458446702055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:00.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458446702055424 [0;39m ==> Parameters: 
2021-08-27 21:55:00.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458446702055424 [0;39m <==    Updates: 0
2021-08-27 21:55:00.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458446702055424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86458467648409600 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:55:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458467648409600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:55:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458467648409600 [0;39m ==> Parameters: 
2021-08-27 21:55:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458467648409600 [0;39m <==    Updates: 5
2021-08-27 21:55:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86458467648409600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:55:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458467652603904 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458467652603904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458467652603904 [0;39m ==> Parameters: 
2021-08-27 21:55:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458467652603904 [0;39m <==    Updates: 0
2021-08-27 21:55:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458467652603904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:55:10.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458488628318208 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:10.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458488628318208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:10.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458488628318208 [0;39m ==> Parameters: 
2021-08-27 21:55:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458488628318208 [0;39m <==    Updates: 0
2021-08-27 21:55:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458488628318208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:15.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458509557895168 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:15.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458509557895168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458509557895168 [0;39m ==> Parameters: 
2021-08-27 21:55:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458509557895168 [0;39m <==    Updates: 0
2021-08-27 21:55:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458509557895168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458530567163904 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458530567163904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458530567163904 [0;39m ==> Parameters: 
2021-08-27 21:55:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458530567163904 [0;39m <==    Updates: 0
2021-08-27 21:55:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458530567163904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:25.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458551534489600 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:25.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458551534489600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:25.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458551534489600 [0;39m ==> Parameters: 
2021-08-27 21:55:25.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458551534489600 [0;39m <==    Updates: 0
2021-08-27 21:55:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458551534489600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458572501815296 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458572501815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:30.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458572501815296 [0;39m ==> Parameters: 
2021-08-27 21:55:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458572501815296 [0;39m <==    Updates: 0
2021-08-27 21:55:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458572501815296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86458593506889728 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:55:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458593506889728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:55:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458593506889728 [0;39m ==> Parameters: 
2021-08-27 21:55:35.017 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458593506889728 [0;39m <==    Updates: 5
2021-08-27 21:55:35.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86458593506889728 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:55:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458593515278336 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458593515278336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:35.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458593515278336 [0;39m ==> Parameters: 
2021-08-27 21:55:35.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458593515278336 [0;39m <==    Updates: 0
2021-08-27 21:55:35.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458593515278336 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458614436466688 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458614436466688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458614436466688 [0;39m ==> Parameters: 
2021-08-27 21:55:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458614436466688 [0;39m <==    Updates: 0
2021-08-27 21:55:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458614436466688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458635420569600 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458635420569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458635420569600 [0;39m ==> Parameters: 
2021-08-27 21:55:45.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458635420569600 [0;39m <==    Updates: 0
2021-08-27 21:55:45.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458635420569600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458656408866816 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458656408866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458656408866816 [0;39m ==> Parameters: 
2021-08-27 21:55:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458656408866816 [0;39m <==    Updates: 0
2021-08-27 21:55:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458656408866816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:55:55.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458677338443776 [0;39m 生成今日电子书快照开始
2021-08-27 21:55:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458677338443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:55:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458677338443776 [0;39m ==> Parameters: 
2021-08-27 21:55:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458677338443776 [0;39m <==    Updates: 0
2021-08-27 21:55:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458677338443776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:56:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458698347712512 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458698347712512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458698347712512 [0;39m ==> Parameters: 
2021-08-27 21:56:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458698347712512 [0;39m <==    Updates: 0
2021-08-27 21:56:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458698347712512 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:56:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86458719319232512 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:56:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458719319232512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:56:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458719319232512 [0;39m ==> Parameters: 
2021-08-27 21:56:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458719319232512 [0;39m <==    Updates: 5
2021-08-27 21:56:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86458719319232512 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:56:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458719327621120 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458719327621120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:05.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458719327621120 [0;39m ==> Parameters: 
2021-08-27 21:56:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458719327621120 [0;39m <==    Updates: 0
2021-08-27 21:56:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458719327621120 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:56:07.314 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m86455791405633538 [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 21:56:07.314 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m86455791405633538 [0;39m ------------- LoginInterceptor 结束 耗时：0 ms -------------
2021-08-27 21:56:07.316 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :32   [32m86456362065858560 [0;39m ------------- LoginInterceptor 开始 -------------
2021-08-27 21:56:07.316 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :43   [32m86456362065858560 [0;39m 接口登录拦截：，path：http://127.0.0.1:8880/user/logout/86456237528584192
2021-08-27 21:56:07.317 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :47   [32m86456362065858560 [0;39m 登录校验开始，token：86456237528584192
2021-08-27 21:56:07.317 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :59   [32m86456362065858560 [0;39m 已登录：{"id":1,"loginName":"test","name":"测试","token":"86456237528584192"}
2021-08-27 21:56:07.323 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :54   [32m86458729016463360 [0;39m ------------- 开始 -------------
2021-08-27 21:56:07.323 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :55   [32m86458729016463360 [0;39m 请求地址: http://127.0.0.1:8880/user/logout/86456237528584192 GET
2021-08-27 21:56:07.323 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :56   [32m86458729016463360 [0;39m 类名方法: com.haoyu.knowlagebase.controller.UserController.logout
2021-08-27 21:56:07.323 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :57   [32m86458729016463360 [0;39m 远程地址: 127.0.0.1
2021-08-27 21:56:07.323 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :79   [32m86458729016463360 [0;39m 请求参数: ["86456237528584192"]
2021-08-27 21:56:07.325 INFO  com.haoyu.knowlagebase.controller.UserController  :93   [32m86458729016463360 [0;39m 从redis中删除token: 86456237528584192
2021-08-27 21:56:07.325 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :91   [32m86458729016463360 [0;39m 返回结果: {"success":true}
2021-08-27 21:56:07.325 INFO  com.haoyu.knowlagebase.aspect.LogAspect           :92   [32m86458729016463360 [0;39m ------------- 结束 耗时：2 ms -------------
2021-08-27 21:56:07.326 INFO  c.haoyu.knowlagebase.interceptor.LoginInterceptor :68   [32m86458729016463360 [0;39m ------------- LoginInterceptor 结束 耗时：10 ms -------------
2021-08-27 21:56:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458740248809472 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458740248809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458740248809472 [0;39m ==> Parameters: 
2021-08-27 21:56:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458740248809472 [0;39m <==    Updates: 0
2021-08-27 21:56:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458740248809472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:56:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458761274855424 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458761274855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458761274855424 [0;39m ==> Parameters: 
2021-08-27 21:56:15.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458761274855424 [0;39m <==    Updates: 0
2021-08-27 21:56:15.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458761274855424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:56:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458782242181120 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458782242181120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458782242181120 [0;39m ==> Parameters: 
2021-08-27 21:56:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458782242181120 [0;39m <==    Updates: 0
2021-08-27 21:56:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458782242181120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:56:25.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458803171758080 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458803171758080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458803171758080 [0;39m ==> Parameters: 
2021-08-27 21:56:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458803171758080 [0;39m <==    Updates: 0
2021-08-27 21:56:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458803171758080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:56:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458824147472384 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458824147472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458824147472384 [0;39m ==> Parameters: 
2021-08-27 21:56:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458824147472384 [0;39m <==    Updates: 0
2021-08-27 21:56:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458824147472384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:56:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458845123186688 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458845123186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458845123186688 [0;39m ==> Parameters: 
2021-08-27 21:56:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458845123186688 [0;39m <==    Updates: 0
2021-08-27 21:56:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458845123186688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:56:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86458845131575296 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:56:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458845131575296 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:56:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458845131575296 [0;39m ==> Parameters: 
2021-08-27 21:56:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458845131575296 [0;39m <==    Updates: 5
2021-08-27 21:56:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86458845131575296 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:56:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458866094706688 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458866094706688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458866094706688 [0;39m ==> Parameters: 
2021-08-27 21:56:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458866094706688 [0;39m <==    Updates: 0
2021-08-27 21:56:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458866094706688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:56:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458887095586816 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458887095586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458887095586816 [0;39m ==> Parameters: 
2021-08-27 21:56:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458887095586816 [0;39m <==    Updates: 0
2021-08-27 21:56:45.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458887095586816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:56:50.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458908020969472 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:50.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458908020969472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:50.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458908020969472 [0;39m ==> Parameters: 
2021-08-27 21:56:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458908020969472 [0;39m <==    Updates: 0
2021-08-27 21:56:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458908020969472 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:56:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458929038626816 [0;39m 生成今日电子书快照开始
2021-08-27 21:56:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458929038626816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:56:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458929038626816 [0;39m ==> Parameters: 
2021-08-27 21:56:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458929038626816 [0;39m <==    Updates: 0
2021-08-27 21:56:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458929038626816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:00.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458949968203776 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458949968203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:00.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458949968203776 [0;39m ==> Parameters: 
2021-08-27 21:57:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458949968203776 [0;39m <==    Updates: 0
2021-08-27 21:57:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458949968203776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:05.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458970960695296 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458970960695296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458970960695296 [0;39m ==> Parameters: 
2021-08-27 21:57:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458970960695296 [0;39m <==    Updates: 0
2021-08-27 21:57:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458970960695296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86458970969083904 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:57:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458970969083904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:57:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458970969083904 [0;39m ==> Parameters: 
2021-08-27 21:57:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86458970969083904 [0;39m <==    Updates: 5
2021-08-27 21:57:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86458970969083904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:57:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86458991928020992 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458991928020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458991928020992 [0;39m ==> Parameters: 
2021-08-27 21:57:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86458991928020992 [0;39m <==    Updates: 0
2021-08-27 21:57:10.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86458991928020992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:15.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459012874375168 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:15.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459012874375168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:15.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459012874375168 [0;39m ==> Parameters: 
2021-08-27 21:57:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459012874375168 [0;39m <==    Updates: 0
2021-08-27 21:57:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459012874375168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459033871060992 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459033871060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459033871060992 [0;39m ==> Parameters: 
2021-08-27 21:57:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459033871060992 [0;39m <==    Updates: 0
2021-08-27 21:57:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459033871060992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459054871941120 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459054871941120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459054871941120 [0;39m ==> Parameters: 
2021-08-27 21:57:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459054871941120 [0;39m <==    Updates: 0
2021-08-27 21:57:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459054871941120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459075826683904 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459075826683904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459075826683904 [0;39m ==> Parameters: 
2021-08-27 21:57:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459075826683904 [0;39m <==    Updates: 0
2021-08-27 21:57:30.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459075826683904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:57:35.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86459096777232384 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:57:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459096777232384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:57:35.006 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459096777232384 [0;39m ==> Parameters: 
2021-08-27 21:57:35.007 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459096777232384 [0;39m <==    Updates: 5
2021-08-27 21:57:35.007 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86459096777232384 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:57:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459096789815296 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459096789815296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459096789815296 [0;39m ==> Parameters: 
2021-08-27 21:57:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459096789815296 [0;39m <==    Updates: 0
2021-08-27 21:57:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459096789815296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:40.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459117773918208 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459117773918208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:40.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459117773918208 [0;39m ==> Parameters: 
2021-08-27 21:57:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459117773918208 [0;39m <==    Updates: 0
2021-08-27 21:57:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459117773918208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459138753826816 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459138753826816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459138753826816 [0;39m ==> Parameters: 
2021-08-27 21:57:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459138753826816 [0;39m <==    Updates: 0
2021-08-27 21:57:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459138753826816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459159708569600 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459159708569600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459159708569600 [0;39m ==> Parameters: 
2021-08-27 21:57:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459159708569600 [0;39m <==    Updates: 0
2021-08-27 21:57:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459159708569600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:57:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459180709449728 [0;39m 生成今日电子书快照开始
2021-08-27 21:57:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459180709449728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:57:55.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459180709449728 [0;39m ==> Parameters: 
2021-08-27 21:57:55.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459180709449728 [0;39m <==    Updates: 0
2021-08-27 21:57:55.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459180709449728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:58:00.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459201647415296 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459201647415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459201647415296 [0;39m ==> Parameters: 
2021-08-27 21:58:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459201647415296 [0;39m <==    Updates: 0
2021-08-27 21:58:00.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459201647415296 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:58:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459222614740992 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459222614740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459222614740992 [0;39m ==> Parameters: 
2021-08-27 21:58:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459222614740992 [0;39m <==    Updates: 0
2021-08-27 21:58:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459222614740992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:58:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86459222627323904 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:58:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459222627323904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:58:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459222627323904 [0;39m ==> Parameters: 
2021-08-27 21:58:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459222627323904 [0;39m <==    Updates: 5
2021-08-27 21:58:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86459222627323904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:58:10.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459243586260992 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459243586260992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459243586260992 [0;39m ==> Parameters: 
2021-08-27 21:58:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459243586260992 [0;39m <==    Updates: 0
2021-08-27 21:58:10.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459243586260992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:58:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459264591335424 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459264591335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459264591335424 [0;39m ==> Parameters: 
2021-08-27 21:58:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459264591335424 [0;39m <==    Updates: 0
2021-08-27 21:58:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459264591335424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:58:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459285562855424 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459285562855424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459285562855424 [0;39m ==> Parameters: 
2021-08-27 21:58:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459285562855424 [0;39m <==    Updates: 0
2021-08-27 21:58:20.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459285562855424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:58:25.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459306517598208 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459306517598208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459306517598208 [0;39m ==> Parameters: 
2021-08-27 21:58:25.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459306517598208 [0;39m <==    Updates: 0
2021-08-27 21:58:25.018 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459306517598208 [0;39m 生成今日电子书快照结束，耗时：7毫秒
2021-08-27 21:58:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459327455563776 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459327455563776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459327455563776 [0;39m ==> Parameters: 
2021-08-27 21:58:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459327455563776 [0;39m <==    Updates: 0
2021-08-27 21:58:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459327455563776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:58:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459348456443904 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459348456443904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459348456443904 [0;39m ==> Parameters: 
2021-08-27 21:58:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459348456443904 [0;39m <==    Updates: 0
2021-08-27 21:58:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459348456443904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:58:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86459348464832512 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:58:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459348464832512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:58:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459348464832512 [0;39m ==> Parameters: 
2021-08-27 21:58:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459348464832512 [0;39m <==    Updates: 5
2021-08-27 21:58:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86459348464832512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 21:58:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459369411186688 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459369411186688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459369411186688 [0;39m ==> Parameters: 
2021-08-27 21:58:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459369411186688 [0;39m <==    Updates: 0
2021-08-27 21:58:40.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459369411186688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:58:45.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459390412066816 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:45.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459390412066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:45.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459390412066816 [0;39m ==> Parameters: 
2021-08-27 21:58:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459390412066816 [0;39m <==    Updates: 0
2021-08-27 21:58:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459390412066816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:58:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459411375198208 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459411375198208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:50.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459411375198208 [0;39m ==> Parameters: 
2021-08-27 21:58:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459411375198208 [0;39m <==    Updates: 0
2021-08-27 21:58:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459411375198208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:58:55.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459432317358080 [0;39m 生成今日电子书快照开始
2021-08-27 21:58:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459432317358080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:58:55.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459432317358080 [0;39m ==> Parameters: 
2021-08-27 21:58:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459432317358080 [0;39m <==    Updates: 0
2021-08-27 21:58:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459432317358080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:59:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459453330821120 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459453330821120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459453330821120 [0;39m ==> Parameters: 
2021-08-27 21:59:00.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459453330821120 [0;39m <==    Updates: 0
2021-08-27 21:59:00.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459453330821120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:59:05.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459474256203776 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459474256203776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459474256203776 [0;39m ==> Parameters: 
2021-08-27 21:59:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459474256203776 [0;39m <==    Updates: 0
2021-08-27 21:59:05.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459474256203776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:59:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86459474264592384 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:59:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459474264592384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:59:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459474264592384 [0;39m ==> Parameters: 
2021-08-27 21:59:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459474264592384 [0;39m <==    Updates: 5
2021-08-27 21:59:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86459474264592384 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 21:59:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459495227723776 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459495227723776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459495227723776 [0;39m ==> Parameters: 
2021-08-27 21:59:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459495227723776 [0;39m <==    Updates: 0
2021-08-27 21:59:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459495227723776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:59:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459516236992512 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459516236992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459516236992512 [0;39m ==> Parameters: 
2021-08-27 21:59:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459516236992512 [0;39m <==    Updates: 0
2021-08-27 21:59:15.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459516236992512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:59:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459537221095424 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459537221095424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459537221095424 [0;39m ==> Parameters: 
2021-08-27 21:59:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459537221095424 [0;39m <==    Updates: 0
2021-08-27 21:59:20.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459537221095424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:59:25.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459558142283776 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459558142283776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:25.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459558142283776 [0;39m ==> Parameters: 
2021-08-27 21:59:25.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459558142283776 [0;39m <==    Updates: 0
2021-08-27 21:59:25.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459558142283776 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 21:59:30.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459579126386688 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:30.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459579126386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459579126386688 [0;39m ==> Parameters: 
2021-08-27 21:59:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459579126386688 [0;39m <==    Updates: 0
2021-08-27 21:59:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459579126386688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:59:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86459600139849728 [0;39m 更新电子书下的文档数据开始
2021-08-27 21:59:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459600139849728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 21:59:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459600139849728 [0;39m ==> Parameters: 
2021-08-27 21:59:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459600139849728 [0;39m <==    Updates: 5
2021-08-27 21:59:35.017 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86459600139849728 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 21:59:35.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459600148238336 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459600148238336 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:35.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459600148238336 [0;39m ==> Parameters: 
2021-08-27 21:59:35.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459600148238336 [0;39m <==    Updates: 0
2021-08-27 21:59:35.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459600148238336 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:59:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459621065232384 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459621065232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459621065232384 [0;39m ==> Parameters: 
2021-08-27 21:59:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459621065232384 [0;39m <==    Updates: 0
2021-08-27 21:59:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459621065232384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:59:45.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459642053529600 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459642053529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459642053529600 [0;39m ==> Parameters: 
2021-08-27 21:59:45.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459642053529600 [0;39m <==    Updates: 0
2021-08-27 21:59:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459642053529600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 21:59:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459663046021120 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459663046021120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459663046021120 [0;39m ==> Parameters: 
2021-08-27 21:59:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459663046021120 [0;39m <==    Updates: 0
2021-08-27 21:59:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459663046021120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 21:59:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459684021735424 [0;39m 生成今日电子书快照开始
2021-08-27 21:59:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459684021735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 21:59:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459684021735424 [0;39m ==> Parameters: 
2021-08-27 21:59:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459684021735424 [0;39m <==    Updates: 0
2021-08-27 21:59:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459684021735424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:00:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459704980672512 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459704980672512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459704980672512 [0;39m ==> Parameters: 
2021-08-27 22:00:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459704980672512 [0;39m <==    Updates: 0
2021-08-27 22:00:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459704980672512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:00:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86459725964775424 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:00:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459725964775424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:00:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459725964775424 [0;39m ==> Parameters: 
2021-08-27 22:00:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459725964775424 [0;39m <==    Updates: 5
2021-08-27 22:00:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86459725964775424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:00:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459725968969728 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459725968969728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:05.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459725968969728 [0;39m ==> Parameters: 
2021-08-27 22:00:05.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459725968969728 [0;39m <==    Updates: 0
2021-08-27 22:00:05.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459725968969728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:00:10.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459746898546688 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:10.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459746898546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:10.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459746898546688 [0;39m ==> Parameters: 
2021-08-27 22:00:10.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459746898546688 [0;39m <==    Updates: 0
2021-08-27 22:00:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459746898546688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:00:15.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459767895232512 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459767895232512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459767895232512 [0;39m ==> Parameters: 
2021-08-27 22:00:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459767895232512 [0;39m <==    Updates: 0
2021-08-27 22:00:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459767895232512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:00:20.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459788879335424 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:20.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459788879335424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:20.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459788879335424 [0;39m ==> Parameters: 
2021-08-27 22:00:20.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459788879335424 [0;39m <==    Updates: 0
2021-08-27 22:00:20.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459788879335424 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 22:00:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459809838272512 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459809838272512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459809838272512 [0;39m ==> Parameters: 
2021-08-27 22:00:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459809838272512 [0;39m <==    Updates: 0
2021-08-27 22:00:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459809838272512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:00:30.000 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459830763655168 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:30.000 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459830763655168 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459830763655168 [0;39m ==> Parameters: 
2021-08-27 22:00:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459830763655168 [0;39m <==    Updates: 0
2021-08-27 22:00:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459830763655168 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:00:35.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459851789701120 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:35.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459851789701120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:35.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459851789701120 [0;39m ==> Parameters: 
2021-08-27 22:00:35.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459851789701120 [0;39m <==    Updates: 0
2021-08-27 22:00:35.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459851789701120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:00:35.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86459851798089728 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:00:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459851798089728 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:00:35.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459851798089728 [0;39m ==> Parameters: 
2021-08-27 22:00:35.016 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459851798089728 [0;39m <==    Updates: 5
2021-08-27 22:00:35.016 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86459851798089728 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:00:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459872723472384 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459872723472384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459872723472384 [0;39m ==> Parameters: 
2021-08-27 22:00:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459872723472384 [0;39m <==    Updates: 0
2021-08-27 22:00:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459872723472384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:00:45.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459893741129728 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:45.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459893741129728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:45.018 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459893741129728 [0;39m ==> Parameters: 
2021-08-27 22:00:45.019 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459893741129728 [0;39m <==    Updates: 0
2021-08-27 22:00:45.019 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459893741129728 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 22:00:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459914700066816 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459914700066816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459914700066816 [0;39m ==> Parameters: 
2021-08-27 22:00:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459914700066816 [0;39m <==    Updates: 0
2021-08-27 22:00:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459914700066816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:00:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459935671586816 [0;39m 生成今日电子书快照开始
2021-08-27 22:00:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459935671586816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:00:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459935671586816 [0;39m ==> Parameters: 
2021-08-27 22:00:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459935671586816 [0;39m <==    Updates: 0
2021-08-27 22:00:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459935671586816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:01:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459956638912512 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459956638912512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459956638912512 [0;39m ==> Parameters: 
2021-08-27 22:01:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459956638912512 [0;39m <==    Updates: 0
2021-08-27 22:01:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459956638912512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:01:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459977610432512 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459977610432512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459977610432512 [0;39m ==> Parameters: 
2021-08-27 22:01:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459977610432512 [0;39m <==    Updates: 0
2021-08-27 22:01:05.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459977610432512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:01:05.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86459977618821120 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:01:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459977618821120 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:01:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459977618821120 [0;39m ==> Parameters: 
2021-08-27 22:01:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86459977618821120 [0;39m <==    Updates: 5
2021-08-27 22:01:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86459977618821120 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:01:10.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86459998565175296 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459998565175296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:10.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459998565175296 [0;39m ==> Parameters: 
2021-08-27 22:01:10.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86459998565175296 [0;39m <==    Updates: 0
2021-08-27 22:01:10.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86459998565175296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:01:15.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460019511529472 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460019511529472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460019511529472 [0;39m ==> Parameters: 
2021-08-27 22:01:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460019511529472 [0;39m <==    Updates: 0
2021-08-27 22:01:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460019511529472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:01:20.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460040499826688 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:20.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460040499826688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460040499826688 [0;39m ==> Parameters: 
2021-08-27 22:01:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460040499826688 [0;39m <==    Updates: 0
2021-08-27 22:01:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460040499826688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:01:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460061496512512 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460061496512512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460061496512512 [0;39m ==> Parameters: 
2021-08-27 22:01:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460061496512512 [0;39m <==    Updates: 0
2021-08-27 22:01:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460061496512512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:01:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460082447060992 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460082447060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460082447060992 [0;39m ==> Parameters: 
2021-08-27 22:01:30.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460082447060992 [0;39m <==    Updates: 0
2021-08-27 22:01:30.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460082447060992 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:01:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86460103426969600 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:01:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460103426969600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:01:35.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460103426969600 [0;39m ==> Parameters: 
2021-08-27 22:01:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460103426969600 [0;39m <==    Updates: 5
2021-08-27 22:01:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86460103426969600 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 22:01:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460103435358208 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460103435358208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460103435358208 [0;39m ==> Parameters: 
2021-08-27 22:01:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460103435358208 [0;39m <==    Updates: 0
2021-08-27 22:01:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460103435358208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:01:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460124381712384 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460124381712384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:40.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460124381712384 [0;39m ==> Parameters: 
2021-08-27 22:01:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460124381712384 [0;39m <==    Updates: 0
2021-08-27 22:01:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460124381712384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:01:45.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460145340649472 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:45.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460145340649472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460145340649472 [0;39m ==> Parameters: 
2021-08-27 22:01:45.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460145340649472 [0;39m <==    Updates: 0
2021-08-27 22:01:45.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460145340649472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:01:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460166341529600 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460166341529600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460166341529600 [0;39m ==> Parameters: 
2021-08-27 22:01:50.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460166341529600 [0;39m <==    Updates: 0
2021-08-27 22:01:50.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460166341529600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:01:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460187342409728 [0;39m 生成今日电子书快照开始
2021-08-27 22:01:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460187342409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:01:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460187342409728 [0;39m ==> Parameters: 
2021-08-27 22:01:55.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460187342409728 [0;39m <==    Updates: 0
2021-08-27 22:01:55.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460187342409728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:02:00.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460208271986688 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460208271986688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460208271986688 [0;39m ==> Parameters: 
2021-08-27 22:02:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460208271986688 [0;39m <==    Updates: 0
2021-08-27 22:02:00.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460208271986688 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 22:02:05.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86460229272866816 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:02:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460229272866816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:02:05.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460229272866816 [0;39m ==> Parameters: 
2021-08-27 22:02:05.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460229272866816 [0;39m <==    Updates: 5
2021-08-27 22:02:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86460229272866816 [0;39m 更新电子书下的文档数据结束，耗时：2毫秒
2021-08-27 22:02:05.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460229281255424 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460229281255424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:05.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460229281255424 [0;39m ==> Parameters: 
2021-08-27 22:02:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460229281255424 [0;39m <==    Updates: 0
2021-08-27 22:02:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460229281255424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:02:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460250206638080 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460250206638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460250206638080 [0;39m ==> Parameters: 
2021-08-27 22:02:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460250206638080 [0;39m <==    Updates: 0
2021-08-27 22:02:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460250206638080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:02:15.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460271186546688 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:15.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460271186546688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460271186546688 [0;39m ==> Parameters: 
2021-08-27 22:02:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460271186546688 [0;39m <==    Updates: 0
2021-08-27 22:02:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460271186546688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:02:20.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460292145483776 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:20.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460292145483776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:20.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460292145483776 [0;39m ==> Parameters: 
2021-08-27 22:02:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460292145483776 [0;39m <==    Updates: 0
2021-08-27 22:02:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460292145483776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:02:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460313163141120 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460313163141120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460313163141120 [0;39m ==> Parameters: 
2021-08-27 22:02:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460313163141120 [0;39m <==    Updates: 0
2021-08-27 22:02:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460313163141120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:02:30.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460334117883904 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460334117883904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:30.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460334117883904 [0;39m ==> Parameters: 
2021-08-27 22:02:30.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460334117883904 [0;39m <==    Updates: 0
2021-08-27 22:02:30.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460334117883904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:02:35.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86460355068432384 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:02:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460355068432384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:02:35.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460355068432384 [0;39m ==> Parameters: 
2021-08-27 22:02:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460355068432384 [0;39m <==    Updates: 5
2021-08-27 22:02:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86460355068432384 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:02:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460355072626688 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:35.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460355072626688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460355072626688 [0;39m ==> Parameters: 
2021-08-27 22:02:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460355072626688 [0;39m <==    Updates: 0
2021-08-27 22:02:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460355072626688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:02:40.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460376086089728 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460376086089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:40.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460376086089728 [0;39m ==> Parameters: 
2021-08-27 22:02:40.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460376086089728 [0;39m <==    Updates: 0
2021-08-27 22:02:40.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460376086089728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:02:45.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460397053415424 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460397053415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:45.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460397053415424 [0;39m ==> Parameters: 
2021-08-27 22:02:45.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460397053415424 [0;39m <==    Updates: 0
2021-08-27 22:02:45.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460397053415424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:02:50.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460417999769600 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:50.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460417999769600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460417999769600 [0;39m ==> Parameters: 
2021-08-27 22:02:50.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460417999769600 [0;39m <==    Updates: 0
2021-08-27 22:02:50.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460417999769600 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 22:02:55.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460438979678208 [0;39m 生成今日电子书快照开始
2021-08-27 22:02:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460438979678208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:02:55.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460438979678208 [0;39m ==> Parameters: 
2021-08-27 22:02:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460438979678208 [0;39m <==    Updates: 0
2021-08-27 22:02:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460438979678208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:03:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460459947003904 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460459947003904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:00.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460459947003904 [0;39m ==> Parameters: 
2021-08-27 22:03:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460459947003904 [0;39m <==    Updates: 0
2021-08-27 22:03:00.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460459947003904 [0;39m 生成今日电子书快照结束，耗时：3毫秒
2021-08-27 22:03:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460480914329600 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460480914329600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:05.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460480914329600 [0;39m ==> Parameters: 
2021-08-27 22:03:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460480914329600 [0;39m <==    Updates: 0
2021-08-27 22:03:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460480914329600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:03:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86460480922718208 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:03:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460480922718208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:03:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460480922718208 [0;39m ==> Parameters: 
2021-08-27 22:03:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460480922718208 [0;39m <==    Updates: 5
2021-08-27 22:03:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86460480922718208 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 22:03:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460501856489472 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460501856489472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460501856489472 [0;39m ==> Parameters: 
2021-08-27 22:03:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460501856489472 [0;39m <==    Updates: 0
2021-08-27 22:03:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460501856489472 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:03:15.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460522848980992 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460522848980992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:15.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460522848980992 [0;39m ==> Parameters: 
2021-08-27 22:03:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460522848980992 [0;39m <==    Updates: 0
2021-08-27 22:03:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460522848980992 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:03:20.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460543841472512 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460543841472512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:20.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460543841472512 [0;39m ==> Parameters: 
2021-08-27 22:03:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460543841472512 [0;39m <==    Updates: 0
2021-08-27 22:03:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460543841472512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:03:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460564812992512 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460564812992512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460564812992512 [0;39m ==> Parameters: 
2021-08-27 22:03:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460564812992512 [0;39m <==    Updates: 0
2021-08-27 22:03:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460564812992512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:03:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460585755152384 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460585755152384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460585755152384 [0;39m ==> Parameters: 
2021-08-27 22:03:30.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460585755152384 [0;39m <==    Updates: 0
2021-08-27 22:03:30.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460585755152384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:03:35.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460606747643904 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460606747643904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:35.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460606747643904 [0;39m ==> Parameters: 
2021-08-27 22:03:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460606747643904 [0;39m <==    Updates: 0
2021-08-27 22:03:35.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460606747643904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:03:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86460606756032512 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:03:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460606756032512 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:03:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460606756032512 [0;39m ==> Parameters: 
2021-08-27 22:03:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460606756032512 [0;39m <==    Updates: 5
2021-08-27 22:03:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86460606756032512 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:03:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460627693998080 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460627693998080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460627693998080 [0;39m ==> Parameters: 
2021-08-27 22:03:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460627693998080 [0;39m <==    Updates: 0
2021-08-27 22:03:40.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460627693998080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:03:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460648673906688 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460648673906688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460648673906688 [0;39m ==> Parameters: 
2021-08-27 22:03:45.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460648673906688 [0;39m <==    Updates: 0
2021-08-27 22:03:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460648673906688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:03:50.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460669637038080 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:50.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460669637038080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:50.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460669637038080 [0;39m ==> Parameters: 
2021-08-27 22:03:50.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460669637038080 [0;39m <==    Updates: 0
2021-08-27 22:03:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460669637038080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:03:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460690646306816 [0;39m 生成今日电子书快照开始
2021-08-27 22:03:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460690646306816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:03:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460690646306816 [0;39m ==> Parameters: 
2021-08-27 22:03:55.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460690646306816 [0;39m <==    Updates: 0
2021-08-27 22:03:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460690646306816 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:04:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460711613632512 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460711613632512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:00.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460711613632512 [0;39m ==> Parameters: 
2021-08-27 22:04:00.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460711613632512 [0;39m <==    Updates: 0
2021-08-27 22:04:00.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460711613632512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:04:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86460732572569600 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:04:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460732572569600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:04:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460732572569600 [0;39m ==> Parameters: 
2021-08-27 22:04:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460732572569600 [0;39m <==    Updates: 5
2021-08-27 22:04:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86460732572569600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:04:05.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460732576763904 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:05.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460732576763904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460732576763904 [0;39m ==> Parameters: 
2021-08-27 22:04:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460732576763904 [0;39m <==    Updates: 0
2021-08-27 22:04:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460732576763904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:04:10.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460753560866816 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460753560866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:10.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460753560866816 [0;39m ==> Parameters: 
2021-08-27 22:04:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460753560866816 [0;39m <==    Updates: 0
2021-08-27 22:04:10.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460753560866816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:04:15.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460774511415296 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460774511415296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:15.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460774511415296 [0;39m ==> Parameters: 
2021-08-27 22:04:15.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460774511415296 [0;39m <==    Updates: 0
2021-08-27 22:04:15.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460774511415296 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:04:20.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460795478740992 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460795478740992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:20.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460795478740992 [0;39m ==> Parameters: 
2021-08-27 22:04:20.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460795478740992 [0;39m <==    Updates: 0
2021-08-27 22:04:20.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460795478740992 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:04:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460816483815424 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460816483815424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460816483815424 [0;39m ==> Parameters: 
2021-08-27 22:04:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460816483815424 [0;39m <==    Updates: 0
2021-08-27 22:04:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460816483815424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:04:30.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460837400809472 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460837400809472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460837400809472 [0;39m ==> Parameters: 
2021-08-27 22:04:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460837400809472 [0;39m <==    Updates: 0
2021-08-27 22:04:30.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460837400809472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:04:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460858380718080 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460858380718080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460858380718080 [0;39m ==> Parameters: 
2021-08-27 22:04:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460858380718080 [0;39m <==    Updates: 0
2021-08-27 22:04:35.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460858380718080 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:04:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86460858389106688 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:04:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460858389106688 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:04:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460858389106688 [0;39m ==> Parameters: 
2021-08-27 22:04:35.005 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460858389106688 [0;39m <==    Updates: 5
2021-08-27 22:04:35.005 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86460858389106688 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 22:04:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460879373209600 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460879373209600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:40.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460879373209600 [0;39m ==> Parameters: 
2021-08-27 22:04:40.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460879373209600 [0;39m <==    Updates: 0
2021-08-27 22:04:40.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460879373209600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:04:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460900340535296 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460900340535296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460900340535296 [0;39m ==> Parameters: 
2021-08-27 22:04:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460900340535296 [0;39m <==    Updates: 0
2021-08-27 22:04:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460900340535296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:04:50.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460921333026816 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:50.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460921333026816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460921333026816 [0;39m ==> Parameters: 
2021-08-27 22:04:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460921333026816 [0;39m <==    Updates: 0
2021-08-27 22:04:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460921333026816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:04:55.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460942312935424 [0;39m 生成今日电子书快照开始
2021-08-27 22:04:55.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460942312935424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:04:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460942312935424 [0;39m ==> Parameters: 
2021-08-27 22:04:55.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460942312935424 [0;39m <==    Updates: 0
2021-08-27 22:04:55.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460942312935424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:05:00.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460963259289600 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460963259289600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:00.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460963259289600 [0;39m ==> Parameters: 
2021-08-27 22:05:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460963259289600 [0;39m <==    Updates: 0
2021-08-27 22:05:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460963259289600 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:05:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86460984239198208 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:05:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460984239198208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:05:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460984239198208 [0;39m ==> Parameters: 
2021-08-27 22:05:05.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86460984239198208 [0;39m <==    Updates: 5
2021-08-27 22:05:05.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86460984239198208 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:05:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86460984243392512 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460984243392512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460984243392512 [0;39m ==> Parameters: 
2021-08-27 22:05:05.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86460984243392512 [0;39m <==    Updates: 0
2021-08-27 22:05:05.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86460984243392512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:05:10.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461005177163776 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461005177163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461005177163776 [0;39m ==> Parameters: 
2021-08-27 22:05:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461005177163776 [0;39m <==    Updates: 0
2021-08-27 22:05:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461005177163776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:05:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461026199015424 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461026199015424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461026199015424 [0;39m ==> Parameters: 
2021-08-27 22:05:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461026199015424 [0;39m <==    Updates: 0
2021-08-27 22:05:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461026199015424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:05:20.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461047149563904 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461047149563904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461047149563904 [0;39m ==> Parameters: 
2021-08-27 22:05:20.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461047149563904 [0;39m <==    Updates: 0
2021-08-27 22:05:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461047149563904 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:05:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461068137861120 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461068137861120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:25.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461068137861120 [0;39m ==> Parameters: 
2021-08-27 22:05:25.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461068137861120 [0;39m <==    Updates: 0
2021-08-27 22:05:25.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461068137861120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:05:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461089063243776 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461089063243776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461089063243776 [0;39m ==> Parameters: 
2021-08-27 22:05:30.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461089063243776 [0;39m <==    Updates: 0
2021-08-27 22:05:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461089063243776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:05:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461110068318208 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461110068318208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461110068318208 [0;39m ==> Parameters: 
2021-08-27 22:05:35.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461110068318208 [0;39m <==    Updates: 0
2021-08-27 22:05:35.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461110068318208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:05:35.012 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86461110076706816 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:05:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461110076706816 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:05:35.012 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461110076706816 [0;39m ==> Parameters: 
2021-08-27 22:05:35.013 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461110076706816 [0;39m <==    Updates: 5
2021-08-27 22:05:35.013 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86461110076706816 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:05:40.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461131023060992 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461131023060992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:40.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461131023060992 [0;39m ==> Parameters: 
2021-08-27 22:05:40.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461131023060992 [0;39m <==    Updates: 0
2021-08-27 22:05:40.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461131023060992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:05:45.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461151977803776 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461151977803776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:45.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461151977803776 [0;39m ==> Parameters: 
2021-08-27 22:05:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461151977803776 [0;39m <==    Updates: 0
2021-08-27 22:05:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461151977803776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:05:50.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461172995461120 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461172995461120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:50.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461172995461120 [0;39m ==> Parameters: 
2021-08-27 22:05:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461172995461120 [0;39m <==    Updates: 0
2021-08-27 22:05:50.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461172995461120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:05:55.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461193933426688 [0;39m 生成今日电子书快照开始
2021-08-27 22:05:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461193933426688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:05:55.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461193933426688 [0;39m ==> Parameters: 
2021-08-27 22:05:55.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461193933426688 [0;39m <==    Updates: 0
2021-08-27 22:05:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461193933426688 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:00.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461214921723904 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461214921723904 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:00.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461214921723904 [0;39m ==> Parameters: 
2021-08-27 22:06:00.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461214921723904 [0;39m <==    Updates: 0
2021-08-27 22:06:00.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461214921723904 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:05.014 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86461235914215424 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:06:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461235914215424 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:06:05.014 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461235914215424 [0;39m ==> Parameters: 
2021-08-27 22:06:05.015 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461235914215424 [0;39m <==    Updates: 5
2021-08-27 22:06:05.015 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86461235914215424 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:06:05.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461235918409728 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461235918409728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:05.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461235918409728 [0;39m ==> Parameters: 
2021-08-27 22:06:05.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461235918409728 [0;39m <==    Updates: 0
2021-08-27 22:06:05.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461235918409728 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:06:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461256881541120 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461256881541120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:10.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461256881541120 [0;39m ==> Parameters: 
2021-08-27 22:06:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461256881541120 [0;39m <==    Updates: 0
2021-08-27 22:06:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461256881541120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:15.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461277848866816 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461277848866816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:15.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461277848866816 [0;39m ==> Parameters: 
2021-08-27 22:06:15.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461277848866816 [0;39m <==    Updates: 0
2021-08-27 22:06:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461277848866816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:20.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461298782638080 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461298782638080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:20.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461298782638080 [0;39m ==> Parameters: 
2021-08-27 22:06:20.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461298782638080 [0;39m <==    Updates: 0
2021-08-27 22:06:20.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461298782638080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:06:25.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461319791906816 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461319791906816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461319791906816 [0;39m ==> Parameters: 
2021-08-27 22:06:25.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461319791906816 [0;39m <==    Updates: 0
2021-08-27 22:06:25.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461319791906816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:30.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461340717289472 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461340717289472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:30.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461340717289472 [0;39m ==> Parameters: 
2021-08-27 22:06:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461340717289472 [0;39m <==    Updates: 0
2021-08-27 22:06:30.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461340717289472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:35.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461361718169600 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461361718169600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:35.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461361718169600 [0;39m ==> Parameters: 
2021-08-27 22:06:35.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461361718169600 [0;39m <==    Updates: 0
2021-08-27 22:06:35.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461361718169600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:35.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86461361726558208 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:06:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461361726558208 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:06:35.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461361726558208 [0;39m ==> Parameters: 
2021-08-27 22:06:35.011 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461361726558208 [0;39m <==    Updates: 5
2021-08-27 22:06:35.011 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86461361726558208 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:06:40.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461382706466816 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461382706466816 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:40.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461382706466816 [0;39m ==> Parameters: 
2021-08-27 22:06:40.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461382706466816 [0;39m <==    Updates: 0
2021-08-27 22:06:40.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461382706466816 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461403657015296 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461403657015296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461403657015296 [0;39m ==> Parameters: 
2021-08-27 22:06:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461403657015296 [0;39m <==    Updates: 0
2021-08-27 22:06:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461403657015296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461424657895424 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461424657895424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461424657895424 [0;39m ==> Parameters: 
2021-08-27 22:06:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461424657895424 [0;39m <==    Updates: 0
2021-08-27 22:06:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461424657895424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:06:55.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461445600055296 [0;39m 生成今日电子书快照开始
2021-08-27 22:06:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461445600055296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:06:55.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461445600055296 [0;39m ==> Parameters: 
2021-08-27 22:06:55.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461445600055296 [0;39m <==    Updates: 0
2021-08-27 22:06:55.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461445600055296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:07:00.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461466550603776 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461466550603776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:00.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461466550603776 [0;39m ==> Parameters: 
2021-08-27 22:07:00.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461466550603776 [0;39m <==    Updates: 0
2021-08-27 22:07:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461466550603776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:07:05.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461487522123776 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461487522123776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:05.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461487522123776 [0;39m ==> Parameters: 
2021-08-27 22:07:05.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461487522123776 [0;39m <==    Updates: 0
2021-08-27 22:07:05.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461487522123776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:07:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86461487530512384 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:07:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461487530512384 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:07:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461487530512384 [0;39m ==> Parameters: 
2021-08-27 22:07:05.004 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461487530512384 [0;39m <==    Updates: 5
2021-08-27 22:07:05.004 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86461487530512384 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 22:07:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461508497838080 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461508497838080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461508497838080 [0;39m ==> Parameters: 
2021-08-27 22:07:10.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461508497838080 [0;39m <==    Updates: 0
2021-08-27 22:07:10.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461508497838080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:07:15.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461529465163776 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461529465163776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:15.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461529465163776 [0;39m ==> Parameters: 
2021-08-27 22:07:15.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461529465163776 [0;39m <==    Updates: 0
2021-08-27 22:07:15.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461529465163776 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:07:20.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461550461849600 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461550461849600 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:20.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461550461849600 [0;39m ==> Parameters: 
2021-08-27 22:07:20.009 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461550461849600 [0;39m <==    Updates: 0
2021-08-27 22:07:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461550461849600 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:07:25.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461571445952512 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461571445952512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:25.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461571445952512 [0;39m ==> Parameters: 
2021-08-27 22:07:25.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461571445952512 [0;39m <==    Updates: 0
2021-08-27 22:07:25.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461571445952512 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:07:30.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461592430055424 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461592430055424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:30.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461592430055424 [0;39m ==> Parameters: 
2021-08-27 22:07:30.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461592430055424 [0;39m <==    Updates: 0
2021-08-27 22:07:30.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461592430055424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:07:35.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461613368020992 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461613368020992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:35.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461613368020992 [0;39m ==> Parameters: 
2021-08-27 22:07:35.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461613368020992 [0;39m <==    Updates: 0
2021-08-27 22:07:35.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461613368020992 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:07:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86461613376409600 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:07:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461613376409600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:07:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461613376409600 [0;39m ==> Parameters: 
2021-08-27 22:07:35.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461613376409600 [0;39m <==    Updates: 5
2021-08-27 22:07:35.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86461613376409600 [0;39m 更新电子书下的文档数据结束，耗时：0毫秒
2021-08-27 22:07:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461634326958080 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461634326958080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461634326958080 [0;39m ==> Parameters: 
2021-08-27 22:07:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461634326958080 [0;39m <==    Updates: 0
2021-08-27 22:07:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461634326958080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:07:45.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461655302672384 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461655302672384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:45.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461655302672384 [0;39m ==> Parameters: 
2021-08-27 22:07:45.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461655302672384 [0;39m <==    Updates: 0
2021-08-27 22:07:45.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461655302672384 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:07:50.005 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461676278386688 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461676278386688 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:50.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461676278386688 [0;39m ==> Parameters: 
2021-08-27 22:07:50.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461676278386688 [0;39m <==    Updates: 0
2021-08-27 22:07:50.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461676278386688 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:07:55.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461697275072512 [0;39m 生成今日电子书快照开始
2021-08-27 22:07:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461697275072512 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:07:55.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461697275072512 [0;39m ==> Parameters: 
2021-08-27 22:07:55.012 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461697275072512 [0;39m <==    Updates: 0
2021-08-27 22:07:55.012 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461697275072512 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:08:00.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461718217232384 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:00.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461718217232384 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:00.005 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461718217232384 [0;39m ==> Parameters: 
2021-08-27 22:08:00.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461718217232384 [0;39m <==    Updates: 0
2021-08-27 22:08:00.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461718217232384 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:08:05.006 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461739197140992 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461739197140992 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:05.006 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461739197140992 [0;39m ==> Parameters: 
2021-08-27 22:08:05.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461739197140992 [0;39m <==    Updates: 0
2021-08-27 22:08:05.008 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461739197140992 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:08:05.008 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86461739205529600 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:08:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461739205529600 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:08:05.008 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461739205529600 [0;39m ==> Parameters: 
2021-08-27 22:08:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461739205529600 [0;39m <==    Updates: 5
2021-08-27 22:08:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86461739205529600 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:08:10.001 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461760147689472 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:10.001 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461760147689472 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:10.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461760147689472 [0;39m ==> Parameters: 
2021-08-27 22:08:10.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461760147689472 [0;39m <==    Updates: 0
2021-08-27 22:08:10.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461760147689472 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:08:15.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461781173735424 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461781173735424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:15.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461781173735424 [0;39m ==> Parameters: 
2021-08-27 22:08:15.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461781173735424 [0;39m <==    Updates: 0
2021-08-27 22:08:15.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461781173735424 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:08:20.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461802128478208 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461802128478208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:20.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461802128478208 [0;39m ==> Parameters: 
2021-08-27 22:08:20.013 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461802128478208 [0;39m <==    Updates: 0
2021-08-27 22:08:20.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461802128478208 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:08:25.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461823066443776 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461823066443776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:25.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461823066443776 [0;39m ==> Parameters: 
2021-08-27 22:08:25.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461823066443776 [0;39m <==    Updates: 0
2021-08-27 22:08:25.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461823066443776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:08:30.002 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461844037963776 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461844037963776 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:30.002 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461844037963776 [0;39m ==> Parameters: 
2021-08-27 22:08:30.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461844037963776 [0;39m <==    Updates: 0
2021-08-27 22:08:30.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461844037963776 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:08:35.000 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86461865001095168 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:08:35.001 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461865001095168 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:08:35.001 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461865001095168 [0;39m ==> Parameters: 
2021-08-27 22:08:35.001 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461865001095168 [0;39m <==    Updates: 5
2021-08-27 22:08:35.001 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86461865001095168 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:08:35.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461865013678080 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461865013678080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:35.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461865013678080 [0;39m ==> Parameters: 
2021-08-27 22:08:35.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461865013678080 [0;39m <==    Updates: 0
2021-08-27 22:08:35.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461865013678080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:08:40.003 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461885985198080 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461885985198080 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:40.003 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461885985198080 [0;39m ==> Parameters: 
2021-08-27 22:08:40.004 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461885985198080 [0;39m <==    Updates: 0
2021-08-27 22:08:40.004 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461885985198080 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:08:45.007 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461906973495296 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461906973495296 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:45.007 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461906973495296 [0;39m ==> Parameters: 
2021-08-27 22:08:45.008 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461906973495296 [0;39m <==    Updates: 0
2021-08-27 22:08:45.009 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461906973495296 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:08:50.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461927974375424 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461927974375424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:50.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461927974375424 [0;39m ==> Parameters: 
2021-08-27 22:08:50.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461927974375424 [0;39m <==    Updates: 0
2021-08-27 22:08:50.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461927974375424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:08:55.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461948950089728 [0;39m 生成今日电子书快照开始
2021-08-27 22:08:55.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461948950089728 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:08:55.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461948950089728 [0;39m ==> Parameters: 
2021-08-27 22:08:55.017 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461948950089728 [0;39m <==    Updates: 0
2021-08-27 22:08:55.017 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461948950089728 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:09:00.014 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461969917415424 [0;39m 生成今日电子书快照开始
2021-08-27 22:09:00.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461969917415424 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:09:00.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461969917415424 [0;39m ==> Parameters: 
2021-08-27 22:09:00.016 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461969917415424 [0;39m <==    Updates: 0
2021-08-27 22:09:00.016 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461969917415424 [0;39m 生成今日电子书快照结束，耗时：2毫秒
2021-08-27 22:09:05.009 INFO  com.haoyu.knowlagebase.job.DocJob                 :33   [32m86461990867963904 [0;39m 更新电子书下的文档数据开始
2021-08-27 22:09:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461990867963904 [0;39m ==>  Preparing: update ebook t1, (select ebook_id, count(1) doc_count, sum(view_count) view_count, sum(vote_count) vote_count from doc group by ebook_id) t2 set t1.doc_count = t2.doc_count, t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.id = t2.ebook_id
2021-08-27 22:09:05.009 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461990867963904 [0;39m ==> Parameters: 
2021-08-27 22:09:05.010 DEBUG c.h.k.mapper.DocMapperCust.updateEbookInfo        :137  [32m86461990867963904 [0;39m <==    Updates: 5
2021-08-27 22:09:05.010 INFO  com.haoyu.knowlagebase.job.DocJob                 :36   [32m86461990867963904 [0;39m 更新电子书下的文档数据结束，耗时：1毫秒
2021-08-27 22:09:05.010 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86461990872158208 [0;39m 生成今日电子书快照开始
2021-08-27 22:09:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461990872158208 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:09:05.010 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461990872158208 [0;39m ==> Parameters: 
2021-08-27 22:09:05.011 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86461990872158208 [0;39m <==    Updates: 0
2021-08-27 22:09:05.011 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86461990872158208 [0;39m 生成今日电子书快照结束，耗时：1毫秒
2021-08-27 22:09:10.013 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :32   [32m86462011856261120 [0;39m 生成今日电子书快照开始
2021-08-27 22:09:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86462011856261120 [0;39m ==>  Preparing: insert into ebook_snapshot(ebook_id, `date`, view_count, vote_count, view_increase, vote_increase) select t1.id, curdate(), 0, 0, 0, 0 from ebook t1 where not exists(select 1 from ebook_snapshot t2 where t1.id = t2.ebook_id and t2.`date` = curdate()); update ebook_snapshot t1, ebook t2 set t1.view_count = t2.view_count, t1.vote_count = t2.vote_count where t1.`date` = curdate() and t1.ebook_id = t2.id; update ebook_snapshot t1 left join (select ebook_id, view_count, vote_count from ebook_snapshot where `date` = date_sub(curdate(), interval 1 day)) t2 on t1.ebook_id = t2.ebook_id set t1.view_increase = (t1.view_count - ifnull(t2.view_count, 0)), t1.vote_increase = (t1.vote_count - ifnull(t2.vote_count, 0)) where t1.`date` = curdate();
2021-08-27 22:09:10.014 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86462011856261120 [0;39m ==> Parameters: 
2021-08-27 22:09:10.015 DEBUG c.h.k.mapper.EbookSnapshotMapperCust.genSnapshot  :137  [32m86462011856261120 [0;39m <==    Updates: 0
2021-08-27 22:09:10.015 INFO  com.haoyu.knowlagebase.job.EbookSnapshotJob       :35   [32m86462011856261120 [0;39m 生成今日电子书快照结束，耗时：2毫秒
